import{u as He}from"./accountsStore-iyFYUs9i.js";import{u as Oe}from"./generalpageStore-svGq85mT.js";import{u as Ze}from"./permitapp-Dz0nNy9d.js";import{u as qe}from"./roofList-CiukNQ01.js";import{E as Ke}from"./jspdf.es.min-Cnecea5K.js";import{r as o,a7 as Qe,as as Le,at as _e,b as et,c as tt}from"./index-MayFP46N.js";const pt={__name:"Generalpagepdf",setup(ot){var P,w,G,V,I,z,R,E,N,X;const{getUser:he}=He();let b=o(!1);const u=Ze();qe();const s=Oe(),me=o(((w=(P=u.$state.permitapp[0])==null?void 0:P.formdt)==null?void 0:w.address)||""),xe=o(((V=(G=u.$state.permitapp[0])==null?void 0:G.formdt)==null?void 0:V.permit)||""),Te=o(((z=(I=u.$state.permitapp[0])==null?void 0:I.formdt)==null?void 0:z.processNumber)||""),$=o(((R=u.$state.permitapp[0])==null?void 0:R.muniNum)||""),$e=o(((N=(E=u.$state.permitapp[0])==null?void 0:E.formdt)==null?void 0:N.muni)||""),ke=o(((X=he.value[0])==null?void 0:X.dba)||""),De=o(""),Se=o(s.$state.generalpdfinput);function Ce(){Se.value.length!==1&&(b.value=!0)}Qe(()=>{Ce(),B()}),Le(async()=>{await _e(b).toBe(!0),B()});const B=()=>{var Y,A,M,J,U,j;if(s.$state.generalpdfinput.length===0)console.log("lenghth is   zero");else{const e=new Ke({orientation:"portrait",unit:"mm",format:"a4",compress:!0});e.setGState(new e.GState({opacity:.9}));const y="Approved";e.setFontSize(24),e.setTextColor("black"),e.setFont("helvetica"),e.text("mEPermits",25,250,{angle:45,align:"left",baseline:"bottom",renderingMode:"fill"});const H=new Image,O=new Image,Z=new Image;H.src="/demo/images/officepaper.jpeg",O.src="/demo/images/logo.jpeg",Z.src="/demo/images/DragAndDrop.jpeg";const be=725,q=e.getPageInfo(1),Be=q.pageContext.mediaBox.topRightX,Pe=q.pageContext.mediaBox.topRightY;console.log(Be);const t=o(0),K=o(0);var c=595.28-585.28,a=Pe-be;t.value=c,K.value=a,console.log(t.value,K.value),e.addImage(O,"JPEG",10,10,50,30),e.addImage(H,"JPEG",0,0,210,297),e.setFontSize(12),e.setTextColor("green");var We=new Date,Fe=We.toLocaleDateString();e.text(y,10,270,{align:"left"});const we=e.getTextWidth(y);e.text("on: "+Fe,we+15,270),e.text(`${$.value}`,10,280,{align:"left"});const Ge=e.getTextWidth(`${$.value}`);e.text(`${$e.value}`,Ge+15,280);const Q=o(!1),L=o(!1),_=o(!1),ee=o(!1),te=o(!1);e.setFontSize(12);const Ve=()=>{e.setFontSize(10),e.setTextColor(0),e.text("2023 HVHZ  mEPermit General Information Page",70,20,{maxWidth:"170"}),e.line(10,41,195,41)};e.setTextColor(0),e.circle(185,38,2,"FD"),e.text("I agree",165,39),Ve(),e.setFontSize(12),e.setFontSize(10);const Ie=[{category:"DBA",value:`${ke.value}`},{category:"Job Address",value:`${me.value}`},{category:"meProcess Number",value:`${Te.value}`},{category:"Master Permit",value:`${xe.value}`}];let ze=10,k=60,Re=50;e.setFontSize(10),Ie.forEach((i,F)=>{const r=Re+F*10;e.text(i.category,ze,r),e.text(i.value,k,r),e.getTextWidth(i.category);const x=e.getTextWidth(i.value)*2;e.line(k,r+2,k+x,r+2)}),e.setTextColor("black"),e.setFontSize(10);const l=100,D=o(!1),oe=o(!1);console.log(s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]),s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]==="reroof"?(D.value=!0,console.log(D.value)):oe.value=!0,t.value=c+70,a=l-15,console.log(a),e.text("Re-Roof: ",t.value,a);const g=a-3,S=D.value===!0?e.rect(t.value+20,g,4,4,"FD"):e.rect(t.value+20,g,4,4);t.value=c+120,a=l-15,console.log(a),e.text("New Roof: ",t.value,a);const C=oe.value===!0?e.rect(t.value+20,g,4,4,"FD"):e.rect(t.value+20,g,4,4);console.log(S,C);const ae="Total: ",le="Low Slope: ",se="Steep Slope: ",ne=o(((A=(Y=s.$state.generalpdfinput[0])==null?void 0:Y.generalpdfData)==null?void 0:A.totalData)||""),ce=o(((J=(M=s.$state.generalpdfinput[0])==null?void 0:M.generalpdfData)==null?void 0:J.slopeData)||""),re=o(((j=(U=s.$state.generalpdfinput[0])==null?void 0:U.generalpdfData)==null?void 0:j.steepData)||"");console.log(s.$state.generalpdfinput[0].generalpdfData),t.value=c+25;const Ee=e.getTextWidth(le),ie=e.getTextWidth(`${ce.value}`),ue=t.value+2;e.text(le,ue,l);const d=Ee+ue;e.text(`${ce.value}`,d,l),e.line(d,l,d+ie,l),t.value=d+ie;const Ne=e.getTextWidth(se),pe=e.getTextWidth(`${re.value}`),ge=t.value+2;e.text(se,ge,l);const v=Ne+ge;e.text(`${re.value}`,v,l),e.line(v,l,v+pe,l),console.log(l,a),a=l+10,t.value=v+pe,console.log(t.value);const Xe=e.getTextWidth(ae),de=e.getTextWidth(`${ne.value}`),ve=t.value+2;e.text(ae,ve,l);const f=Xe+ve;e.text(`${ne.value}`,f,l),e.line(f,l,f+de,l),t.value=f+de,console.log(s.$state.generalpdfinput[0]),s.$state.generalpdfinput[0].generalpdfData.slopeChk===!0&&(te.value=!0,console.log("Slope Checked")),s.$state.generalpdfinput[0].generalpdfData.adtileChk===!0&&(Q.value=!0),s.$state.generalpdfinput[0].generalpdfData.metalChk===!0&&(L.value=!0),s.$state.generalpdfinput[0].generalpdfData.mtileChk===!0&&(_.value=!0),s.$state.generalpdfinput[0].generalpdfData.shingleChk===!0&&(ee.value=!0,console.log("Shingle Checked")),t.value=c,console.log(t.value),e.text("Low Slope: ",c,a);const n=a-3,Ye=te.value===!0?e.rect(t.value+20,n,4,4,"FD"):e.rect(t.value+20,n,4,4);console.log(S,C,Ye),t.value=t.value+10,console.log(t.value);const h=t.value+18;console.log(t.value),e.text("Adhesive Set Tile: ",h,a);const Ae=Q.value===!0?e.rect(h+30,n,4,4,"FD"):e.rect(h+30,n,4,4);console.log(S,C,Ae),console.log(t.value);const m=h+40;console.log(t.value),e.text("Metal Panel: ",m,a);const Me=L.value===!0?e.rect(m+25,n,4,4,"FD"):e.rect(m+25,n,4,4);t.value=m+10;const p=t.value+25;console.log(t.value),e.text("Shingle: ",p,a);const Je=ee.value===!0?e.rect(p+15,n,4,4,"FD"):e.rect(p+15,n,4,4);t.value=p;const W=p+35;console.log(t.value),e.text("Mechanical Fastened Tile: ",W,a);const Ue=_.value===!0?e.rect(W+45,n,4,4,"FD"):e.rect(W+45,n,4,4);console.log(Ue,Je,Me),a=a+10,e.addImage(Z,"JPEG",c+40,a,120,120);const je="GeneralPage.pdf",ye=e.output("blob");(async(i,F)=>{const r=i,x=r;console.log(x);const fe=`https://dsr-pdfupload.s3.us-east-1.amazonaws.com/${$.value}/${x}`;try{const T=await fetch(fe,{method:"PUT",headers:{"Content-Type":r.type},body:F});T.ok?(De.value=fe,alert("File uploaded successfully!")):alert(`Failed to upload file. Status: ${T.status}`)}catch(T){console.error("Error uploading file:",T),alert("An error occurred while uploading the file.")}})(je,ye)}};return(c,a)=>(et(),tt("div"))}};export{pt as default};
