import{_ as W}from"./FileSaver-D9opQhYp.js";import{s as N,a as X}from"./index-1KPC7BgF.js";import{e as i,o as c,c as r,i as e,t as m,d as P,F as I,x as B,j as u,H as U,f as F,D as Z,g as K,n as J,J as O,k as R,I as q,Y as ee,v as te,K as se,a as oe,S as Y,T as ae,p as le,q as ne,A as ie}from"./index-Dr66IyCx.js";import{s as H}from"./index-D5fyd6Ft.js";import{u as ce}from"./usePostGeneralpageLambda-DEoKuz25.js";import{u as re}from"./generalpageStore-CjvHUzUR.js";import{u as Q}from"./permitapp-CMK2x7OR.js";import{u as G}from"./roofList-CmOMMqWL.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as de}from"./index-BJUPupbB.js";import{s as pe}from"./index-D6eGTuC8.js";import{s as ue}from"./index-DBKyXhtj.js";import"./index-Dp_RpEFz.js";import"./useAxios-T-UJnv2d.js";import"./index-CZfvqYG_.js";import"./index-CLZ-AEOC.js";import"./index-Wgn4pqQp.js";import"./index-D6dvvsKy.js";const me={class:"modal-wrapper shadow-xl space-y-8 p-6"},fe={class:"clear-pane border-2 border-dashed p-10 text-center mb-4"},he=e("h1",{class:"text-xl font-bold mb-4"},"Permit Application Verification",-1),ve={key:0,class:"text-sm mb-4"},_e=["disabled"],ge={class:"flex flex-wrap gap-4"},ke={class:"font-semibold text-ellipsis max-w-250 whitespace-nowrap overflow-hidden"},ye={key:0,class:"mt-8 space-y-4 overflow-y-auto max-h-40"},Se={class:"p-4 border-l-4 border-green-500 bg-green-50"},be={class:"font-bold"},$e={__name:"MCPFileUpload",setup(y){const g=i(!1),S=i(null),k=i([]),f=i(0),d=i(0),o=i([]),h=async t=>{console.log(t),o.value=t.target.files[0],console.log(o),k.value.push(o),console.log(k.value),l()},b=t=>{const $=$primevue.config.locale.fileSizeTypes;if(t===0)return`0 ${$[0]}`;const w=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/Math.pow(1024,w)).toFixed(3))} ${$[w]}`},a=t=>{d.value=f.value/1,t()},l=async()=>{g.value=!0;const t=o.value;if(!t)return;console.log("Uploading file:",t.name);const n=`https://amzn-s3-temp-upload-bucket.s3.us-east-1.amazonaws.com/${t.name}`;try{const v=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/pdf"},body:t});v.ok?console.log(`Successfully uploaded ${t.name} to S3.`):(console.error(`S3 Rejected Upload. Status: ${v.status}`),v.status===403&&alert("S3 Access Denied. Check CORS or Bucket Policy."))}catch(v){console.error("Network/CORS Error:",v)}finally{g.value=!1}};return(t,n)=>{var w;const v=N,$=X;return c(),r("div",me,[e("div",fe,[he,e("input",{type:"file",onChange:h,accept:".pdf,.jpg,.jpeg,.png",class:"mb-4"},null,32),o.value?(c(),r("p",ve,"Selected: "+m(o.value.name),1)):P("",!0),e("button",{onClick:l,class:"bg-blue-600 text-black px-6 py-2 rounded shadow-md disabled:bg-gray-400",disabled:g.value||!o.value},m(g.value?"Processing...":"Verify Application"),9,_e),e("div",ge,[(c(!0),r(I,null,B(o.value.value,(x,V)=>(c(),r("div",{key:V+x.url+x.size,class:"p-8 rounded-border flex flex-col border border-surface items-center gap-4"},[e("div",null,[u(v,{onClick:n[0]||(n[0]=L=>a()),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!o.value.value||o.value.value.length===0},null,8,["disabled"])]),e("span",ke,m(x.name),1),e("div",null,m(b(x.size)),1),u($,{value:"Completed",class:"mt-4",severity:"success"}),u(v,{icon:"pi pi-times",onClick:L=>t.removeFile(V),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"])]))),128))])]),S.value?(c(),r("div",ye,[e("div",Se,[e("h3",be,"LICENSE: "+m(S.value.license_found||"NOT DETECTED"),1),e("p",null,"Status: "+m(((w=S.value.contractor_info)==null?void 0:w.status)||"Unknown"),1),e("p",null,"Signatures: "+m(S.value.signatures_detected?"✅ Found":"❌ Missing"),1)])])):P("",!0)])}}};function we(){var w,x,V;const y=G(),{roofList:g}=U(y),S=Q(),k=i((V=(x=(w=S.$state.permitapp)==null?void 0:w[0])==null?void 0:x.formdt)==null?void 0:V.processNumber);i(!1);const f=re(),{postGeneral:d}=ce(),o=i(null),h=i(f.$state.generalpdfinput),b=i(!1),a=F({checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1}),l=F({steep1:0,steep2:0,steep3:0,steep4:0,low2:0}),t=F({steep:0,lowslope:0,total:0}),n=F({steepData:"",slopeData:"",totalData:"",checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1,roofCheck:"",area:"",processnumber:""});function v(L){o.value=L.value,console.log(o.value);const E={"Asphalt Shingle":{dim:"dim1",flag:"checkedshingle",steepKey:"steep1"},"Adhesive Set Tile":{dim:"dim4",flag:"checkedadtile",steepKey:"steep2"},"Mechanical Fastened Tile":{dim:"dim3",flag:"checkedmtile",steepKey:"steep3"},"Metal Panel":{dim:"dim5",flag:"checkedmetal",steepKey:"steep4"},"Low Slope":{dim:"dim2",flag:"checkedslp"}};console.log(a,l),Object.keys(a).forEach(T=>a[T]=!1),Object.keys(l).forEach(T=>l[T]=0),g.value.forEach(T=>{const C=E[T.item];if(C){const D=Number(T[C.dim])||0;a[C]=!0,n[`${C.flag}`]=!0,console.log(C.flag,n),C.flag==="checkedslp"?(console.log(D),l.low2=D):l[C.steepKey]=D}}),$()}async function $(){t.steep=l.steep1+l.steep2+l.steep3+l.steep4,t.lowslope=l.low2,t.total=t.steep+t.lowslope,n.area=t.total,n.steepData=t.steep,n.slopeData=t.lowslope,n.totalData=t.total,n.roofCheck=o.value,n.processnumber=k.value,f.addgeneralpdfData(n),await d(n),b.value=!0}return{addRoof:v,roofArea:$,dataGeneral:n,generalType:h,isGeneralPageValid:b}}const xe=Z("roofinput",{state:()=>({roofinput:[],id:0}),actions:{addCheck(y){this.roofinput.push({roofCheckdata:y,completed:!1})},reset(){this.roofinput=[]},persist:!0}}),Ce={class:"terminal"},Te={class:"terminal-content"},Re={class:"content"},Me=["onClick"],Ve=20,De={__name:"RoofSystemList",setup(y){const g=G(),{roofList:S}=U(g),{toggleCompleted:k}=U(g),f=["Initializing system...","Loading modules...","Connecting to server...","Server connection established.","Awaiting Roof System Selection..."],d=i([]);function o(){let h=0;const b=setInterval(()=>{h<f.length?(d.value.length>=Ve&&d.value.shift(),d.value.push(f[h]),console.log(f[h]),h++):clearInterval(b)},500)}return K(()=>{o()}),(h,b)=>(c(),r("div",Ce,[e("div",Te,[(c(!0),r(I,null,B(d.value,(a,l)=>(c(),r("div",{key:l,class:"terminal-line"},m(a),1))),128)),(c(!0),r(I,null,B(R(S),a=>(c(),r("div",{key:a.id,class:"item"},[e("div",Re,[e("span",{class:J({completed:a.completed}),style:{color:"green"}},m(a.item)+" "+m(a.dim1)+" "+m(a.dim2)+" "+m(a.dim3)+" "+m(a.dim4)+" "+m(a.dim5),3),e("span",{onClick:O(l=>R(k)(a.id),["stop"])},"✔",8,Me)])]))),128))])]))}},ze=j(De,[["__scopeId","data-v-0eaf742f"]]),M=y=>(le("data-v-2cf24951"),y=y(),ne(),y),Ae={class:"page"},Le={class:"card"},Fe={class:"card__header"},Pe=M(()=>e("h2",null,"Roof System",-1)),Ie=M(()=>e("i",{class:"pi pi-refresh"},null,-1)),Be={class:"form"},Ee={class:"field"},Ne=M(()=>e("label",{for:"sqft"},"Square Footage",-1)),Ue={class:"field"},Oe=M(()=>e("label",{for:"system"},"Roof System",-1)),Ke={key:0,class:"hint"},Ge={class:"field row"},je={class:"check"},qe=M(()=>e("label",{for:"kind-new"},"New Roof",-1)),Ye={class:"check"},He=M(()=>e("label",{for:"kind-reroof"},"Re-Roof",-1)),Je={class:"actions"},Qe={class:"side"},We=M(()=>e("p",{class:"dz-title"},"Blueprints & images",-1)),Xe=M(()=>e("p",{class:"dz-sub"},"Drag & drop files here, or click to select",-1)),Ze={key:0,class:"dz-list"},et={__name:"RoofSystemForm",setup(y){var T,C,D;const g=Q(),S=xe(),k=G(),f=i(""),d=i(null),o=i(""),h=i(!1),b=i([]),{addRoof:a}=we(),l=F({roofCheck:""}),t=[{name:"Asphalt Shingle"},{name:"Low Slope"},{name:"Mechanical Fastened Tile"},{name:"Adhesive Set Tile"},{name:"Metal Panel"}],n=i((D=(C=(T=g.$state.permitapp)==null?void 0:T[0])==null?void 0:C.formdt)==null?void 0:D.checkIfBeach),v=q(()=>ee(n.value).value===2),$=q(()=>v.value?t.slice(1):t);function w(z){var p;if(!z||f.value==0)return;const s=d.value.name,_=Number(f.value);console.log(s,_);const A={"Asphalt Shingle":()=>k.addSystemShingle(s,_),"Low Slope":()=>k.addSystemBur(s,_),"Mechanical Fastened Tile":()=>k.addSystemMTile(s,_),"Adhesive Set Tile":()=>k.addSystemATile(s,_),"Metal Panel":()=>k.addSystemMetal(s,_)};console.log(A,o.value),(p=A[s])==null||p.call(A),l.roofCheck=o.value,S.addCheck({...l}),f.value="",d.value=null}function x(){a(o)}function V(){k.$reset()}function L(z){var _;h.value=!1;const s=[...((_=z.dataTransfer)==null?void 0:_.files)||[]];s.length&&(b.value=s)}function E(z){var _;const s=[...((_=z.target)==null?void 0:_.files)||[]];s.length&&(b.value=s)}return K(()=>{!d.value&&$.value.length&&(d.value=$.value[0])}),(z,s)=>{const _=te("RouterLink"),A=ae;return c(),r("main",Ae,[e("section",Le,[e("header",Fe,[Pe,se((c(),oe(R(N),{class:"icon",text:"",plain:"",onClick:V},{default:Y(()=>[Ie]),_:1})),[[A,"Reset list",void 0,{bottom:!0}]])]),e("div",Be,[e("div",Ee,[Ne,u(R(pe),{id:"sqft",modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=p=>f.value=p),type:"number",inputmode:"numeric",placeholder:"e.g. 1200"},null,8,["modelValue"])]),e("div",Ue,[Oe,u(R(ue),{id:"system",class:"w-full",options:$.value,optionLabel:"name",modelValue:d.value,"onUpdate:modelValue":[s[1]||(s[1]=p=>d.value=p),w],placeholder:"Select roof system"},null,8,["options","modelValue"]),v.value?(c(),r("small",Ke,"Miami Beach restrictions apply.")):P("",!0)]),e("div",Ge,[e("div",je,[u(R(H),{inputId:"kind-new",name:"roofKind",value:"newroof",modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=p=>o.value=p)},null,8,["modelValue"]),qe]),e("div",Ye,[u(R(H),{inputId:"kind-reroof",name:"roofKind",value:"reroof",modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=p=>o.value=p)},null,8,["modelValue"]),He])]),e("div",Je,[u(_,{to:"/dynamicstepper"},{default:Y(()=>[u(R(N),{severity:"contrast",label:"Continue",onClick:x})]),_:1})])]),u(R(de)),u(ze)]),e("section",Qe,[e("div",{class:J(["dropzone",{over:h.value}]),onDragover:s[4]||(s[4]=O(p=>h.value=!0,["prevent"])),onDragleave:s[5]||(s[5]=p=>h.value=!1),onDrop:O(L,["prevent"])},[We,Xe,e("input",{type:"file",class:"dz-input",multiple:"",onChange:E},null,32),b.value.length?(c(),r("ul",Ze,[(c(!0),r(I,null,B(b.value,p=>(c(),r("li",{key:p.name},m(p.name),1))),128))])):P("",!0)],34)])])}}},tt=j(et,[["__scopeId","data-v-2cf24951"]]),st={id:"id",class:"grid grid-cols-3 gap-6"},ot={class:"roof-app",style:{"margin-left":"250px","margin-top":"20px",border:"none","border-radius":"12px","box-shadow":"4px 4px 16px rgb(22, 183, 183)","padding-bottom":"10px",position:"center","max-height":"600px",width:"600px",top:"10vh"}},at={__name:"RoofSystemApp",setup(y){return K(()=>{ie.init({duration:4500,easing:"ease-in-out",once:!1})}),(g,S)=>(c(),r("div",st,[e("div",ot,[u(tt)])]))}},lt=j(at,[["__scopeId","data-v-aebd1914"]]),nt={class:"grid grid-cols-2 gap-0"},it={"data-aos":"fade-up-right","data-aos-delay":"500",style:{"margin-top":"90px"}},Ct={__name:"RoofSystem",setup(y){return(g,S)=>(c(),r("div",nt,[u(lt),e("div",it,[u(W),u($e)])]))}};export{Ct as default};
