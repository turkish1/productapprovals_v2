import{_ as J}from"./FileSaver-DCP-guKq.js";import{s as K}from"./index-DD6gkh_o.js";import{s as Q}from"./index-BFqd3J45.js";import{s as X}from"./index-CfC_oFIi.js";import{s as $}from"./index-D0J61ynR.js";import{a as ee,u as te}from"./useAxios-_y3UiNvs.js";import{r as n,q as oe,a as R,_ as se,u as ae,w as F,n as le,o as V,c as M,e as a,d as c,P as ne,t as re,m as ie,p as ce,i as de}from"./index-CC9RM5J4.js";import{u as ue}from"./accountsStore-BehNKaUl.js";import{u as pe}from"./permitapp-BZXH-fNx.js";import{h as me,E as ge}from"./jspdf.es.min-ZUQxa_iL.js";import{t as fe,a as ve}from"./index-BcGqECGe.js";import"./index-DofdxD5p.js";import"./index-usFgwfve.js";import"./index-Dvev-DnW.js";const o=ee.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),be={getAddr(){return o.get("/folio")},postProcessnumber(t){return o.post("/process",t)},getLastProcess(){return o.get("/lastnumber")},getSlopeless(){return o.get("/slopeless")},getSlopemore(){return o.get("/slopemore")},getdeOne(){return o.get("/desupone")},getdeTwo(){return o.get("/desuptwo")},getdeThree(){return o.get("/desupthree")},getdeFour(){return o.get("/desupfour")},getZones23(){return o.get("/gableroofs23")},getNoa(){return o.get("/noa")},getSBS(){return o.get("/shinglesbs")},getSystemE(){return o.get("/systemtype")},getburMaterial(){return o.get("/burmaterial")},getnewburMaterial(){return o.get("/burmaterials")},getburSystem(){return o.get("/bursystem")},getPoly(){return o.get("/shinglepoly")},getSystemF(){return o.get("/systemtypef")},getdeGauge(){return o.get("/degauge")},getdeMaterial(){return o.get("/dematerial")},getdeMatMore(){return o.get("/dematerials")},getdeSize(){return o.get("/desize")},getdeFastener(){return o.get("/defastener")},getprimeBase(){return o.get("/primebase")},getPerimeter(){return o.get("/perimeter")},getNoas(){return o.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return o.get("/tilenoa")},getZones(){return o.get("/gablezones")},getLay(){return o.get("/underlaymentshingle")},getContractors(){return o.get("/contractors")},postAccount(t){return o.post("/accounts",t)},getAccount(){return o.get("/retriveaccounts")},getDripMaterials(){return o.get("/dripmaterials")}};function N(){const t=n(null),e=n(0);return be.getLastProcess().then(i=>{t.value=i.data,t.value.forEach(s=>{console.log(s.processNumber),e.value=s.processNumber})}).catch(i=>{console.error("Error:",i)}),{resNum:t,lastNum:e}}function he(){const{resNum:t,lastNum:e}=N(),i=n(""),s=n(new Date().getFullYear()),f=n(6),_=n("me"),v=Array.from({length:10**f.value},(b,p)=>`${_.value}${s.value}${String(p).padStart(f.value,"0")}`),l=N();return console.log(l),i.value=v[0]+1,e.value!==0||(i.value=e.value+1),{pNum:i,lastNum:e,resNum:t,test:l}}const ye=oe("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(t){this.processinput.push({procData:t,completed:!1})}}});function _e(){const t=n("");let e=n([]);const i=ye(),s=n("");let f="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:_,data:v}=te(f,{method:"POST"},{immediate:!1});let l=R({});function b(p){console.log(p),l=p,_({data:p}),t.value="Form submitted successfully!",i.addData(l),console.log(l,"System added")}return{error:s,results:e,procReceive:b,responseMessage:t,procData:l,procStore:i}}n(1);const we={setup(){const t=n(""),e=ae(),i=n(),s=n(),f=n(),{procData:_,procReceive:v}=_e(),{accountUsers:l,getUser:b,addUser:p}=ue();console.log(l._value[0]),F(()=>{});const A=n("me"),r=pe(),u=R({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),I=n(""),C=n(""),D=n(""),E=n(""),k=n("");fe(()=>{if(l._value[0].name==="")return e.push("/");I.value=l._value[0].name,C.value=l._value[0].email,D.value=l._value[0].phone,E.value=l._value[0].secondary_status,k.value=l._value[0].dba,console.log(l._value[0])});const L=()=>{const m=document.getElementById("roofselect");console.log(m),me(m).then(S=>{const y=S.toDataURL("image/png"),g=new ge;g.addImage(y,"PNG",10,10,190,0);const x=g.output("blob");h(x)});const h=async S=>{try{const g=await(await window.showSaveFilePicker({suggestedName:"generated.pdf",types:[{description:"PDF file",accept:{"application/pdf":[".pdf"]}}]})).createWritable();await g.write(S),await g.close(),console.log("PDF saved successfully without popping download dialog!")}catch(y){console.error("Error saving file:",y)}}},B=n(!1);he();const{lastNum:P,resNum:z}=N();n(null);const w=n(""),U=n(""),O=async()=>{const m=n(u.address),S=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(m.value)}&to=200`,y=await fetch(S);B.value=!0;const g=await y.json();console.log(g),u.muni=g.MinimumPropertyInfos[0].Municipality,u.folio=g.MinimumPropertyInfos[0].Strap;let x=String(P.value);console.log(P.value.length,P.value,x);let Z=x.substring(2,13),W=ve(Z).value+1,Y=String(W);u.processNumber=A.value.concat(Y),console.log(u.processNumber),U.value=u.folio,w.value=U.value.substring(0,2),console.log(w.value),v(u),setTimeout(()=>{B.value=!1},2e3)},H=async()=>{L(),v(u)},T=n(),j=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),q=()=>{e.push("/roofsystem")};function G(m,h){m=u,h=T.value,m.length!==0&&(r.addSystem(m,h,w.value),console.log(m,h,w.value,"System added"))}return F(()=>{}),{generatePdf:L,onSubmit:H,accountUsers:l,getUser:b,email:C,dba:k,phone:D,contractor:I,licenseStatus:E,addUser:p,navigateNext:q,addItemAndClear:G,selectedApplication:T,type:j,resNum:z,...le(u),responseMessage:t,lastNum:P,useLast:N,load:O,checkMB:w,checkV:U,content:i,canvas:s,doc:f}}},d=t=>(ce("data-v-7c3cdc7c"),t=t(),de(),t),Se={id:"content",ref:"permitapp",class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"220px"}},Pe={class:"md:w-2/3"},xe={class:"container"},Ve={class:"row"},Ne={class:"card flex flex-col gap-2"},Ae=d(()=>a("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Ue={class:"card flex justify-center"},Me={class:"card flex flex-col gap-4"},Ie={class:"flex flex-wrap gap-4"},Ce={class:"flex flex-col grow basis-0 gap-3"},De={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ee=d(()=>a("label",{for:"license"},"License Status",-1)),ke=d(()=>a("label",{for:"addr"},"Property Address",-1)),Le={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Be={class:"flex flex-col mt-3 grow basis-0 gap-3"},Te=d(()=>a("label",{for:"dba"},"DBA ",-1)),Fe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Re=d(()=>a("label",{for:"contractor"},"Contractor Name",-1)),ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},Oe=d(()=>a("label",{for:"phone"},"Cell Phone Number",-1)),He={class:"flex flex-col mt-3 grow basis-0 gap-3"},je=d(()=>a("label",{for:"Email"},"Email",-1)),qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ge=d(()=>a("label",{for:"muni"},"Municipality",-1)),Ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},We=d(()=>a("label",{for:"folio"},"Folio",-1)),Ye={class:"flex flex-col mt-3 grow basis-0 gap-3"},Je=d(()=>a("label",{for:"permit"},"Master Permit",-1)),Ke={class:"flex flex-col mt-3 grow basis-0 gap-3"},Qe=d(()=>a("label",{for:"processnum"},"mEProcess Number",-1)),Xe=d(()=>a("br",null,null,-1)),$e={key:0};function et(t,e,i,s,f,_){const v=$,l=X,b=Q,p=K,A=J;return V(),M("div",Se,[a("div",Pe,[a("div",xe,[a("form",null,[a("div",Ve,[a("div",Ne,[Ae,a("div",Ue,[c(v,{modelValue:s.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=r=>s.selectedApplication=r),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),a("div",Me,[a("div",Ie,[a("form",{class:"w-3/4",onSubmit:e[12]||(e[12]=(...r)=>s.onSubmit&&s.onSubmit(...r))},[a("div",Ce,[a("div",De,[Ee,c(l,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":e[1]||(e[1]=r=>s.licenseStatus=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),ke,c(l,{id:"addr",type:"text",modelValue:t.address,"onUpdate:modelValue":e[2]||(e[2]=r=>t.address=r),placeholder:"address"},null,8,["modelValue"]),t.loading?(V(),M("i",Le)):(V(),ne(b,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:t.loading,onClick:s.load,onInput:t.createHtml},null,8,["loading","onClick","onInput"]))]),a("div",Be,[Te,c(l,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":e[3]||(e[3]=r=>s.dba=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Fe,[Re,c(l,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":e[4]||(e[4]=r=>s.contractor=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",ze,[Oe,c(p,{modelValue:s.phone,"onUpdate:modelValue":e[5]||(e[5]=r=>s.phone=r),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),a("div",He,[je,c(l,{modelValue:s.email,"onUpdate:modelValue":e[6]||(e[6]=r=>s.email=r),invalid:s.email===null},null,8,["modelValue","invalid"])]),a("div",qe,[Ge,c(l,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[7]||(e[7]=r=>t.muni=r),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),a("div",Ze,[We,c(l,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[8]||(e[8]=r=>t.folio=r),type:"text",placeholder:"folio",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",Ye,[Je,c(l,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[9]||(e[9]=r=>t.permit=r),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),a("div",Ke,[Qe,c(l,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[10]||(e[10]=r=>t.processNumber=r),type:"text",placeholder:"process number"},null,8,["modelValue"])]),Xe,c(b,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:e[11]||(e[11]=r=>s.addItemAndClear(s.generatePdf,t.formData,s.selectedApplication))})],32),s.responseMessage?(V(),M("p",$e,re(s.responseMessage),1)):ie("",!0),c(A)])])])])])])])],512)}const vt=se(we,[["render",et],["__scopeId","data-v-7c3cdc7c"]]);export{vt as default};
