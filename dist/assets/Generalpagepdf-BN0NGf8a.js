import{u as qe}from"./accountsStore-CiPTwm6e.js";import{u as Ke}from"./generalpageStore-BqSKYUDV.js";import{u as Qe}from"./permitapp-C0-XncpE.js";import{u as Le}from"./roofList-Dada0xtS.js";import{E as _e}from"./jspdf.es.min-DsytEnbA.js";import{e as o,ab as et,at as tt,au as ot,o as at,c as lt}from"./index-CwblT9dz.js";const vt={__name:"Generalpagepdf",setup(st){var B,w,G,V,I,R,z,E,N,X,Y;const{getUser:Te}=qe();let b=o(!1);const u=Qe();Le();const s=Ke(),$e=o(((w=(B=u.$state.permitapp[0])==null?void 0:B.formdt)==null?void 0:w.address)||""),ke=o(((V=(G=u.$state.permitapp[0])==null?void 0:G.formdt)==null?void 0:V.permit)||""),De=o(((R=(I=u.$state.permitapp[0])==null?void 0:I.formdt)==null?void 0:R.processNumber)||""),$=o(((E=(z=u.$state.permitapp[0])==null?void 0:z.formdt)==null?void 0:E.muniProc)||""),Se=o(((X=(N=u.$state.permitapp[0])==null?void 0:N.formdt)==null?void 0:X.muni)||""),Ce=o(((Y=Te.value[0])==null?void 0:Y.dba)||""),We=o(""),Fe=o(s.$state.generalpdfinput);function be(){Fe.value.length!==1&&(b.value=!0)}et(()=>{be(),P()}),tt(async()=>{await ot(b).toBe(!0),P()});const P=()=>{var A,M,J,U,j,y,H,O;if(s.$state.generalpdfinput.length===0)console.log("lenghth is   zero");else{const e=new _e({orientation:"portrait",unit:"mm",format:"a4",compress:!0});e.setGState(new e.GState({opacity:.9}));const Z="Approved";e.setFontSize(24),e.setTextColor("black"),e.setFont("helvetica"),e.text("mEPermits",25,250,{angle:45,align:"left",baseline:"bottom",renderingMode:"fill"});const q=new Image,K=new Image,Q=new Image;q.src="/demo/images/officepaper.jpeg",K.src="/demo/images/logo.jpeg",Q.src="/demo/images/DragAndDrop.jpeg";const we=725,L=e.getPageInfo(1),Ge=L.pageContext.mediaBox.topRightX,Ve=L.pageContext.mediaBox.topRightY;console.log(Ge);const t=o(0),_=o(0);var c=595.28-585.28,a=Ve-we;t.value=c,_.value=a,console.log(t.value,_.value),e.addImage(K,"JPEG",10,10,50,30),e.addImage(q,"JPEG",0,0,210,297),e.setFontSize(12),e.setTextColor("green");var Pe=new Date,Be=Pe.toLocaleDateString();e.text(Z,10,270,{align:"left"});const Ie=e.getTextWidth(Z);e.text("on: "+Be,Ie+15,270),e.text(`${$.value}`,10,280,{align:"left"});const Re=e.getTextWidth(`${$.value}`);e.text(`${Se.value}`,Re+15,280);const ee=o(!1),te=o(!1),oe=o(!1),ae=o(!1),le=o(!1);e.setFontSize(12);const ze=()=>{e.setFontSize(12),e.setTextColor(0),e.text("2023 HVHZ  mEPermit General Information Page",70,20,{maxWidth:"170"}),e.line(10,41,195,41)};e.setTextColor(0),ze(),e.setFontSize(12);const Ee=[{category:"DBA",value:`${Ce.value}`},{category:"Job Address",value:`${$e.value}`},{category:"meProcess Number",value:`${De.value}`},{category:"Master Permit",value:`${ke.value}`}];let Ne=10,k=60,Xe=50;e.setFontSize(12),Ee.forEach((i,F)=>{const r=Xe+F*10;e.text(i.category,Ne,r),e.text(i.value,k,r),e.getTextWidth(i.category);const x=e.getTextWidth(i.value)*2;e.line(k,r+2,k+x,r+2)}),e.setTextColor("black"),e.setFontSize(12);const l=100,D=o(!1),se=o(!1);console.log((M=(A=s.$state.generalpdfinput[1])==null?void 0:A.generalpdfData)==null?void 0:M.roofCheck[0]),s.$state.generalpdfinput[1].generalpdfData.roofCheck[0]==="reroof"?(D.value=!0,console.log(D.value)):se.value=!0,t.value=c+70,a=l-15,console.log(a),e.text("Re-Roof: ",t.value,a);const d=a-3,S=D.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);t.value=c+120,a=l-15,console.log(a),e.text("New Roof: ",t.value,a);const C=se.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);console.log(S,C);const ne="Total: ",ce="Low Slope: ",re="Steep Slope: ",ie=o(((U=(J=s.$state.generalpdfinput[1])==null?void 0:J.generalpdfData)==null?void 0:U.totalData)||""),ue=o(((y=(j=s.$state.generalpdfinput[1])==null?void 0:j.generalpdfData)==null?void 0:y.slopeData)||""),pe=o(((O=(H=s.$state.generalpdfinput[1])==null?void 0:H.generalpdfData)==null?void 0:O.steepData)||"");console.log(s.$state.generalpdfinput[1].generalpdfData),t.value=c+25;const Ye=e.getTextWidth(ce),de=e.getTextWidth(`${ue.value}`),ge=t.value+5;e.text(ce,ge,l);const g=Ye+ge;e.text(`${ue.value}`,g,l),e.line(g,l,g+de,l),t.value=g+de;const Ae=e.getTextWidth(re),ve=e.getTextWidth(`${pe.value}`),fe=t.value+5;e.text(re,fe,l);const v=Ae+fe;e.text(`${pe.value}`,v,l),e.line(v,l,v+ve,l),console.log(l,a),a=l+10,t.value=v+ve,console.log(t.value);const Me=e.getTextWidth(ne),he=e.getTextWidth(`${ie.value}`),me=t.value+5;e.text(ne,me,l);const f=Me+me;e.text(`${ie.value}`,f,l),e.line(f,l,f+he,l),t.value=f+he,console.log(s.$state.generalpdfinput[1]),s.$state.generalpdfinput[1].generalpdfData.slopeChk===!0&&(le.value=!0,console.log("Slope Checked")),s.$state.generalpdfinput[1].generalpdfData.adtileChk===!0&&(ee.value=!0),s.$state.generalpdfinput[1].generalpdfData.metalChk===!0&&(te.value=!0),s.$state.generalpdfinput[1].generalpdfData.mtileChk===!0&&(oe.value=!0),s.$state.generalpdfinput[1].generalpdfData.shingleChk===!0&&(ae.value=!0,console.log("Shingle Checked")),t.value=c-4,console.log(t.value),e.text("Low Slope: ",c,a);const n=a-3,Je=le.value===!0?e.rect(t.value+27,n,4,4,"FD"):e.rect(t.value+27,n,4,4);console.log(S,C,Je),t.value=t.value+4;const Ue=t.value+32;console.log(t.value);const h=Ue;console.log(t.value),e.text("Adhesive Set Tile: ",h,a);const je=ee.value===!0?e.rect(h+36,n,4,4,"FD"):e.rect(h+36,n,4,4);console.log(S,C,je),console.log(t.value);const m=h+43;console.log(t.value),e.text("Metal Panel: ",m,a),te.value===!0?e.rect(m+25,n,4,4,"FD"):e.rect(m+25,n,4,4);const p=m+35;console.log(t.value),e.text("Shingle: ",p,a);const ye=ae.value===!0?e.rect(p+17,n,4,4,"FD"):e.rect(p+17,n,4,4);t.value=p;const W=p+28;console.log(t.value),e.text("Mechanical Fastened Tile: ",W,a);const He=oe.value===!0?e.rect(W+51,n,4,4,"FD"):e.rect(W+51,n,4,4);console.log(He,ye),a=a+10,e.addImage(Q,"JPEG",c+40,a,120,120);const Oe="GeneralPage.pdf",Ze=e.output("blob");(async(i,F)=>{const r=i,x=r;console.log(x);const xe=`https://dsr-pdfupload.s3.us-east-1.amazonaws.com/${$.value}/${x}`;try{const T=await fetch(xe,{method:"PUT",headers:{"Content-Type":r.type},body:F});T.ok?(We.value=xe,alert("GeneralPage File uploaded successfully!")):alert(`Failed to upload file. Status: ${T.status}`)}catch(T){console.error("Error uploading file:",T),alert("An error occurred while uploading the file.")}})(Oe,Ze)}};return(c,a)=>(at(),lt("div"))}};export{vt as default};
