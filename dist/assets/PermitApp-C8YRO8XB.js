import{s as oe}from"./index-DCvsNswu.js";import{s as le}from"./index-Ddb2JGwz.js";import{s as ae}from"./index-l_F2iP9X.js";import{s as se}from"./index-CgNPcmiY.js";import{u as te,_ as ne}from"./lastNumber-Cn4JQSO1.js";import{e as l,u as ie,h as O,f as ue,Z as re,J as T,ad as de,ae as ce,o as h,c as P,a as me,d as S,i as o,j as n,K as pe,t as ve,F as fe,ag as _e,Y as q,p as he,q as be}from"./index-C39uQMLr.js";import{u as Ve}from"./useScreenSize-B7cbo51d.js";import{u as ye}from"./processStore-CU0Dy0H-.js";import{u as ge}from"./use-createProcessnumber-Dln3nsIB.js";import{u as Pe}from"./accountsStore-CjthTRGz.js";import{u as Se}from"./permitapp-Pc-d5Byy.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BxXxEvU0.js";import"./index-DX1LCFlI.js";import"./index-TPVTN7yv.js";import"./index-BQ5RXrl_.js";import"./index-DVcqZPLa.js";import"./index-BU6rT-2M.js";import"./index-BW5YHDg6.js";import"./useAxios-BRzFkcnl.js";const u=b=>(he("data-v-6f453c81"),b=b(),be(),b),we={class:"hero"},Ne={class:"card"},Me=u(()=>o("h1",{class:"title"},"Permit Application",-1)),Ue={class:"field"},Ie=u(()=>o("label",{for:"license"},"License Status",-1)),Ae={class:"field"},Be=u(()=>o("label",{for:"processMuni"},"Municipality Process #",-1)),De={class:"field"},xe=u(()=>o("label",{for:"addr"},"Property Address",-1)),Ce={class:"input-row"},Ee={class:"field"},Le={key:0,class:"historic-indicator"},Re={class:"field"},We=u(()=>o("label",{for:"dba"},"DBA",-1)),$e={class:"field"},je=u(()=>o("label",{for:"name"},"Contractor Name",-1)),Fe={class:"field"},He=u(()=>o("label",{for:"phone"},"Cell Phone",-1)),Oe={class:"field"},Te=u(()=>o("label",{for:"email"},"Email",-1)),qe={key:0,class:"error"},Ye={class:"field"},ze=u(()=>o("label",{for:"muni"},"Municipality",-1)),Ge={class:"field"},Je=u(()=>o("label",{for:"folio"},"Folio",-1)),Ke={class:"field"},Ze=u(()=>o("label",{for:"permit"},"Master Permit",-1)),Qe={class:"field"},Xe=u(()=>o("label",{for:"processnum"},"mEProcess #",-1)),eo={key:0,class:"response span-2"},oo={class:"span-2 submit-row"},lo={__name:"PermitApp",setup(b){const c=l(!1),A=l(""),B=l(!1),D=l(!1);ie(),ye();const{procData:ao,procReceive:x}=ge(),{accountUsers:m}=Pe(),C=Se(),E=l([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),Y=l("me");O(()=>{const{width:t,isUltraWide:e,height:r,isLongScreen:d}=Ve();return console.log(t,e),{width:t,isUltraWide:e,height:r,isLongScreen:d}});const s=ue({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",phNumber:"",emails:"",muniProc:"",historic:Boolean,date:new Date}),p=l(""),L=l(""),z=l(!0),k=l(!1),f=l(""),V=l(""),y=l(""),w=l(""),g=l(""),_=l([]),v=l(""),N=l(!1);O(()=>{var t;N.value===!1&&((t=m.value[0])==null?void 0:t.secondary_status)==="I"?(console.log(N.value),alert("Your license is Inactive!")):N.value=!0}),re(()=>{R(),B.value=!0,localStorage.clear()});const G=T(()=>{var t,e;return((t=m.value[0])==null?void 0:t.bphone)!==""&&(k.value=!0,y.value=m.value[0].bphone),k.value===!0?y.value:(e=m.value[0])==null?void 0:e.bphone});de(R,G,()=>{});async function R(){var t,e,r,d,i;_.value=await m.value[0],w.value=((t=_.value)==null?void 0:t.name)||"",g.value=((e=_.value)==null?void 0:e.email)||"",f.value=((r=_.value)==null?void 0:r.secondary_status)||"",console.log(f.value),V.value=((d=_.value)==null?void 0:d.dba)||"",y.value=(i=m.value[0])==null?void 0:i.bphone}ce(async()=>{await _e(k).toBe(!0)});const M=T(()=>z.value?E.value[0]:""),{resNum:J}=te(),W=l(""),$=l(""),U=l(null),I=l(""),j=l(null),F=l("");async function K(t){c.value=!0,j.value=null;try{const e=await fetch(t);U.value=await e.json(),I.value=U.value.body.MinimumPropertyInfos[0],s.muni=I.value.Municipality,s.folio=I.value.Strap,D.value=await U.value.body.isHistoric,$.value=s.folio,F.value=$.value.substring(1,2),W.value=q(F)}catch(e){j.value=e.message}finally{c.value=!1}}async function Z(){try{c.value=!0,setTimeout(()=>c.value=!1,1e3),L.value=p.value;const e=`https://6x2kydgvuahfitwvxkkfbybv6u0kbxgl.lambda-url.us-east-1.on.aws/?address=${v.value}`;await K(e),Object.assign(s,{license:f.value,contractor:V.value,emails:g.value,muniProc:p.value,phNumber:y.value});const r=String(J.value).substring(3,19),d=q(r).value+1;s.processNumber=Y.value.concat(String(d)),s.muniProc=p.value,s.address=v.value,x(s)}catch(t){alert(t)}}function Q(){x(s)}function X(){console.log(v.value),C.addSystem(s,M.value,W.value,p.value,L.value,v.value),console.log(C)}return(t,e)=>{const r=ne,d=se,i=ae,H=le,ee=oe;return h(),P(fe,null,[B.value?(h(),me(r,{key:0})):S("",!0),o("section",we,[o("div",Ne,[Me,n(d,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=a=>M.value=a),options:E.value,optionLabel:"name",placeholder:"Select a permit type",class:"w-full permit-select"},null,8,["modelValue","options"]),o("form",{class:"grid-form",onSubmit:pe(Q,["prevent"])},[o("div",Ue,[Ie,n(i,{id:"license",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),placeholder:"active / inactive"},null,8,["modelValue"])]),o("div",Ae,[Be,n(i,{id:"processMuni",modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),placeholder:"00000000"},null,8,["modelValue"])]),o("div",De,[xe,o("div",Ce,[n(i,{id:"addr",modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=a=>v.value=a),placeholder:"123 SW 1st St"},null,8,["modelValue"]),n(H,{type:"button",icon:"pi pi-search",loading:c.value,onClick:Z},null,8,["loading"])])]),o("div",Ee,[D.value?(h(),P("span",Le,"Property is Historic")):S("",!0)]),o("div",Re,[We,n(i,{id:"dba",modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=a=>V.value=a),placeholder:"company alias"},null,8,["modelValue"])]),o("div",$e,[je,n(i,{id:"name",modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=a=>w.value=a),placeholder:"full name"},null,8,["modelValue"])]),o("div",Fe,[He,n(ee,{id:"phone",modelValue:s.phNumber,"onUpdate:modelValue":e[6]||(e[6]=a=>s.phNumber=a),mask:"(999) 999-9999",placeholder:"(999) 999-9999"},null,8,["modelValue"])]),o("div",Oe,[Te,n(i,{id:"email",modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=a=>g.value=a),invalid:t.invalid,placeholder:"you@example.com"},null,8,["modelValue","invalid"]),t.invalid?(h(),P("small",qe,"Email is required")):S("",!0)]),o("div",Ye,[ze,n(i,{id:"muni",modelValue:s.muni,"onUpdate:modelValue":e[8]||(e[8]=a=>s.muni=a),placeholder:"Miami"},null,8,["modelValue"])]),o("div",Ge,[Je,n(i,{id:"folio",modelValue:s.folio,"onUpdate:modelValue":e[9]||(e[9]=a=>s.folio=a),placeholder:"00-0000-000-0000",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),o("div",Ke,[Ze,n(i,{id:"permit",modelValue:s.permit,"onUpdate:modelValue":e[10]||(e[10]=a=>s.permit=a),placeholder:"20000000"},null,8,["modelValue"])]),o("div",Qe,[Xe,n(i,{id:"processnum",modelValue:s.processNumber,"onUpdate:modelValue":e[11]||(e[11]=a=>s.processNumber=a),placeholder:"auto-generated"},null,8,["modelValue"])]),A.value?(h(),P("p",eo,ve(A.value),1)):S("",!0),o("div",oo,[n(H,{label:"Submit",type:"submit",loading:c.value,severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:X},null,8,["loading"])])],32)])])],64)}}},wo=ke(lo,[["__scopeId","data-v-6f453c81"]]);export{wo as default};
