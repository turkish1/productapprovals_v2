import{T as Z}from"./index-WLiiQFXS.js";import{s as $,_ as ee}from"./index-BcFf8yVI.js";import{s as oe}from"./index-DzyZXMAD.js";import{s as te}from"./index-CsvtKQmb.js";import{s as se}from"./index-CAWvRplG.js";import{s as le}from"./index-HplQmz5k.js";import{u as ae,a as ne,b as j,_ as ie}from"./use-createProcessnumber-DtRjZR4E.js";import{u as re}from"./accountsStore-UJCOPM23.js";import{u as de}from"./permitapp-CzUtvcL8.js";import{h as ce,E as me}from"./jspdf.es.min-CZlUqYFh.js";import{r as n,u as pe,a as ue,o as F,A as fe,ah as ge,ap as T,t as ve,c as g,d as N,O as A,v as I,f as e,e as d,g as be,i as _e,q as he,F as ye,ag as we,aq as Ve,ae as Se,p as xe,j as Pe}from"./index-CwStNF4j.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BKBPxo-E.js";import"./index-CuMqu4kn.js";import"./index-Dbo19arK.js";import"./index-DGryg57l.js";import"./index-YzN5XZxp.js";import"./index-d5LJwfpl.js";import"./index-9RadqlI1.js";import"./index-o5aRRkkc.js";import"./useAxios-BVRZBVD1.js";import"./processStore-BBpG8xdL.js";n(1);const Ue={setup(){const l=n(""),o=pe(),_=n(!1),s=n(),C=n(),D=n(),{procData:M,procReceive:h}=ae(),{accountUsers:a,getUser:y,addUser:V}=re();console.log(a._value[0]);const S=n("me"),x=de(),r=ue({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",date:new Date}),t=n(""),R=n(""),P=n(""),B=n(""),E=n("");F(()=>{fe.init({duration:800,easing:"ease-in-out",once:!0})}),ge(()=>{if(a._value[0].name==="")return o.push("/");_.value=!0,t.value=a._value[0].name,R.value=a._value[0].email,P.value=a._value[0].phone,B.value=a._value[0].secondary_status,E.value=a._value[0].dba,console.log(a._value[0].phone)});const k=n(!1),L=n(!1);ne();const{lastNum:w,resNum:z}=j();P.value=a._value[0].phone,n(null);const v=n(""),U=n("");F(()=>{_.value=!0});const q=async()=>{try{const m=n(r.address),b=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(m.value)}&to=200`,u=await fetch(b);L.value=!0;const i=await u.json();console.log(i),r.muni=i.MinimumPropertyInfos[0].Municipality,r.license=a._value[0].license,r.contractor=a._value[0].name,r.folio=i.MinimumPropertyInfos[0].Strap;let p=String(w.value);console.log(w.value.length,w.value,p);let Q=p.substring(2,13),X=we(Q).value+1,Y=String(X);r.processNumber=S.value.concat(Y),console.log(r.processNumber),U.value=r.folio,v.value=U.value.substring(1,2),console.log(v.value),h(r),setTimeout(()=>{L.value=!1},2e3)}catch(m){alert(m)}},W=async()=>{h(r)},G=n(),H=n([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),J=()=>{o.push("/roofsystem")};function K(m,f){m=r,f=G.value,m.length!==0&&(x.addSystem(m,f,v.value),k.value=!0,console.log(m,f,v.value,"System added"))}const O=()=>{const m=document.getElementById("permitapp");console.log(m),ce(m).then(b=>{const u=b.toDataURL("image/png"),i=new me;i.text(`${r.processNumber}`,20,30),i.setGState(new i.GState({opacity:.4})),i.setFontSize(24),i.setTextColor(150,150,150),i.text("DigitalSolutions",i.internal.pageSize.getWidth()/2,i.internal.pageSize.getHeight()/2,{angle:0,align:"left",baseline:"bottom",renderingMode:"fill"}),console.log(i.text),i.addImage(u,"PNG",10,10,190,0),i.setGState(new i.GState({opacity:1}));const p=i.output("blob");console.log(p),f(p)});const f=async b=>{try{const u=b,i=new Blob([u],{type:"application/pdf"}),p=document.createElement("a");p.href=URL.createObjectURL(i),p.download=`${r.processNumber}-permitapp.pdf`,p.click(),URL.revokeObjectURL(p.href),console.log("PDF saved successfully without popping download dialog!")}catch(u){console.error("Error saving file:",u)}}};return T(async()=>{await Ve(k).changed(),O()}),{isDialog:_,pdfcleared:k,generatePdf:O,onSubmit:W,accountUsers:a,getUser:y,email:R,dba:E,invoke:T,phone:P,contractor:t,licenseStatus:B,addUser:V,navigateNext:J,addItemAndClear:K,selectedApplication:G,type:H,resNum:z,...ve(r),responseMessage:l,lastNum:w,useLast:j,load:q,checkMB:v,checkV:U,content:s,canvas:C,doc:D}}},c=l=>(xe("data-v-2aaaa450"),l=l(),Pe(),l),Ne={class:"md:w-3/4"},Ae={class:"container md:w-3/4",style:{"margin-left":"220px"}},Ie={class:"row"},Ce={class:"card flex flex-col gap-1"},De=c(()=>e("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Me={class:"card flex justify-center"},Re={class:"flex flex-col mt-3 grow basis-0 gap-3",style:{"max-width":"300px"}},Be=c(()=>e("label",{for:"license"},"License Status",-1)),Ee={class:"card flex flex-col gap-2"},Le={class:"flex flex-col grow basis-0 gap-2"},Ge=c(()=>e("label",{for:"addr"},"Property Address",-1)),Oe={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},je={class:"flex flex-col mt-3 grow basis-0 gap-3"},Fe=c(()=>e("label",{for:"dba"},"DBA ",-1)),Te={class:"flex flex-col mt-3 grow basis-0 gap-3"},ze=c(()=>e("label",{for:"contractor"},"Contractor Name",-1)),qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},We=c(()=>e("label",{for:"phone"},"Cell Phone Number",-1)),He={class:"flex flex-col mt-3 grow basis-0 gap-3"},Je=c(()=>e("label",{for:"Email"},"Email",-1)),Ke={class:"flex flex-col mt-3 grow basis-0 gap-3"},Qe=c(()=>e("label",{for:"muni"},"Municipality",-1)),Xe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ye=c(()=>e("label",{for:"folio"},"Folio",-1)),Ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},$e=c(()=>e("label",{for:"permit"},"Master Permit",-1)),eo={class:"flex flex-col mt-3 grow basis-0 gap-3"},oo=c(()=>e("label",{for:"processnum"},"mEProcess Number",-1)),to={key:0},so=c(()=>e("br",null,null,-1)),lo=c(()=>e("br",null,null,-1)),ao={"data-aos":"fade-up-right","data-aos-delay":"500"};function no(l,o,_,s,C,D){const M=ie,h=le,a=se,y=te,V=$,S=oe,x=ee,r=Z;return g(),N(ye,null,[s.isDialog?(g(),A(M,{key:0})):I("",!0),e("div",Ne,[e("div",Ae,[e("form",null,[e("div",Ie,[e("div",Ce,[De,e("div",Me,[d(h,{modelValue:s.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=t=>s.selectedApplication=t),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),e("div",Re,[Be,d(a,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":o[1]||(o[1]=t=>s.licenseStatus=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),e("div",Ee,[e("form",{class:"w-3/4",onSubmit:o[12]||(o[12]=(...t)=>s.onSubmit&&s.onSubmit(...t))},[e("div",Le,[Ge,be(d(a,{id:"addr",type:"text",modelValue:l.address,"onUpdate:modelValue":o[2]||(o[2]=t=>l.address=t),placeholder:"address"},null,8,["modelValue"]),[[r,"Make sure that either street or avenue is spelled out, direction could be shorten (sw)",void 0,{top:!0}]]),l.loading?(g(),N("i",Oe)):(g(),A(y,{key:0,id:"search",type:"button",label:"Search",class:"w-1/3",style:{"background-color":"#a4b5b9"},raised:"",icon:"pi pi-search-plus",loading:l.loading,onClick:s.load,onInput:l.createHtml},null,8,["loading","onClick","onInput"]))]),e("div",je,[Fe,d(a,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":o[3]||(o[3]=t=>s.dba=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),e("div",Te,[ze,d(a,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":o[4]||(o[4]=t=>s.contractor=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),e("div",qe,[We,d(V,{modelValue:s.phone,"onUpdate:modelValue":o[5]||(o[5]=t=>s.phone=t),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),e("div",He,[Je,d(a,{modelValue:s.email,"onUpdate:modelValue":o[6]||(o[6]=t=>s.email=t),invalid:s.email===null,error:l.emailError},null,8,["modelValue","invalid","error"]),l.invalid?(g(),A(S,{key:0,severity:"error"},{default:_e(()=>[Se("Email is required")]),_:1})):I("",!0)]),e("div",Ke,[Qe,d(a,{id:"muni",modelValue:l.muni,"onUpdate:modelValue":o[7]||(o[7]=t=>l.muni=t),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),e("div",Xe,[Ye,d(a,{id:"folio",modelValue:l.folio,"onUpdate:modelValue":o[8]||(o[8]=t=>l.folio=t),type:"text",placeholder:"folio",onInput:l.updatemEProcess},null,8,["modelValue","onInput"])]),e("div",Ze,[$e,d(a,{id:"permit",modelValue:l.permit,"onUpdate:modelValue":o[9]||(o[9]=t=>l.permit=t),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),e("div",eo,[oo,d(a,{id:"processnum",modelValue:l.processNumber,"onUpdate:modelValue":o[10]||(o[10]=t=>l.processNumber=t),type:"text",placeholder:"process number"},null,8,["modelValue"])]),s.responseMessage?(g(),N("p",to,he(s.responseMessage),1)):I("",!0),so,d(y,{id:"submit",type:"submit",label:"Submit",class:"w-1/3",style:{"background-color":"#a4b5b9"},raised:"",as:"router-link",to:"/roofsystem",onClick:o[11]||(o[11]=t=>s.addItemAndClear(l.formData,s.selectedApplication)),onChange:s.generatePdf},null,8,["onChange"])],32),lo,e("div",ao,[d(x)])])])])])])])],64)}const Co=ke(Ue,[["render",no],["__scopeId","data-v-2aaaa450"]]);export{Co as default};
