import{s as G}from"./index-teGLqtm7.js";import{u as A}from"./accountsStore-DSStt41V.js";import{u as I}from"./useAxios-DgZAEEaJ.js";import{e as l,j as w,f as N,u as T,w as E,k as S,o as k,c as x,g as m,h as U,l as y,p as r,a as D,d as j,t as V,q as C}from"./index-CUdRwf7e.js";import{u as z}from"./auth-CbXHwgXP.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BS_RWZw2.js";function R(){const i=l(null),c=l(null);let u=null;const o=l([]);let p=w({});const a=w({dba:"",email:"",cphone:"",bphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:"",projects:[],phone:""}),v=l(null),{addUser:g}=A();N(()=>{u=google.accounts.oauth2.initTokenClient({client_id:"978320609817-r83rgg9qsb4ntam9dek995cqcn779qut.apps.googleusercontent.com",scope:["openid","email","profile","https://www.googleapis.com/auth/gmail.readonly"].join(" "),callback:h})});const f=()=>u.requestAccessToken({prompt:"consent"},b()),_=()=>{i.value&&google.accounts.oauth2.revoke(i.value,()=>{i.value=null,c.value=null})};async function b(){let n="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/getaccounts";const{execute:t,then:e,data:s}=I(n,{method:"GET"},{immediate:!1});let B=l([]);B.value=t().then(K=>{p=s.value;for(const[L,q]of Object.entries(p))o.value.push(q);console.log(o.value)})}async function h(n){if(n.error)return console.error(n);i.value=n.access_token;const t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${n.access_token}`}}).then(e=>e.json());v.value=t.email,d(v)}async function d(n){const t=await n.value;console.log(t,n.value);for(let e=0;e<=o.value[0].length;e++)console.log(o.value[0][e].email,n.value),o.value[0][e].email===t&&(a.email=await o.value[0][e].email,a.name=await o.value[0][e].name,a.dba=o.value[0][e].dba,a.cphone=o.value[0][e].cphone,a.bphone=o.value[0][e].bphone,a.phone=o.value[0][e].bphone,a.expiration_date=o.value[0][e].expiration_date,a.projects=o.value[0][e].projects,a.secondary_status=o.value[0][e].secondary_status,a.email=o.value[0][e].email,a.license=o.value[0][e].license,console.log(a),g(a))}return{accessToken:i,idPayload:c,signIn:f,signOut:_,checkEmail:d,localData:o,acctUser:a}}const P={class:"relative w-full h-screen overflow-hidden"},$={class:"relative z-10 flex items-center justify-center h-full bg-black/50"},M={style:{"border-radius":"20px",padding:"0.5rem"}},F={class:"container w-full py-15 px-8 sm:px-2"},H={key:0},J={__name:"authGoogle",setup(i){const{accessToken:c,idPayload:u,signIn:o,signOut:p,localData:a,acctUser:v}=R();l(!1);const g=T();l(!1);const f=l([]);z(),l([]);let _=w({dba:"",email:"",cphone:"",bphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:"",phone:""});const{getUser:b}=A(),h=()=>{console.log(b),a.value.forEach((t,e)=>{for(let s=0;s<t.length;s++)c.value&&(console.log(t[s].bphone),f.value.push(t[s]),_.phone=t[s].bphone,d())})};function d(){n()}function n(){g.push("/permitapp")}return E(h,()=>{}),S(()=>{c.value&&fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=4",{headers:{Authorization:`Bearer ${c.value}`}}).then(t=>t.json()).then(console.log)}),(t,e)=>{const s=G;return k(),x("div",P,[m("div",$,[m("div",M,[m("div",F,[m("div",null,[U(s,{class:"p-button hover:bg-blue text-black",onClick:r(o),onChange:h,severity:"Info",raised:"",onInput:t.email},{default:y(()=>[C("Sign in with Google")]),_:1},8,["onClick","onInput"]),r(c)?(k(),D(s,{key:0,onClick:r(p)},{default:y(()=>[C("SignÂ out")]),_:1},8,["onClick"])):j("",!0)])]),r(u)?(k(),x("pre",H,V(r(u)),1)):j("",!0)])])])}}},ae=O(J,[["__scopeId","data-v-2ce4b122"]]);export{ae as default};
