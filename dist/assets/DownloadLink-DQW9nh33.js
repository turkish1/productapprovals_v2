import{s as F}from"./index-C9GH5-xJ.js";import{e,N as M,u as q,f as b,ao as G,ab as x,ap as B,at as I,o as V,c as C,g as t,R as Y,aq as j,h as A,t as L,d as H,au as J}from"./index-cgZ6LquJ.js";import{u as K,a as Q}from"./use-downloadpdf-CwI0QU7v.js";import{c as W,u as X}from"./pdfsignStore-Ch0holaO.js";import{u as Z}from"./permitapp-CdsvFywY.js";import"./index-9wW_nSFB.js";import"./useAxios-Djlm2Cdy.js";const oo={class:"card"},eo={class:"flex flex-col w-1/3 gap-2 shadow-lg shadow-cyan-800",style:{"margin-left":"550px","margin-top":"440px"}},so={class:"payment-widget"},to=t("h2",{style:{color:"black"}},"Download Link",-1),ao={key:0,class:"confirmation"},fo={__name:"DownloadLink",setup(no){var g,y;const O=Z(),u=W(),i=e(0),d=e(((y=(g=O.$state.permitapp[0])==null?void 0:g.formdt)==null?void 0:y.muniProc)||""),{secondFetch:m}=K(d.value),P=e(!1),l=e(!1),R=e(!1),T=e(!1),p=e(!1);e(null);const r=Q();M(r.$state);const{resp:f}=X(),U=q();b(()=>{var o,s;i.value=1,u.addCount(i),console.log(u),((s=(o=f.value)==null?void 0:o.status)==null?void 0:s.status)===200&&(R.value=!0,console.log(f.value.status.status))});const v=e("");b(async()=>{const o=new URLSearchParams(location.search).get("session_id");if(v.value=o,o)console.log(v.value);else{console.log(o);return}});const a=G("my-storage",{processNumber:d.value}),$=x(()=>{l.value=!0});B($,()=>{});function w(){m(a.value.processNumber),_()}const h=x(()=>{setTimeout(()=>{T.value=!0},1e3),m(a.value),console.log(a.value),_()}),z=()=>{U.push("/")},_=async()=>{var k,D,N,S;const o=(D=(k=r.downloadinput[0])==null?void 0:k.downloadData)==null?void 0:D.download_url;if(console.log(o),!o||o.length===0)return;console.log(o,a.value);const s=(S=(N=r.downloadinput[0])==null?void 0:N.downloadData)==null?void 0:S.download_url;if(!s)return;P.value=!0;const c=s,E="processnumber.zip",n=document.createElement("a");n.href=c,n.download=E,n.click(),n.remove(),l.value=!0,p.value=!0};return B(h,w,()=>{}),I(async()=>{await J(h).toBe(!0)}),(o,s)=>{const c=F;return V(),C("div",oo,[t("i",{class:"pi pi-home",style:{"font-size":"2rem"},onClick:z}),t("div",eo,[t("div",so,[to,Y(A(c,{icon:"pi pi-arrow-circle-down",severity:"info","aria-label":"User",onClick:w},null,512),[[j,l.value]])]),p.value?(V(),C("div",ao,[t("p",null,"Thank you, "+L(o.Name)+"! Your payment of $"+L(107)+" was processed.",1)])):H("",!0)])])}}};export{fo as default};
