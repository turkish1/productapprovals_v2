import{D as w,s as I}from"./DataService-C6gOmqb-.js";import{s as U}from"./index-cghCONSw.js";import{s as C}from"./index-CwY3ODdi.js";import{s as M}from"./index-B8TVrfMh.js";import{r as n,_ as D,u as E,X as R,t as L,c as _,b as s,a as d,J as B,j,k as F,o as b,p as $,d as q}from"./index-CzuNuKWQ.js";import{u as z}from"./permitapp-DksGW1HP.js";import"./axios-DTyqpfTh.js";import"./index-CWt2-Skw.js";import"./index-Tjzx-ejw.js";function h(){const e=n(null),o=n(null);return w.getLastProcess().then(r=>{e.value=r.data,e.value.forEach(l=>{console.log(l.processNumber),o.value=l.processNumber})}).catch(r=>{console.error("Error:",r)}),{resNum:e,lastNum:o}}function W(){const{resNum:e,lastNum:o}=h(),r=n(""),l=n(new Date().getFullYear()),m=n(6),g=n("me"),f=Array.from({length:10**m.value},(p,u)=>`${g.value}${l.value}${String(u).padStart(m.value,"0")}`),a=h();return console.log(a),r.value=f[0]+1,console.log(r.value,o.value,a),{pNum:r,lastNum:o,resNum:e,test:a}}const Y={setup(){const e=n(""),o=E(),r=z(),l=R({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),m=n(!1),{pNum:g}=W(),{lastNum:f,resNum:a}=h(),p=n(""),u=n(""),t=async()=>{const i=n(l.address),A=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(i.value)}&to=200`,k=await fetch(A);m.value=!0;const y=await k.json();console.log(y),l.muni=y.MinimumPropertyInfos[0].Municipality,l.folio=y.MinimumPropertyInfos[0].Strap,l.processNumber=g.value,u.value=l.folio,p.value=u.value.substring(0,2),console.log(p.value),setTimeout(()=>{m.value=!1},2e3)},P=async()=>{await w.postProcessnumber(l.processNumber).then(i=>{e.value="Form submitted successfully!",console.log("Response:",i.data)}).catch(i=>{e.value="An error occurred while submitting the form.",console.error("Error:",i)})},V=n(),N=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),S=()=>{o.push("/generalpage")};function x(i,v){i=l,v=V.value,i.length!==0&&(r.addSystem(i,v),console.log(i,v,"System added"))}return{onSubmit:P,navigateNext:S,addItemAndClear:x,selectedApplication:V,type:N,resNum:a,...L(l),responseMessage:e,lastNum:f,useLast:h,load:t,checkMB:p,checkV:u}}},c=e=>($("data-v-a687b052"),e=e(),q(),e),G={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},J={class:"md:w-2/3"},O={class:"container"},X={class:"row"},H={class:"card flex flex-col gap-2"},K=c(()=>s("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Q={class:"card flex justify-center"},T={class:"card flex flex-col gap-4"},Z={class:"flex flex-wrap gap-4"},ee={class:"flex flex-col grow basis-0 gap-3"},oe=c(()=>s("label",{for:"addr"},"Property Address",-1)),se={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},le={class:"flex flex-col grow basis-0 gap-3"},te=c(()=>s("label",{for:"contractor"},"Contractor Name",-1)),ae={class:"flex flex-col grow basis-0 gap-3"},ne=c(()=>s("label",{for:"phone"},"Cell Phone Number",-1)),re={class:"flex flex-col grow basis-0 gap-3"},ie=c(()=>s("label",{for:"Email"},"Email",-1)),de={class:"flex flex-col grow basis-0 gap-3"},ce=c(()=>s("label",{for:"muni"},"Municipality",-1)),pe={class:"flex flex-col grow basis-0 gap-3"},ue=c(()=>s("label",{for:"folio"},"Folio",-1)),me={class:"flex flex-col grow basis-0 gap-3"},fe=c(()=>s("label",{for:"permit"},"Master Permit",-1)),ge={class:"flex flex-col grow basis-0 gap-3"},ve=c(()=>s("label",{for:"processnum"},"mEProcess Number",-1)),be=c(()=>s("br",null,null,-1)),he={key:0};function ye(e,o,r,l,m,g){const f=M,a=C,p=U,u=I;return b(),_("div",G,[s("div",J,[s("div",O,[s("form",null,[s("div",X,[s("div",H,[K,s("div",Q,[d(f,{modelValue:l.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=t=>l.selectedApplication=t),options:l.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),s("div",T,[s("div",Z,[s("form",{class:"w-3/4",onSubmit:o[10]||(o[10]=(...t)=>l.onSubmit&&l.onSubmit(...t))},[s("div",ee,[oe,d(a,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":o[1]||(o[1]=t=>e.address=t),placeholder:"address"},null,8,["modelValue"]),e.loading?(b(),_("i",se)):(b(),B(p,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:l.load},null,8,["loading","onClick"]))]),s("div",le,[te,d(a,{id:"zip",modelValue:e.contractor,"onUpdate:modelValue":o[2]||(o[2]=t=>e.contractor=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),s("div",ae,[ne,d(u,{modelValue:e.phone,"onUpdate:modelValue":o[3]||(o[3]=t=>e.phone=t),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:e.phone===""},null,8,["modelValue","invalid"])]),s("div",re,[ie,d(a,{modelValue:e.email,"onUpdate:modelValue":o[4]||(o[4]=t=>e.email=t),invalid:e.email===null},null,8,["modelValue","invalid"])]),s("div",de,[ce,d(a,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":o[5]||(o[5]=t=>e.muni=t),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),s("div",pe,[ue,d(a,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":o[6]||(o[6]=t=>e.folio=t),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),s("div",me,[fe,d(a,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":o[7]||(o[7]=t=>e.permit=t),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),s("div",ge,[ve,d(a,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":o[8]||(o[8]=t=>e.processNumber=t),type:"text",placeholder:"process number"},null,8,["modelValue"])]),be,d(p,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:o[9]||(o[9]=t=>l.addItemAndClear(e.formData,l.selectedApplication))})],32),l.responseMessage?(b(),_("p",he,j(l.responseMessage),1)):F("",!0)])])])])])])])])}const Ie=D(Y,[["render",ye],["__scopeId","data-v-a687b052"]]);export{Ie as default};
