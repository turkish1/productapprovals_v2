import{s as q}from"./index-CmirR9VJ.js";import{u as A}from"./accountsStore-Cx1Q4B1n.js";import{u as G}from"./useAxios-3-4xB1J4.js";import{e as l,j as w,f as I,u as N,w as T,k as S,o as k,c as x,g as m,h as U,l as y,p as r,a as D,d as j,t as V,q as C}from"./index-BYaaa-Gm.js";import{u as z}from"./auth-IgdEUlQe.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DG2idcqK.js";function R(){const i=l(null),c=l(null);let u=null;const a=l([]);let p=w({});const t=w({dba:"",email:"",cphone:"",bphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:"",projects:[],phone:""}),f=l(null),{addUser:v}=A();I(()=>{u=google.accounts.oauth2.initTokenClient({client_id:"978320609817-r83rgg9qsb4ntam9dek995cqcn779qut.apps.googleusercontent.com",scope:["openid","email","profile","https://www.googleapis.com/auth/gmail.readonly"].join(" "),callback:h})});const g=()=>u.requestAccessToken({prompt:"consent"},b()),_=()=>{i.value&&google.accounts.oauth2.revoke(i.value,()=>{i.value=null,c.value=null})};async function b(){let n="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/getaccounts";const{execute:o,then:e,data:s}=G(n,{method:"GET"},{immediate:!1});let B=l([]);B.value=o().then(K=>{p=s.value;for(const[L,E]of Object.entries(p))a.value.push(E)})}async function h(n){if(n.error)return console.error(n);i.value=n.access_token;const o=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${n.access_token}`}}).then(e=>e.json());f.value=o.email,d(f)}async function d(n){const o=await n.value;for(let e=0;e<=a.value[0].length;e++)a.value[0][e].email===o&&(t.email=await a.value[0][e].email,t.name=await a.value[0][e].name,t.dba=a.value[0][e].dba,t.cphone=a.value[0][e].cphone,t.bphone=a.value[0][e].bphone,t.phone=a.value[0][e].bphone,t.expiration_date=a.value[0][e].expiration_date,t.projects=a.value[0][e].projects,t.secondary_status=a.value[0][e].secondary_status,t.email=a.value[0][e].email,t.license=a.value[0][e].license,v(t))}return{accessToken:i,idPayload:c,signIn:g,signOut:_,checkEmail:d,localData:a,acctUser:t}}const P={class:"relative w-full h-screen overflow-hidden"},$={class:"relative z-10 flex items-center justify-center h-full bg-black/50"},M={style:{"border-radius":"20px",padding:"0.5rem"}},F={class:"container w-full py-15 px-8 sm:px-2"},H={key:0},J={__name:"authGoogle",setup(i){const{accessToken:c,idPayload:u,signIn:a,signOut:p,localData:t,acctUser:f}=R();l(!1);const v=N();l(!1);const g=l([]);z(),l([]);let _=w({dba:"",email:"",cphone:"",bphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:"",phone:""});const{getUser:b}=A(),h=()=>{console.log(b),t.value.forEach((o,e)=>{for(let s=0;s<o.length;s++)c.value&&(console.log(o[s].bphone),g.value.push(o[s]),_.phone=o[s].bphone,d())})};function d(){n()}function n(){v.push("/permitapp")}return T(h,()=>{}),S(()=>{c.value&&fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=4",{headers:{Authorization:`Bearer ${c.value}`}}).then(o=>o.json()).then(console.log)}),(o,e)=>{const s=q;return k(),x("div",P,[m("div",$,[m("div",M,[m("div",F,[m("div",null,[U(s,{class:"p-button hover:bg-blue text-black",onClick:r(a),onChange:h,severity:"Info",raised:"",onInput:o.email},{default:y(()=>[C("Sign in with Google")]),_:1},8,["onClick","onInput"]),r(c)?(k(),D(s,{key:0,onClick:r(p)},{default:y(()=>[C("SignÂ out")]),_:1},8,["onClick"])):j("",!0)])]),r(u)?(k(),x("pre",H,V(r(u)),1)):j("",!0)])])])}}},te=O(J,[["__scopeId","data-v-2ce4b122"]]);export{te as default};
