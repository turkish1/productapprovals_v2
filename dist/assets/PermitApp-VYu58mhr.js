import{s as A}from"./index-Bukaw8rD.js";import{s as k}from"./index-VsTvuHxd.js";import{s as I}from"./index-DVoCubKo.js";import{s as U}from"./index-D6jD5GL5.js";import{D as V}from"./DataService-CyJ9LaQ4.js";import{r as d,_ as C,u as M,M as D,t as R,c as v,e as y,f as s,g as i,x as E,i as L,j as B,p as j,k as F}from"./index-FANDn_ZI.js";import{u as $}from"./permitapp-fEIFipHz.js";import"./index-CfP6HqSC.js";import"./index-DJuLM2T-.js";function _(){const e=d(0);return{resNum:e,lastNum:async()=>{await V.getLastProcess().then(a=>{e.value=a.data,console.log("Response:",a.data,e.value)}).catch(a=>{console.error("Error:",a)})}}}function q(){const{resNum:e,lastNum:o}=_();console.log(e.value);const a=d(""),t=d(new Date().getFullYear()),p=d(6),f=d("me"),u=Array.from({length:10**p.value},(n,m)=>`${f.value}${t.value}${String(m).padStart(p.value,"0")}`);return a.value=u[0]+1,console.log(a.value,e.value),{pNum:a,lastNum:o,resNum:e}}const z={setup(){const e=d(""),o=M(),a=$(),t=D({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),p=d(!1),f=async()=>{const r=d(t.address),N=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(r.value)}&to=200`,S=await fetch(N);p.value=!0;const h=await S.json();console.log(h),t.muni=h.MinimumPropertyInfos[0].Municipality,t.folio=h.MinimumPropertyInfos[0].Strap,t.processNumber=u.value,setTimeout(()=>{p.value=!1},2e3)},{pNum:u}=q(),{lastNum:n,resNum:m}=_(),b=async()=>{await V.postProcessnumber(t.processNumber).then(r=>{e.value="Form submitted successfully!",console.log("Response:",r.data)}).catch(r=>{e.value="An error occurred while submitting the form.",console.error("Error:",r)})},l=d(),w=d([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),P=()=>{o.push("/generalpage")};function x(r,g){r=t,g=l.value,r.length!==0&&(a.addSystem(r,g),console.log(r,g,"System added"))}return{onSubmit:b,navigateNext:P,addItemAndClear:x,selectedApplication:l,type:w,resNum:m,...R(t),responseMessage:e,lastNum:n,useLast:_,load:f}}},c=e=>(j("data-v-e136aaee"),e=e(),F(),e),W={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},Y={class:"md:w-2/3"},G={class:"container"},O={class:"row"},H={class:"card flex flex-col gap-2"},J=c(()=>s("div",{class:"font-semibold text-xl"},"Permit Application",-1)),K={class:"card flex justify-center"},Q={class:"card flex flex-col gap-4"},T={class:"flex flex-wrap gap-4"},X={class:"flex flex-col grow basis-0 gap-3"},Z=c(()=>s("label",{for:"addr"},"Property Address",-1)),ee={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},oe={class:"flex flex-col grow basis-0 gap-3"},se=c(()=>s("label",{for:"contractor"},"Contractor Name",-1)),le={class:"flex flex-col grow basis-0 gap-3"},te=c(()=>s("label",{for:"phone"},"Cell Phone Number",-1)),ae={class:"flex flex-col grow basis-0 gap-3"},ne=c(()=>s("label",{for:"Email"},"Email",-1)),re={class:"flex flex-col grow basis-0 gap-3"},ie=c(()=>s("label",{for:"muni"},"Municipality",-1)),de={class:"flex flex-col grow basis-0 gap-3"},ce=c(()=>s("label",{for:"folio"},"Folio",-1)),pe={class:"flex flex-col grow basis-0 gap-3"},me=c(()=>s("label",{for:"permit"},"Master Permit",-1)),ue={class:"flex flex-col grow basis-0 gap-3"},fe=c(()=>s("label",{for:"processnum"},"mEProcess Number",-1)),ge=c(()=>s("br",null,null,-1)),ve={key:0};function be(e,o,a,t,p,f){const u=U,n=I,m=k,b=A;return v(),y("div",W,[s("div",Y,[s("div",G,[s("form",null,[s("div",O,[s("div",H,[J,s("div",K,[i(u,{modelValue:t.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=l=>t.selectedApplication=l),options:t.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),s("div",Q,[s("div",T,[s("form",{class:"w-3/4",onSubmit:o[10]||(o[10]=(...l)=>t.onSubmit&&t.onSubmit(...l))},[s("div",X,[Z,i(n,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":o[1]||(o[1]=l=>e.address=l),placeholder:"address"},null,8,["modelValue"]),e.loading?(v(),y("i",ee)):(v(),E(m,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:t.load},null,8,["loading","onClick"]))]),s("div",oe,[se,i(n,{id:"zip",modelValue:e.contractor,"onUpdate:modelValue":o[2]||(o[2]=l=>e.contractor=l),type:"text",placeholder:"name"},null,8,["modelValue"])]),s("div",le,[te,i(b,{modelValue:e.phone,"onUpdate:modelValue":o[3]||(o[3]=l=>e.phone=l),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:e.phone===""},null,8,["modelValue","invalid"])]),s("div",ae,[ne,i(n,{modelValue:e.email,"onUpdate:modelValue":o[4]||(o[4]=l=>e.email=l),invalid:e.email===null},null,8,["modelValue","invalid"])]),s("div",re,[ie,i(n,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":o[5]||(o[5]=l=>e.muni=l),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),s("div",de,[ce,i(n,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":o[6]||(o[6]=l=>e.folio=l),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),s("div",pe,[me,i(n,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":o[7]||(o[7]=l=>e.permit=l),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),s("div",ue,[fe,i(n,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":o[8]||(o[8]=l=>e.processNumber=l),type:"text",placeholder:"process number"},null,8,["modelValue"])]),ge,i(m,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:o[9]||(o[9]=l=>t.addItemAndClear(e.formData,t.selectedApplication))})],32),t.responseMessage?(v(),y("p",ve,L(t.responseMessage),1)):B("",!0)])])])])])])])])}const Ae=C(z,[["render",be],["__scopeId","data-v-e136aaee"]]);export{Ae as default};
