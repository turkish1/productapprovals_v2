import{_ as S,X as x,r as i,o as f,c as v,b as s,k as N,F,M as L,i as P,j as k,u as R,t as E,a as c,J as $,p as B,d as z}from"./index-CKODHZk4.js";import{D as A,s as j}from"./DataService-DZeJ6CwM.js";import{s as W}from"./index-DqxULbGZ.js";import{s as q}from"./index-diGoLIfO.js";import{s as O}from"./index-BOhTAy9n.js";import{u as Y}from"./permitapp-DOxvHkyd.js";import"./axios-DTyqpfTh.js";import"./index-C4yhVwpf.js";import"./index-SxvfniJH.js";const G={class:"bg-clip-content p-6 bg-gray w-2/3 border-4 border-midnight border-dashed"},J={key:0},T={class:"file-previews"},X=["src"],Z={__name:"DropZone",setup(e){const o=x([]),d=i(null),l=()=>{},g=()=>{},_=n=>{const r=n.dataTransfer.files;a(r)},h=n=>{const r=n.target.files;a(r)},a=n=>{Array.from(n).forEach(r=>{const t=new FileReader;t.onload=b=>{r.preview=b.target.result,o.push(r)},p(r)?t.readAsDataURL(r):o.push(r)})},p=n=>n.type.startsWith("image/");return(n,r)=>(f(),v("div",G,[s("div",{class:"file-drop-zone",onDragover:P(l,["prevent"]),onDrop:P(_,["prevent"]),onDragleave:P(g,["prevent"])},[o.length?N("",!0):(f(),v("p",J,"Drag and drop files here, or click to select files")),s("input",{type:"file",multiple:"",onChange:h,ref_key:"fileInput",ref:d,style:{display:"none"}},null,544),s("div",T,[(f(!0),v(F,null,L(o,(t,b)=>(f(),v("div",{key:b,class:"file-preview"},[p(t)?(f(),v("img",{key:0,src:t.preview,alt:"File preview"},null,8,X)):N("",!0),s("p",null,k(t.name),1)]))),128))])],32)]))}},H=S(Z,[["__scopeId","data-v-987cb64c"]]);function w(){const e=i(null),o=i(null);return A.getLastProcess().then(d=>{e.value=d.data,e.value.forEach(l=>{console.log(l.processNumber),o.value=l.processNumber})}).catch(d=>{console.error("Error:",d)}),{resNum:e,lastNum:o}}function K(){const{resNum:e,lastNum:o}=w(),d=i(""),l=i(new Date().getFullYear()),g=i(6),_=i("me"),h=Array.from({length:10**g.value},(p,n)=>`${_.value}${l.value}${String(n).padStart(g.value,"0")}`),a=w();return console.log(a),d.value=h[0]+1,console.log(d.value,o.value,a),{pNum:d,lastNum:o,resNum:e,test:a}}const Q={setup(){const e=i(""),o=R(),d=Y(),l=x({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),g=i(!1),{pNum:_}=K(),{lastNum:h,resNum:a}=w(),p=i(""),n=i(""),r=async()=>{const u=i(l.address),M=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(u.value)}&to=200`,C=await fetch(M);g.value=!0;const V=await C.json();console.log(V),l.muni=V.MinimumPropertyInfos[0].Municipality,l.folio=V.MinimumPropertyInfos[0].Strap,l.processNumber=_.value,n.value=l.folio,p.value=n.value.substring(0,2),console.log(p.value),setTimeout(()=>{g.value=!1},2e3)},t=async()=>{await A.postProcessnumber(l.processNumber).then(u=>{e.value="Form submitted successfully!",console.log("Response:",u.data)}).catch(u=>{e.value="An error occurred while submitting the form.",console.error("Error:",u)})},b=i(),D=i([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),I=()=>{o.push("/generalpage")};function U(u,y){u=l,y=b.value,u.length!==0&&(d.addSystem(u,y),console.log(u,y,"System added"))}return{onSubmit:t,navigateNext:I,addItemAndClear:U,selectedApplication:b,type:D,resNum:a,...E(l),responseMessage:e,lastNum:h,useLast:w,load:r,checkMB:p,checkV:n}}},m=e=>(B("data-v-ce72b8a5"),e=e(),z(),e),ee={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},oe={class:"md:w-2/3"},se={class:"container"},te={class:"row"},le={class:"card flex flex-col gap-2"},ae=m(()=>s("div",{class:"font-semibold text-xl"},"Permit Application",-1)),ne={class:"card flex justify-center"},re={class:"card flex flex-col gap-4"},ie={class:"flex flex-wrap gap-4"},de={class:"flex flex-col grow basis-0 gap-3"},ce=m(()=>s("label",{for:"addr"},"Property Address",-1)),pe={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},ue={class:"flex flex-col grow basis-0 gap-3"},me=m(()=>s("label",{for:"contractor"},"Contractor Name",-1)),fe={class:"flex flex-col grow basis-0 gap-3"},ge=m(()=>s("label",{for:"phone"},"Cell Phone Number",-1)),ve={class:"flex flex-col grow basis-0 gap-3"},he=m(()=>s("label",{for:"Email"},"Email",-1)),_e={class:"flex flex-col grow basis-0 gap-3"},be=m(()=>s("label",{for:"muni"},"Municipality",-1)),ye={class:"flex flex-col grow basis-0 gap-3"},we=m(()=>s("label",{for:"folio"},"Folio",-1)),Ve={class:"flex flex-col grow basis-0 gap-3"},Pe=m(()=>s("label",{for:"permit"},"Master Permit",-1)),Ne={class:"flex flex-col grow basis-0 gap-3"},Se=m(()=>s("label",{for:"processnum"},"mEProcess Number",-1)),xe=m(()=>s("br",null,null,-1)),ke={key:0};function Ae(e,o,d,l,g,_){const h=O,a=q,p=W,n=j,r=H;return f(),v("div",ee,[s("div",oe,[s("div",se,[s("form",null,[s("div",te,[s("div",le,[ae,s("div",ne,[c(h,{modelValue:l.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=t=>l.selectedApplication=t),options:l.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),s("div",re,[s("div",ie,[s("form",{class:"w-3/4",onSubmit:o[10]||(o[10]=(...t)=>l.onSubmit&&l.onSubmit(...t))},[s("div",de,[ce,c(a,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":o[1]||(o[1]=t=>e.address=t),placeholder:"address"},null,8,["modelValue"]),e.loading?(f(),v("i",pe)):(f(),$(p,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:l.load},null,8,["loading","onClick"]))]),s("div",ue,[me,c(a,{id:"zip",modelValue:e.contractor,"onUpdate:modelValue":o[2]||(o[2]=t=>e.contractor=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),s("div",fe,[ge,c(n,{modelValue:e.phone,"onUpdate:modelValue":o[3]||(o[3]=t=>e.phone=t),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:e.phone===""},null,8,["modelValue","invalid"])]),s("div",ve,[he,c(a,{modelValue:e.email,"onUpdate:modelValue":o[4]||(o[4]=t=>e.email=t),invalid:e.email===null},null,8,["modelValue","invalid"])]),s("div",_e,[be,c(a,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":o[5]||(o[5]=t=>e.muni=t),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),s("div",ye,[we,c(a,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":o[6]||(o[6]=t=>e.folio=t),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),s("div",Ve,[Pe,c(a,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":o[7]||(o[7]=t=>e.permit=t),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),s("div",Ne,[Se,c(a,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":o[8]||(o[8]=t=>e.processNumber=t),type:"text",placeholder:"process number"},null,8,["modelValue"])]),xe,c(p,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:o[9]||(o[9]=t=>l.addItemAndClear(e.formData,l.selectedApplication))})],32),l.responseMessage?(f(),v("p",ke,k(l.responseMessage),1)):N("",!0)])])])])]),c(r)])])])}const $e=S(Q,[["render",Ae],["__scopeId","data-v-ce72b8a5"]]);export{$e as default};
