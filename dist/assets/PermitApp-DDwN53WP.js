import{s as ae,_ as le}from"./index-B28T9MN4.js";import{s as O}from"./index-CYlNlSDT.js";import{s as ne}from"./index-kc_xTFUo.js";import{s as re}from"./index-DBGDDv5N.js";import{s as ie}from"./index-M6NyKZF7.js";import{s as ce}from"./index-C8gfBxaY.js";import{_ as G,r as l,c as S,d as N,e as d,i as de,f as e,p as J,j as Z,k as pe,a as $,u as ue,o as me,w as ge,t as fe,M as j,q,n as ve}from"./index-B0iIhuxd.js";import{a as he,u as be}from"./useAxios-MoK05tYO.js";import{u as _e}from"./accountsStore-BcocgZ8-.js";import{u as ye}from"./permitapp-FBgaFKR9.js";import{h as we,E as Se}from"./jspdf.es.min-QN_A7OR4.js";import{a as Pe,i as z,u as xe,b as Ve}from"./index-BgOtcB1e.js";import"./index-BG_ybJ1n.js";import"./index-CDtNPN5S.js";const _=t=>(J("data-v-7fc421a0"),t=t(),Z(),t),Ae={class:"card flex justify-center ."},Ne=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-8 ..."},[e("p",{style:{color:"black"}},"It is the applicant's responsiblity to complete this application correctly.")],-1)),ke=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"black"}},"Failure to provide valid permitting information can result in failed inspections and/or cancelation of the permit by the Authority Having Jurisdiction (AHJ).")],-1)),Ie=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"black"}},"Double permit fees plus a fine determined by the AHJ issuing the permit, can be required for work without a permit.")],-1)),Ue=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"red"}},"Refunds will not be provided by the AHJ issuing the permit, due to errors on the applicant's part.")],-1)),De=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"red"}},"Any deviations from an approved permit package will require a permit revision.")],-1)),Me=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"black"}},"This application is only valid for residential roof permits, either standalone or tied to a master building permit.")],-1)),Ce=_(()=>e("div",{class:"grid grid-cols-1 gap-2 place-content-center h-12 ..."},[e("p",{style:{color:"black"}},"The permit applicant agrees to comply with these terms of use requirements when obtaining this permit electronically.")],-1)),Te={class:"flex justify-end gap-2"},Ee={__name:"PermitInitalAgreement",setup(t){const o=l(!0);return(i,s)=>{const g=ce,h=O,b=ie;return S(),N("div",Ae,[d(b,{visible:o.value,"onUpdate:visible":s[2]||(s[2]=c=>o.value=c),modal:"",header:"Terms Of Use",style:{width:"70rem"}},{default:de(()=>[Ne,d(g),ke,Ie,Ue,De,Me,Ce,e("div",Te,[d(h,{type:"button",modelValue:i.agreement,"onUpdate:modelValue":s[0]||(s[0]=c=>i.agreement=c),severity:"contrast",label:"I Agree",onClick:s[1]||(s[1]=c=>o.value=!1)},null,8,["modelValue"])])]),_:1},8,["visible"])])}}},Be=G(Ee,[["__scopeId","data-v-7fc421a0"]]),a=he.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),Le={getAddr(){return a.get("/folio")},postProcessnumber(t){return a.post("/process",t)},getLastProcess(){return a.get("/lastnumber")},getSlopeless(){return a.get("/slopeless")},getSlopemore(){return a.get("/slopemore")},getdeOne(){return a.get("/desupone")},getdeTwo(){return a.get("/desuptwo")},getdeThree(){return a.get("/desupthree")},getdeFour(){return a.get("/desupfour")},getZones23(){return a.get("/gableroofs23")},getNoa(){return a.get("/noa")},getSBS(){return a.get("/shinglesbs")},getSystemE(){return a.get("/systemtype")},getburMaterial(){return a.get("/burmaterial")},getnewburMaterial(){return a.get("/burmaterials")},getburSystem(){return a.get("/bursystem")},getPoly(){return a.get("/shinglepoly")},getSystemF(){return a.get("/systemtypef")},getdeGauge(){return a.get("/degauge")},getdeMaterial(){return a.get("/dematerial")},getdeMatMore(){return a.get("/dematerials")},getdeSize(){return a.get("/desize")},getdeFastener(){return a.get("/defastener")},getprimeBase(){return a.get("/primebase")},getPerimeter(){return a.get("/perimeter")},getNoas(){return a.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return a.get("/tilenoa")},getZones(){return a.get("/gablezones")},getLay(){return a.get("/underlaymentshingle")},getContractors(){return a.get("/contractors")},postAccount(t){return a.post("/accounts",t)},getAccount(){return a.get("/retriveaccounts")},getDripMaterials(){return a.get("/dripmaterials")}};function k(){const t=l(null),o=l(0);return Le.getLastProcess().then(i=>{t.value=i.data,t.value.forEach(s=>{console.log(s.processNumber),o.value=s.processNumber})}).catch(i=>{console.error("Error:",i)}),{resNum:t,lastNum:o}}function Fe(){const{resNum:t,lastNum:o}=k(),i=l(""),s=l(new Date().getFullYear()),g=l(6),h=l("me"),b=Array.from({length:10**g.value},(r,m)=>`${h.value}${s.value}${String(m).padStart(g.value,"0")}`),c=k();return console.log(c),i.value=b[0]+1,o.value!==0||(i.value=o.value+1),{pNum:i,lastNum:o,resNum:t,test:c}}const Re=pe("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(t){this.processinput.push({procData:t,completed:!1})}}});function He(){const t=l("");let o=l([]);const i=Re(),s=l("");let g="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:h,data:b}=be(g,{method:"POST"},{immediate:!1});let c=$({});function r(m){console.log(m),c=m,h({data:m}),t.value="Form submitted successfully!",i.addData(c),console.log(c,"System added")}return{error:s,results:o,procReceive:r,responseMessage:t,procData:c,procStore:i}}l(1);const je={setup(){const t=l(""),o=ue(),i=l(!1),s=l(),g=l(),h=l(),{procData:b,procReceive:c}=He(),{accountUsers:r,getUser:m,addUser:I}=_e();console.log(r._value[0]);const U=l("me"),n=ye(),u=$({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),T=l(""),E=l(""),D=l(""),B=l(""),L=l("");Pe(()=>{if(r._value[0].name==="")return o.push("/");i.value=!0,T.value=r._value[0].name,E.value=r._value[0].email,D.value=r._value[0].phone,B.value=r._value[0].secondary_status,L.value=r._value[0].dba,console.log(r._value[0].phone)});const M=l(!1),F=l(!1);Fe();const{lastNum:V,resNum:W}=k();D.value=r._value[0].phone,l(null);const P=l(""),C=l("");me(()=>{i.value=!0});const Y=async()=>{const f=l(u.address),x=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(f.value)}&to=200`,w=await fetch(x);F.value=!0;const v=await w.json();console.log(v),u.muni=v.MinimumPropertyInfos[0].Municipality,u.folio=v.MinimumPropertyInfos[0].Strap;let A=String(V.value);console.log(V.value.length,V.value,A);let te=A.substring(2,13),oe=xe(te).value+1,se=String(oe);u.processNumber=U.value.concat(se),console.log(u.processNumber),C.value=u.folio,P.value=C.value.substring(1,2),console.log(P.value),c(u),setTimeout(()=>{F.value=!1},2e3)},K=async()=>{c(u)},R=l(),Q=l([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),X=()=>{o.push("/roofsystem")};function ee(f,y){f=u,y=R.value,f.length!==0&&(n.addSystem(f,y,P.value),M.value=!0,console.log(f,y,P.value,"System added"))}const H=()=>{const f=document.getElementById("permitapp");console.log(f),we(f).then(x=>{const w=x.toDataURL("image/png"),v=new Se;v.addImage(w,"PNG",10,10,190,0);const A=v.output("blob");y(A)});const y=async x=>{try{const v=await(await window.showSaveFilePicker({suggestedName:`${u.processNumber}-permitapp.pdf`,types:[{description:"PDF file",accept:{"application/pdf":[".pdf"]}}]})).createWritable();await v.write(x),await v.close(),t.value="saved Pdf",console.log("PDF saved successfully without popping download dialog!")}catch(w){console.error("Error saving file:",w)}}};return z(async()=>{await Ve(M).changed(),H()}),ge(()=>{}),{isDialog:i,pdfcleared:M,generatePdf:H,onSubmit:K,accountUsers:r,getUser:m,email:E,dba:L,invoke:z,phone:D,contractor:T,licenseStatus:B,addUser:I,navigateNext:X,addItemAndClear:ee,selectedApplication:R,type:Q,resNum:W,...fe(u),responseMessage:t,lastNum:V,useLast:k,load:Y,checkMB:P,checkV:C,content:s,canvas:g,doc:h}}},p=t=>(J("data-v-722e88f0"),t=t(),Z(),t),qe={id:"permitapp",ref:"permitapp",class:"flex flex-col md:flex-row gap-2",style:{"margin-left":"220px"}},ze={class:"md:w-1/2"},Oe={class:"container"},Ge={class:"row"},Je={class:"card flex flex-col gap-1"},Ze=p(()=>e("div",{class:"font-semibold text-xl"},"Permit Application",-1)),$e={class:"card flex justify-center"},We={class:"card flex flex-col gap-2"},Ye={class:"flex flex-wrap gap-2"},Ke={class:"flex flex-col grow basis-0 gap-2"},Qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Xe=p(()=>e("label",{for:"license"},"License Status",-1)),et=p(()=>e("label",{for:"addr"},"Property Address",-1)),tt={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},ot={class:"flex flex-col mt-3 grow basis-0 gap-3"},st=p(()=>e("label",{for:"dba"},"DBA ",-1)),at={class:"flex flex-col mt-3 grow basis-0 gap-3"},lt=p(()=>e("label",{for:"contractor"},"Contractor Name",-1)),nt={class:"flex flex-col mt-3 grow basis-0 gap-3"},rt=p(()=>e("label",{for:"phone"},"Cell Phone Number",-1)),it={class:"flex flex-col mt-3 grow basis-0 gap-3"},ct=p(()=>e("label",{for:"Email"},"Email",-1)),dt={class:"flex flex-col mt-3 grow basis-0 gap-3"},pt=p(()=>e("label",{for:"muni"},"Municipality",-1)),ut={class:"flex flex-col mt-3 grow basis-0 gap-3"},mt=p(()=>e("label",{for:"folio"},"Folio",-1)),gt={class:"flex flex-col mt-3 grow basis-0 gap-3"},ft=p(()=>e("label",{for:"permit"},"Master Permit",-1)),vt={class:"flex flex-col mt-3 grow basis-0 gap-3"},ht=p(()=>e("label",{for:"processnum"},"mEProcess Number",-1)),bt=p(()=>e("br",null,null,-1)),_t={key:0};function yt(t,o,i,s,g,h){const b=Be,c=re,r=ne,m=O,I=ae,U=le;return S(),N("div",qe,[s.isDialog?(S(),j(b,{key:0})):q("",!0),e("div",ze,[e("div",Oe,[e("form",null,[e("div",Ge,[e("div",Je,[Ze,e("div",$e,[d(c,{modelValue:s.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=n=>s.selectedApplication=n),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),e("div",We,[e("div",Ye,[e("form",{class:"w-3/4",onSubmit:o[12]||(o[12]=(...n)=>s.onSubmit&&s.onSubmit(...n))},[e("div",Ke,[e("div",Qe,[Xe,d(r,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":o[1]||(o[1]=n=>s.licenseStatus=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),et,d(r,{id:"addr",type:"text",modelValue:t.address,"onUpdate:modelValue":o[2]||(o[2]=n=>t.address=n),placeholder:"address"},null,8,["modelValue"]),t.loading?(S(),N("i",tt)):(S(),j(m,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:t.loading,onClick:s.load,onInput:t.createHtml},null,8,["loading","onClick","onInput"]))]),e("div",ot,[st,d(r,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":o[3]||(o[3]=n=>s.dba=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),e("div",at,[lt,d(r,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":o[4]||(o[4]=n=>s.contractor=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),e("div",nt,[rt,d(I,{modelValue:s.phone,"onUpdate:modelValue":o[5]||(o[5]=n=>s.phone=n),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),e("div",it,[ct,d(r,{modelValue:s.email,"onUpdate:modelValue":o[6]||(o[6]=n=>s.email=n),invalid:s.email===null},null,8,["modelValue","invalid"])]),e("div",dt,[pt,d(r,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":o[7]||(o[7]=n=>t.muni=n),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),e("div",ut,[mt,d(r,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":o[8]||(o[8]=n=>t.folio=n),type:"text",placeholder:"folio",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),e("div",gt,[ft,d(r,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":o[9]||(o[9]=n=>t.permit=n),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),e("div",vt,[ht,d(r,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":o[10]||(o[10]=n=>t.processNumber=n),type:"text",placeholder:"process number"},null,8,["modelValue"])]),bt,d(U,{class:"w-1/3"}),s.responseMessage?(S(),N("p",_t,ve(s.responseMessage),1)):q("",!0),d(m,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:o[11]||(o[11]=n=>s.addItemAndClear(t.formData,s.selectedApplication)),onChange:s.generatePdf},null,8,["onChange"])],32)])])])])])])])],512)}const Bt=G(je,[["render",yt],["__scopeId","data-v-722e88f0"]]);export{Bt as default};
