import{s as F}from"./index-5gbuzbZ3.js";import{e,N as M,u as q,f as D,ao as G,ab as N,ap as S,at as I,o as b,c as x,h as B,g as n,R as Y,aq as j,t as C,d as A,au as H}from"./index-QbUgqYWy.js";import{u as J,a as K}from"./use-downloadpdf-Dh1JdcCh.js";import{c as Q,u as W}from"./pdfsignStore-CEOjFNxH.js";import{u as X}from"./permitapp-ClzWboSY.js";import"./index-CCC29tbC.js";import"./useAxios-Bia_MOOa.js";const Z={class:"card"},oo={class:"flex flex-col w-1/3 gap-2 shadow-lg shadow-cyan-800",style:{"margin-left":"550px","margin-top":"440px"}},eo={class:"payment-widget"},to=n("h2",{style:{color:"black"}},"Download Link",-1),so={key:0,class:"confirmation"},po={__name:"DownloadLink",setup(ao){var w,h;const V=X(),c=Q(),i=e(0),u=e(((h=(w=V.$state.permitapp[0])==null?void 0:w.formdt)==null?void 0:h.muniProc)||""),{secondFetch:L}=J(u.value),O=e(!1),l=e(!1),P=e(!1),R=e(!1),d=e(!1);e(null);const r=K();M(r.$state);const{resp:m}=W(),T=q();D(()=>{var o,t;i.value=1,c.addCount(i),console.log(c),((t=(o=m.value)==null?void 0:o.status)==null?void 0:t.status)===200&&(P.value=!0,console.log(m.value.status.status))});const p=e("");D(async()=>{const o=new URLSearchParams(location.search).get("session_id");if(p.value=o,o)console.log(p.value);else{console.log(o);return}});const f=G("my-storage",{processNumber:u.value}),U=N(()=>{l.value=!0});S(U,()=>{});const v=N(()=>{setTimeout(()=>{R.value=!0},1e3),L(f.value.processNumber),z()}),$=()=>{T.push("/")},z=async()=>{var _,g,y,k;const o=(g=(_=r.downloadinput[0])==null?void 0:_.downloadData)==null?void 0:g.download_url;if(console.log(o),!o||o.length===0)return;console.log(o,f.value);const t=(k=(y=r.downloadinput[0])==null?void 0:y.downloadData)==null?void 0:k.download_url;if(!t)return;O.value=!0;const s=t,E="processnumber.zip",a=document.createElement("a");a.href=s,a.download=E,a.click(),a.remove(),l.value=!0,d.value=!0};return S(v,startDownload,()=>{}),I(async()=>{await H(v).toBe(!0)}),(o,t)=>{const s=F;return b(),x("div",Z,[B(s,{icon:"pi pi-home",severity:"info",style:{"font-size":"2rem"},onClick:$}),n("div",oo,[n("div",eo,[to,Y(B(s,{icon:"pi pi-arrow-circle-down",severity:"info","aria-label":"User",onClick:o.startDownload},null,8,["onClick"]),[[j,l.value]])]),d.value?(b(),x("div",so,[n("p",null,"Thank you, "+C(o.Name)+"! Your payment of $"+C(107)+" was processed.",1)])):A("",!0)])])}}};export{po as default};
