import{s as j}from"./index-CRN4wDlg.js";import{u as T}from"./useAxios-DjJqJdY8.js";import{i as s,j as w,e as q,u as A,w as B,k as G,o as _,c as k,f as g,g as N,l as x,p as u,a as S,d as b,t as D,q as y}from"./index-ica-XrX1.js";import{u as E}from"./accountsStore-Q1bUw0wQ.js";import{u as O}from"./auth-DDJz5-gW.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BlSj7jYj.js";function V(){const n=s(null),a=s(null);let c=null;const r=s([]);let i=w({});q(()=>{c=google.accounts.oauth2.initTokenClient({client_id:"978320609817-r83rgg9qsb4ntam9dek995cqcn779qut.apps.googleusercontent.com",scope:["openid","email","profile","https://www.googleapis.com/auth/gmail.readonly"].join(" "),callback:e=>{if(e.error)return console.error(e);n.value=e.access_token;const l=e.id_token;l&&(a.value=JSON.parse(atob(l.split(".")[1])))}})});const d=()=>c.requestAccessToken({prompt:"consent"},m()),h=()=>{n.value&&google.accounts.oauth2.revoke(n.value,()=>{n.value=null,a.value=null})};async function m(){let e="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/getaccounts";const{execute:l,then:f,data:p}=T(e,{method:"GET"},{immediate:!1});let o=s([]);o.value=l().then(v=>{i=p.value,console.log(i);for(const[t,C]of Object.entries(i))r.value.push(C);console.log(r.value)})}return{accessToken:n,idPayload:a,signIn:d,signOut:h,localData:r}}const I={class:"relative w-full h-screen overflow-hidden"},z={class:"relative z-10 flex items-center justify-center h-full bg-black/50"},P={style:{"border-radius":"20px",padding:"0.5rem"}},R={class:"container w-full py-15 px-8 sm:px-2"},J={key:0},M={__name:"authGoogle",setup(n){const{accessToken:a,idPayload:c,signIn:r,signOut:i,localData:d}=V();s(!1);const h=A();s(!1);const m=s([]);O();let e=w({dba:"",email:"",cphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:""});const{addUser:l}=E(),f=()=>{console.log(d.value),d.value.forEach((o,v)=>{for(let t=0;t<o.length;t++)a.value&&(console.log(a),m.value.push(o[t]),console.log(o[t]),e.email=o[t].email,e.name=o[t].name,console.log(e.name),e.dba=o[t].dba,e.cphone=o[t].bphone,e.expiration_date=o[t].expiration_date,e.projects=o[t].projects,e.secondary_status=o[t].secondary_status,e.email=o[t].email,e.license=o[t].license,l(e),p());console.log("UserData",e)})},p=()=>{h.push("/permitapp")};return B(f,()=>{}),G(()=>{a.value&&fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=10",{headers:{Authorization:`Bearer ${a.value}`}}).then(o=>o.json()).then(console.log)}),(o,v)=>{const t=j;return _(),k("div",I,[g("div",z,[g("div",P,[g("div",R,[g("div",null,[N(t,{onClick:u(r),onChange:f,severity:"constrast",raised:"",onUpdate:p},{default:x(()=>[y("Sign in with Google")]),_:1},8,["onClick"]),u(a)?(_(),S(t,{key:0,onClick:u(i)},{default:x(()=>[y("SignÂ out")]),_:1},8,["onClick"])):b("",!0)])]),u(c)?(_(),k("pre",J,D(u(c)),1)):b("",!0)])])])}}},X=U(M,[["__scopeId","data-v-6850e69b"]]);export{X as default};
