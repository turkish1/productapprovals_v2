import{_ as D,a as N,r,o as v,c as h,d as s,m as P,F,O as L,k as S,l as k,g as R,u as E,t as $,b as p,L as B,p as q,f as z}from"./index-BQAun09o.js";import{s as O}from"./index-CVRdK6_G.js";import{s as W}from"./index-DrLIm6gS.js";import{s as j}from"./index-BdruNpiC.js";import{s as T}from"./index-B_aQsM_k.js";import{D as Y}from"./DataService-fgVVu_xo.js";import{u as G}from"./useAxios-CQEnd6ho.js";import{u as Z}from"./permitapp-D2DlEW15.js";import"./index-DBO_D23I.js";import"./index-DzRX9k_6.js";import"./axios-DTyqpfTh.js";const H={class:"bg-clip-content p-6 bg-gray w-2/3 border-4 border-midnight border-dashed"},J={key:0},K={class:"file-previews"},Q=["src"],X={__name:"DropZone",setup(o){const e=N([]),c=r(null),l=()=>{},f=()=>{},i=n=>{const d=n.dataTransfer.files;a(d)},g=n=>{const d=n.target.files;a(d)},a=n=>{Array.from(n).forEach(d=>{const t=new FileReader;t.onload=b=>{d.preview=b.target.result,e.push(d)},u(d)?t.readAsDataURL(d):e.push(d)})},u=n=>n.type.startsWith("image/");return(n,d)=>(v(),h("div",H,[s("div",{class:"file-drop-zone",onDragover:S(l,["prevent"]),onDrop:S(i,["prevent"]),onDragleave:S(f,["prevent"])},[e.length?P("",!0):(v(),h("p",J,"Drag and drop files here, or click to select files")),s("input",{type:"file",multiple:"",onChange:g,ref_key:"fileInput",ref:c,style:{display:"none"}},null,544),s("div",K,[(v(!0),h(F,null,L(e,(t,b)=>(v(),h("div",{key:b,class:"file-preview"},[u(t)?(v(),h("img",{key:0,src:t.preview,alt:"File preview"},null,8,Q)):P("",!0),s("p",null,k(t.name),1)]))),128))])],32)]))}},ee=D(X,[["__scopeId","data-v-987cb64c"]]);function w(){const o=r(null),e=r(0);return Y.getLastProcess().then(c=>{o.value=c.data,o.value.forEach(l=>{console.log(l.processNumber),e.value=l.processNumber,console.log(e.value,l.processNumber)})}).catch(c=>{console.error("Error:",c)}),{resNum:o,lastNum:e}}function oe(){const{resNum:o,lastNum:e}=w(),c=r(""),l=r(new Date().getFullYear()),f=r(6),i=r("me"),g=Array.from({length:10**f.value},(u,n)=>`${i.value}${l.value}${String(n).padStart(f.value,"0")}`),a=w();return console.log(a),c.value=g[0]+1,e.value!==0?console.log("entered lastNum equal null",e.value):(console.log("entered lastNum equal a number",e.value),c.value=e.value+1),console.log(c.value,e.value,a),{pNum:c,lastNum:e,resNum:o,test:a}}const se=R("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(o){this.processinput.push({procData:o,completed:!1})}}});function te(){const o=r("");let e=r([]);const c=se(),l=r("");let f="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:i,data:g}=G(f,{method:"POST"},{immediate:!1});let a=N({});function u(n){console.log(n),a=n,i({data:n}),o.value="Form submitted successfully!",c.addData(a),console.log(a,"System added")}return{error:l,results:e,procReceive:u,responseMessage:o,procData:a,procStore:c}}const le={setup(){const o=r(""),e=E(),{procData:c,procReceive:l}=te();r();const f=Z(),i=N({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),g=r(!1);oe();const{lastNum:a,resNum:u}=w(),n=r(""),d=r(""),t=async()=>{const _=r(i.address),M=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(_.value)}&to=200`,C=await fetch(M);g.value=!0;const V=await C.json();console.log(V),i.muni=V.MinimumPropertyInfos[0].Municipality,i.folio=V.MinimumPropertyInfos[0].Strap,i.processNumber=a.value+1,console.log(i.processNumber),d.value=i.folio,n.value=d.value.substring(0,2),console.log(n.value),l(i),setTimeout(()=>{g.value=!1},2e3)},b=async()=>{l(i)},x=r(),A=r([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),I=()=>{e.push("/generalpage")};function U(_,y){_=i,y=x.value,_.length!==0&&(f.addSystem(_,y),console.log(_,y,"System added"))}return{onSubmit:b,navigateNext:I,addItemAndClear:U,selectedApplication:x,type:A,resNum:u,...$(i),responseMessage:o,lastNum:a,useLast:w,load:t,checkMB:n,checkV:d}}},m=o=>(q("data-v-d1ccb34c"),o=o(),z(),o),ae={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},ne={class:"md:w-2/3"},re={class:"container"},ie={class:"row"},de={class:"card flex flex-col gap-2"},ce=m(()=>s("div",{class:"font-semibold text-xl"},"Permit Application",-1)),pe={class:"card flex justify-center"},ue={class:"card flex flex-col gap-4"},me={class:"flex flex-wrap gap-4"},fe={class:"flex flex-col grow basis-0 gap-3"},ge=m(()=>s("label",{for:"addr"},"Property Address",-1)),ve={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},he={class:"flex flex-col grow basis-0 gap-3"},_e=m(()=>s("label",{for:"contractor"},"Contractor Name",-1)),be={class:"flex flex-col grow basis-0 gap-3"},ye=m(()=>s("label",{for:"phone"},"Cell Phone Number",-1)),we={class:"flex flex-col grow basis-0 gap-3"},Ve=m(()=>s("label",{for:"Email"},"Email",-1)),Se={class:"flex flex-col grow basis-0 gap-3"},Pe=m(()=>s("label",{for:"muni"},"Municipality",-1)),Ne={class:"flex flex-col grow basis-0 gap-3"},xe=m(()=>s("label",{for:"folio"},"Folio",-1)),De={class:"flex flex-col grow basis-0 gap-3"},ke=m(()=>s("label",{for:"permit"},"Master Permit",-1)),Ae={class:"flex flex-col grow basis-0 gap-3"},Ie=m(()=>s("label",{for:"processnum"},"mEProcess Number",-1)),Ue=m(()=>s("br",null,null,-1)),Me={key:0};function Ce(o,e,c,l,f,i){const g=T,a=j,u=W,n=O,d=ee;return v(),h("div",ae,[s("div",ne,[s("div",re,[s("form",null,[s("div",ie,[s("div",de,[ce,s("div",pe,[p(g,{modelValue:l.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=t=>l.selectedApplication=t),options:l.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),s("div",ue,[s("div",me,[s("form",{class:"w-3/4",onSubmit:e[10]||(e[10]=(...t)=>l.onSubmit&&l.onSubmit(...t))},[s("div",fe,[ge,p(a,{id:"addr",type:"text",modelValue:o.address,"onUpdate:modelValue":e[1]||(e[1]=t=>o.address=t),placeholder:"address"},null,8,["modelValue"]),o.loading?(v(),h("i",ve)):(v(),B(u,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:o.loading,onClick:l.load},null,8,["loading","onClick"]))]),s("div",he,[_e,p(a,{id:"zip",modelValue:o.contractor,"onUpdate:modelValue":e[2]||(e[2]=t=>o.contractor=t),type:"text",placeholder:"name"},null,8,["modelValue"])]),s("div",be,[ye,p(n,{modelValue:o.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>o.phone=t),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:o.phone===""},null,8,["modelValue","invalid"])]),s("div",we,[Ve,p(a,{modelValue:o.email,"onUpdate:modelValue":e[4]||(e[4]=t=>o.email=t),invalid:o.email===null},null,8,["modelValue","invalid"])]),s("div",Se,[Pe,p(a,{id:"muni",modelValue:o.muni,"onUpdate:modelValue":e[5]||(e[5]=t=>o.muni=t),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),s("div",Ne,[xe,p(a,{id:"folio",modelValue:o.folio,"onUpdate:modelValue":e[6]||(e[6]=t=>o.folio=t),type:"text",placeholder:"folio",onInput:o.updatemEProcess},null,8,["modelValue","onInput"])]),s("div",De,[ke,p(a,{id:"permit",modelValue:o.permit,"onUpdate:modelValue":e[7]||(e[7]=t=>o.permit=t),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),s("div",Ae,[Ie,p(a,{id:"processnum",modelValue:o.processNumber,"onUpdate:modelValue":e[8]||(e[8]=t=>o.processNumber=t),type:"text",placeholder:"process number"},null,8,["modelValue"])]),Ue,p(u,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:e[9]||(e[9]=t=>l.addItemAndClear(o.formData,l.selectedApplication))})],32),l.responseMessage?(v(),h("p",Me,k(l.responseMessage),1)):P("",!0)])])])])]),p(d)])])])}const Te=D(le,[["render",Ce],["__scopeId","data-v-d1ccb34c"]]);export{Te as default};
