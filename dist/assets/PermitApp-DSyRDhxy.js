import{_ as K}from"./FileSaver-CMI4UaOI.js";import{s as Q}from"./index-C8rkyeXw.js";import{s as X}from"./index-DXPD8igS.js";import{s as $}from"./index-Dj1ucbh5.js";import{s as ee}from"./index-D_twOyPU.js";import{a as te,u as oe}from"./useAxios-DqYRT6Vn.js";import{r as n,q as se,a as z,_ as ae,u as le,w as ne,n as re,o as V,c as I,e as a,d,P as ie,t as de,m as ce,p as ue,i as pe}from"./index-9HgsAIbW.js";import{u as me}from"./accountsStore-C4iOYOBE.js";import{u as ge}from"./permitapp-Cq-0WzpY.js";import{h as fe,E as ve}from"./jspdf.es.min-NQO7DGFh.js";import{a as be,i as R,b as he,u as ye}from"./index-HC8aj9TL.js";import"./index-Cfjsl5Ao.js";import"./index-Bi8cyYpb.js";import"./index-aQ24GIk8.js";const o=te.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),_e={getAddr(){return o.get("/folio")},postProcessnumber(t){return o.post("/process",t)},getLastProcess(){return o.get("/lastnumber")},getSlopeless(){return o.get("/slopeless")},getSlopemore(){return o.get("/slopemore")},getdeOne(){return o.get("/desupone")},getdeTwo(){return o.get("/desuptwo")},getdeThree(){return o.get("/desupthree")},getdeFour(){return o.get("/desupfour")},getZones23(){return o.get("/gableroofs23")},getNoa(){return o.get("/noa")},getSBS(){return o.get("/shinglesbs")},getSystemE(){return o.get("/systemtype")},getburMaterial(){return o.get("/burmaterial")},getnewburMaterial(){return o.get("/burmaterials")},getburSystem(){return o.get("/bursystem")},getPoly(){return o.get("/shinglepoly")},getSystemF(){return o.get("/systemtypef")},getdeGauge(){return o.get("/degauge")},getdeMaterial(){return o.get("/dematerial")},getdeMatMore(){return o.get("/dematerials")},getdeSize(){return o.get("/desize")},getdeFastener(){return o.get("/defastener")},getprimeBase(){return o.get("/primebase")},getPerimeter(){return o.get("/perimeter")},getNoas(){return o.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return o.get("/tilenoa")},getZones(){return o.get("/gablezones")},getLay(){return o.get("/underlaymentshingle")},getContractors(){return o.get("/contractors")},postAccount(t){return o.post("/accounts",t)},getAccount(){return o.get("/retriveaccounts")},getDripMaterials(){return o.get("/dripmaterials")}};function N(){const t=n(null),e=n(0);return _e.getLastProcess().then(i=>{t.value=i.data,t.value.forEach(s=>{console.log(s.processNumber),e.value=s.processNumber})}).catch(i=>{console.error("Error:",i)}),{resNum:t,lastNum:e}}function we(){const{resNum:t,lastNum:e}=N(),i=n(""),s=n(new Date().getFullYear()),f=n(6),_=n("me"),v=Array.from({length:10**f.value},(b,p)=>`${_.value}${s.value}${String(p).padStart(f.value,"0")}`),l=N();return console.log(l),i.value=v[0]+1,e.value!==0||(i.value=e.value+1),{pNum:i,lastNum:e,resNum:t,test:l}}const Se=se("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(t){this.processinput.push({procData:t,completed:!1})}}});function Pe(){const t=n("");let e=n([]);const i=Se(),s=n("");let f="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:_,data:v}=oe(f,{method:"POST"},{immediate:!1});let l=z({});function b(p){console.log(p),l=p,_({data:p}),t.value="Form submitted successfully!",i.addData(l),console.log(l,"System added")}return{error:s,results:e,procReceive:b,responseMessage:t,procData:l,procStore:i}}n(1);const xe={setup(){const t=n(""),e=le(),i=n(),s=n(),f=n(),{procData:_,procReceive:v}=Pe(),{accountUsers:l,getUser:b,addUser:p}=me();console.log(l._value[0]);const A=n("me"),r=ge(),u=z({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),D=n(""),k=n(""),U=n(""),E=n(""),L=n("");be(()=>{if(l._value[0].name==="")return e.push("/");D.value=l._value[0].name,k.value=l._value[0].email,U.value=l._value[0].phone,E.value=l._value[0].secondary_status,L.value=l._value[0].dba,console.log(l._value[0].phone)});const M=n(!1),B=n(!1);we();const{lastNum:P,resNum:O}=N();U.value=l._value[0].phone,n(null);const w=n(""),C=n(""),H=async()=>{const m=n(u.address),S=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(m.value)}&to=200`,y=await fetch(S);B.value=!0;const g=await y.json();console.log(g),u.muni=g.MinimumPropertyInfos[0].Municipality,u.folio=g.MinimumPropertyInfos[0].Strap;let x=String(P.value);console.log(P.value.length,P.value,x);let W=x.substring(2,13),Y=he(W).value+1,J=String(Y);u.processNumber=A.value.concat(J),console.log(u.processNumber),C.value=u.folio,w.value=C.value.substring(0,2),console.log(w.value),v(u),setTimeout(()=>{B.value=!1},2e3)},j=async()=>{v(u)},T=n(),q=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),G=()=>{e.push("/roofsystem")};function Z(m,h){m=u,h=T.value,m.length!==0&&(r.addSystem(m,h,w.value),M.value=!0,console.log(m,h,w.value,"System added"))}const F=()=>{const m=document.getElementById("permitapp");console.log(m),fe(m).then(S=>{const y=S.toDataURL("image/png"),g=new ve;g.addImage(y,"PNG",10,10,190,0);const x=g.output("blob");h(x)});const h=async S=>{try{const g=await(await window.showSaveFilePicker({suggestedName:`${u.processNumber}-permitapp.pdf`,types:[{description:"PDF file",accept:{"application/pdf":[".pdf"]}}]})).createWritable();await g.write(S),await g.close(),t.value="saved Pdf",console.log("PDF saved successfully without popping download dialog!")}catch(y){console.error("Error saving file:",y)}}};return R(async()=>{await ye(M).changed(),F()}),ne(()=>{}),{pdfcleared:M,generatePdf:F,onSubmit:j,accountUsers:l,getUser:b,email:k,dba:L,invoke:R,phone:U,contractor:D,licenseStatus:E,addUser:p,navigateNext:G,addItemAndClear:Z,selectedApplication:T,type:q,resNum:O,...re(u),responseMessage:t,lastNum:P,useLast:N,load:H,checkMB:w,checkV:C,content:i,canvas:s,doc:f}}},c=t=>(ue("data-v-d1212527"),t=t(),pe(),t),Ve={id:"permitapp",ref:"permitapp",class:"flex flex-col md:flex-row gap-2",style:{"margin-left":"220px"}},Ne={class:"md:w-1/2"},Ae={class:"container"},Ue={class:"row"},Me={class:"card flex flex-col gap-1"},Ce=c(()=>a("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Ie={class:"card flex justify-center"},De={class:"card flex flex-col gap-2"},ke={class:"flex flex-wrap gap-2"},Ee={class:"flex flex-col grow basis-0 gap-2"},Le={class:"flex flex-col mt-3 grow basis-0 gap-3"},Be=c(()=>a("label",{for:"license"},"License Status",-1)),Te=c(()=>a("label",{for:"addr"},"Property Address",-1)),Fe={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Re={class:"flex flex-col mt-3 grow basis-0 gap-3"},ze=c(()=>a("label",{for:"dba"},"DBA ",-1)),Oe={class:"flex flex-col mt-3 grow basis-0 gap-3"},He=c(()=>a("label",{for:"contractor"},"Contractor Name",-1)),je={class:"flex flex-col mt-3 grow basis-0 gap-3"},qe=c(()=>a("label",{for:"phone"},"Cell Phone Number",-1)),Ge={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ze=c(()=>a("label",{for:"Email"},"Email",-1)),We={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ye=c(()=>a("label",{for:"muni"},"Municipality",-1)),Je={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ke=c(()=>a("label",{for:"folio"},"Folio",-1)),Qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Xe=c(()=>a("label",{for:"permit"},"Master Permit",-1)),$e={class:"flex flex-col mt-3 grow basis-0 gap-3"},et=c(()=>a("label",{for:"processnum"},"mEProcess Number",-1)),tt=c(()=>a("br",null,null,-1)),ot={key:0};function st(t,e,i,s,f,_){const v=ee,l=$,b=X,p=Q,A=K;return V(),I("div",Ve,[a("div",Ne,[a("div",Ae,[a("form",null,[a("div",Ue,[a("div",Me,[Ce,a("div",Ie,[d(v,{modelValue:s.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=r=>s.selectedApplication=r),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),a("div",De,[a("div",ke,[a("form",{class:"w-3/4",onSubmit:e[12]||(e[12]=(...r)=>s.onSubmit&&s.onSubmit(...r))},[a("div",Ee,[a("div",Le,[Be,d(l,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":e[1]||(e[1]=r=>s.licenseStatus=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),Te,d(l,{id:"addr",type:"text",modelValue:t.address,"onUpdate:modelValue":e[2]||(e[2]=r=>t.address=r),placeholder:"address"},null,8,["modelValue"]),t.loading?(V(),I("i",Fe)):(V(),ie(b,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:t.loading,onClick:s.load,onInput:t.createHtml},null,8,["loading","onClick","onInput"]))]),a("div",Re,[ze,d(l,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":e[3]||(e[3]=r=>s.dba=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Oe,[He,d(l,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":e[4]||(e[4]=r=>s.contractor=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",je,[qe,d(p,{modelValue:s.phone,"onUpdate:modelValue":e[5]||(e[5]=r=>s.phone=r),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),a("div",Ge,[Ze,d(l,{modelValue:s.email,"onUpdate:modelValue":e[6]||(e[6]=r=>s.email=r),invalid:s.email===null},null,8,["modelValue","invalid"])]),a("div",We,[Ye,d(l,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[7]||(e[7]=r=>t.muni=r),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),a("div",Je,[Ke,d(l,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[8]||(e[8]=r=>t.folio=r),type:"text",placeholder:"folio",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",Qe,[Xe,d(l,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[9]||(e[9]=r=>t.permit=r),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),a("div",$e,[et,d(l,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[10]||(e[10]=r=>t.processNumber=r),type:"text",placeholder:"process number"},null,8,["modelValue"])]),tt,d(A,{class:"w-1/2"}),s.responseMessage?(V(),I("p",ot,de(s.responseMessage),1)):ce("",!0),d(b,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:e[11]||(e[11]=r=>s.addItemAndClear(t.formData,s.selectedApplication)),onChange:s.generatePdf},null,8,["onChange"])],32)])])])])])])])],512)}const yt=ae(xe,[["render",st],["__scopeId","data-v-d1212527"]]);export{yt as default};
