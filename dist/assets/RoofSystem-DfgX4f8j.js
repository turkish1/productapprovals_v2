import{_ as W}from"./FileSaver-D0f3EHSZ.js";import{e as p,o as r,c as u,i as e,t as g,d as P,H as B,f as V,D as X,g as K,F as N,x as U,n as H,J as O,k as x,I as z,Y as Z,v as ee,K as te,a as se,S as q,j as S,T as oe,p as ae,q as le,A as ne}from"./index-CWzlT8KI.js";import{s as J}from"./index-gVK6sTsK.js";import{u as ie}from"./usePostGeneralpageLambda-B_q_RDC4.js";import{u as re}from"./generalpageStore-Dmr_YXxZ.js";import{u as Q}from"./permitapp-C8ihXFl-.js";import{u as G}from"./roofList-yS8qgNz5.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as Y}from"./index-Chyd7jU0.js";import{s as ce}from"./index-tPH7CL2_.js";import{s as de}from"./index-DiS0keNX.js";import{s as pe}from"./index-NVVYH26o.js";import"./useAxios-CDNBhiSD.js";import"./index-D7NEm49e.js";import"./index-B8liBVYt.js";import"./index-DiWiyEDC.js";import"./index-MP3cGonx.js";import"./index-Dd2ylSL2.js";const ue={class:"modal-wrapper shadow-xl p-6"},me={class:"clear-pane border-2 border-dashed p-10 text-center mb-4"},fe=e("h1",{class:"text-xl font-bold mb-4"},"Permit Application Verification",-1),he={key:0,class:"text-sm mb-4"},_e=["disabled"],ve={key:0,class:"mt-8 space-y-4 overflow-y-auto max-h-40"},ge={class:"p-4 border-l-4 border-green-500 bg-green-50"},ye={class:"font-bold"},ke={__name:"MCPFileUpload",setup(y){const _=p(!1),k=p(null),l=p(null);async function m(s){const a=new FileReader;a.onload=async t=>{const h=t.target.result.split(",")[1];try{const n=await fetch(LAMBDA_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({document:h})}),C=await n.json();n.ok?console.log("Textract results:",C.blocks):console.error("Lambda Error:",C.error)}catch(n){console.error("Network Error:",n)}},a.readAsDataURL(s)}const c=s=>{const a=s.target.files[0];a&&(l.value=a)},f=async()=>{if(!l.value)return;_.value=!0;let s;try{if(l.value.type==="application/pdf"?s=await convertPdfToImage(l.value):s=await new Promise(a=>{const t=new FileReader;t.onload=()=>a(t.result.split(",")[1]),t.readAsDataURL(l.value)}),console.log("Payload length:",s==null?void 0:s.length),!s)throw new Error("Conversion resulted in empty payload");await m(s)}catch(a){console.error(a)}finally{_.value=!1}};return(s,a)=>{var t;return r(),u("div",ue,[e("div",me,[fe,e("input",{type:"file",onChange:c,accept:".pdf,.jpg,.jpeg,.png",class:"mb-4"},null,32),l.value?(r(),u("p",he,"Selected: "+g(l.value.name),1)):P("",!0),e("button",{onClick:f,class:"bg-blue-600 text-white px-6 py-2 rounded shadow-md disabled:bg-gray-400",disabled:_.value||!l.value},g(_.value?"Processing...":"Verify Application"),9,_e)]),k.value?(r(),u("div",ve,[e("div",ge,[e("h3",ye,"LICENSE: "+g(k.value.license_found||"NOT DETECTED"),1),e("p",null,"Status: "+g(((t=k.value.contractor_info)==null?void 0:t.status)||"Unknown"),1),e("p",null,"Signatures: "+g(k.value.signatures_detected?"✅ Found":"❌ Missing"),1)])])):P("",!0)])}}};function Se(){var A,M,F;const y=G(),{roofList:_}=B(y),k=Q(),l=p((F=(M=(A=k.$state.permitapp)==null?void 0:A[0])==null?void 0:M.formdt)==null?void 0:F.processNumber);p(!1);const m=re(),{postGeneral:c}=ie(),f=p(null),s=p(m.$state.generalpdfinput),a=p(!1),t=V({checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1}),i=V({steep1:0,steep2:0,steep3:0,steep4:0,low1:0}),h=V({steep:0,lowslope:0,total:0}),n=V({steepData:"",slopeData:"",totalData:"",checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1,roofCheck:"",area:"",processnumber:""});function C(E){f.value=E.value,console.log(f.value);const I={"Asphalt Shingle":{dim:"dim1",flag:"checkedshingle",steepKey:"steep1"},"Adhesive Set Tile":{dim:"dim4",flag:"checkedadtile",steepKey:"steep2"},"Mechanical Fastened Tile":{dim:"dim3",flag:"checkedmtile",steepKey:"steep3"},"Metal Panel":{dim:"dim5",flag:"checkedmetal",steepKey:"steep4"},"Low Slope":{dim:"dim2",flag:"checkedslp"}};console.log(t,i),Object.keys(t).forEach(b=>t[b]=!1),Object.keys(i).forEach(b=>i[b]=0),_.value.forEach(b=>{console.log(b,I[b.item]);const w=I[b.item];if(w){console.log(w);const L=Number(b[w.dim])||0;t[w.flag]=!0,n[`${w.flag}`]=!0,console.log(w.flag,n),w.flag==="slope"?i.low1=L:i[w.steepKey]=L}}),R()}async function R(){h.steep=i.steep1+i.steep2+i.steep3+i.steep4,h.lowslope=i.low1,h.total=h.steep+h.lowslope,n.area=h.total,n.steepData=h.steep,n.slopeData=h.lowslope,n.totalData=h.total,n.roofCheck=f.value,n.processnumber=l.value,m.addgeneralpdfData(n),await c(n),a.value=!0}return{addRoof:C,roofArea:R,dataGeneral:n,generalType:s,isGeneralPageValid:a}}const be=X("roofinput",{state:()=>({roofinput:[],id:0}),actions:{addCheck(y){this.roofinput.push({roofCheckdata:y,completed:!1})},reset(){this.roofinput=[]},persist:!0}}),we={class:"terminal"},xe={class:"terminal-content"},$e={class:"content"},Ce=["onClick"],Re=20,Te={__name:"RoofSystemList",setup(y){const _=G(),{roofList:k}=B(_),{toggleCompleted:l}=B(_),m=["Initializing system...","Loading modules...","Connecting to server...","Server connection established.","Awaiting Roof System Selection..."],c=p([]);function f(){let s=0;const a=setInterval(()=>{s<m.length?(c.value.length>=Re&&c.value.shift(),c.value.push(m[s]),console.log(m[s]),s++):clearInterval(a)},500)}return K(()=>{f()}),(s,a)=>(r(),u("div",we,[e("div",xe,[(r(!0),u(N,null,U(c.value,(t,i)=>(r(),u("div",{key:i,class:"terminal-line"},g(t),1))),128)),(r(!0),u(N,null,U(x(k),t=>(r(),u("div",{key:t.id,class:"item"},[e("div",$e,[e("span",{class:H({completed:t.completed}),style:{color:"green"}},g(t.item)+" "+g(t.dim1)+" "+g(t.dim2)+" "+g(t.dim3)+" "+g(t.dim4)+" "+g(t.dim5),3),e("span",{onClick:O(i=>x(l)(t.id),["stop"])},"✔",8,Ce)])]))),128))])]))}},De=j(Te,[["__scopeId","data-v-0eaf742f"]]),$=y=>(ae("data-v-227b6320"),y=y(),le(),y),Le={class:"page"},Ve={class:"card"},Ae={class:"card__header"},Me=$(()=>e("h2",null,"Roof System",-1)),Fe=$(()=>e("i",{class:"pi pi-refresh"},null,-1)),Ie={class:"form"},Pe={class:"field"},Ee=$(()=>e("label",{for:"sqft"},"Square Footage",-1)),Be={class:"field"},Ne=$(()=>e("label",{for:"system"},"Roof System",-1)),Ue={key:0,class:"hint"},Oe={class:"field row"},Ke={class:"check"},Ge=$(()=>e("label",{for:"kind-new"},"New Roof",-1)),je={class:"check"},ze=$(()=>e("label",{for:"kind-reroof"},"Re-Roof",-1)),qe={class:"actions"},Je={class:"side"},Ye=$(()=>e("p",{class:"dz-title"},"Blueprints & images",-1)),He=$(()=>e("p",{class:"dz-sub"},"Drag & drop files here, or click to select",-1)),Qe={key:0,class:"dz-list"},We={__name:"RoofSystemForm",setup(y){var b,w,L;const _=Q(),k=be(),l=G(),m=p(""),c=p(null),f=p(""),s=p(!1),a=p([]),{addRoof:t}=Se(),i=V({roofCheck:""}),h=[{name:"Asphalt Shingle"},{name:"Low Slope"},{name:"Mechanical Fastened Tile"},{name:"Adhesive Set Tile"},{name:"Metal Panel"}],n=p((L=(w=(b=_.$state.permitapp)==null?void 0:b[0])==null?void 0:w.formdt)==null?void 0:L.checkIfBeach),C=z(()=>Z(n.value).value===2),R=z(()=>C.value?h.slice(1):h);function A(T){var d;if(!T||m.value==0)return;const o=c.value.name,v=Number(m.value),D={"Asphalt Shingle":()=>l.addSystemShingle(o,v),"Low Slope":()=>l.addSystemBur(o,v),"Mechanical Fastened Tile":()=>l.addSystemMTile(o,v),"Adhesive Set Tile":()=>l.addSystemATile(o,v),"Metal Panel":()=>l.addSystemMetal(o,v)};console.log(D),(d=D[o])==null||d.call(D),i.roofCheck=f.value,k.addCheck({...i}),m.value="",c.value=null}function M(){t(f)}function F(){l.$reset()}function E(T){var v;s.value=!1;const o=[...((v=T.dataTransfer)==null?void 0:v.files)||[]];o.length&&(a.value=o)}function I(T){var v;const o=[...((v=T.target)==null?void 0:v.files)||[]];o.length&&(a.value=o)}return K(()=>{!c.value&&R.value.length&&(c.value=R.value[0])}),(T,o)=>{const v=ee("RouterLink"),D=oe;return r(),u("main",Le,[e("section",Ve,[e("header",Ae,[Me,te((r(),se(x(Y),{class:"icon",text:"",plain:"",onClick:F},{default:q(()=>[Fe]),_:1})),[[D,"Reset list",void 0,{bottom:!0}]])]),e("div",Ie,[e("div",Pe,[Ee,S(x(de),{id:"sqft",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=d=>m.value=d),type:"number",inputmode:"numeric",placeholder:"e.g. 1200"},null,8,["modelValue"])]),e("div",Be,[Ne,S(x(pe),{id:"system",class:"w-full",options:R.value,optionLabel:"name",modelValue:c.value,"onUpdate:modelValue":[o[1]||(o[1]=d=>c.value=d),A],placeholder:"Select roof system"},null,8,["options","modelValue"]),C.value?(r(),u("small",Ue,"Miami Beach restrictions apply.")):P("",!0)]),e("div",Oe,[e("div",Ke,[S(x(J),{inputId:"kind-new",name:"roofKind",value:"newroof",modelValue:f.value,"onUpdate:modelValue":o[2]||(o[2]=d=>f.value=d)},null,8,["modelValue"]),Ge]),e("div",je,[S(x(J),{inputId:"kind-reroof",name:"roofKind",value:"reroof",modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=d=>f.value=d)},null,8,["modelValue"]),ze])]),e("div",qe,[S(v,{to:"/dynamicstepper"},{default:q(()=>[S(x(Y),{severity:"contrast",label:"Continue",onClick:M})]),_:1})])]),S(x(ce)),S(De)]),e("section",Je,[e("div",{class:H(["dropzone",{over:s.value}]),onDragover:o[4]||(o[4]=O(d=>s.value=!0,["prevent"])),onDragleave:o[5]||(o[5]=d=>s.value=!1),onDrop:O(E,["prevent"])},[Ye,He,e("input",{type:"file",class:"dz-input",multiple:"",onChange:I},null,32),a.value.length?(r(),u("ul",Qe,[(r(!0),u(N,null,U(a.value,d=>(r(),u("li",{key:d.name},g(d.name),1))),128))])):P("",!0)],34)])])}}},Xe=j(We,[["__scopeId","data-v-227b6320"]]),Ze={id:"id",class:"grid grid-cols-3 gap-6"},et={class:"roof-app",style:{"margin-left":"250px","margin-top":"20px",border:"none","border-radius":"12px","box-shadow":"4px 4px 16px rgb(22, 183, 183)","padding-bottom":"10px",position:"center","max-height":"600px",width:"600px",top:"10vh"}},tt={__name:"RoofSystemApp",setup(y){return K(()=>{ne.init({duration:4500,easing:"ease-in-out",once:!1})}),(_,k)=>(r(),u("div",Ze,[e("div",et,[S(Xe)])]))}},st=j(tt,[["__scopeId","data-v-aebd1914"]]),ot={class:"grid grid-cols-2 gap-0"},at={"data-aos":"fade-up-right","data-aos-delay":"500",style:{"margin-top":"90px"}},wt={__name:"RoofSystem",setup(y){return(_,k)=>(r(),u("div",ot,[S(st),e("div",at,[S(W),S(ke)])]))}};export{wt as default};
