import{s as A}from"./index-BvarP6TF.js";import{s as U}from"./index-5c983fTB.js";import{s as I}from"./index-Vt_1ietV.js";import{D as V}from"./DataService-CyJ9LaQ4.js";import{a as d,_ as k,u as C,N as D,t as R,o as v,j as h,k as s,l as i,c as M,q as E,v as L,x as B,y as j}from"./index-I0Br5oE7.js";import{u as q}from"./permitapp-sRL__nJC.js";import"./index-CHYIg4TL.js";import"./index-D2sy1bmy.js";function y(){const e=d(0);return{resNum:e,lastNum:async()=>{await V.getLastProcess().then(a=>{e.value=a.data,console.log("Response:",a.data,e.value)}).catch(a=>{console.error("Error:",a)})}}}function F(){const{resNum:e,lastNum:o}=y();console.log(e.value);const a=d(""),t=d(new Date().getFullYear()),p=d(6),f=d("me"),u=Array.from({length:10**p.value},(n,m)=>`${f.value}${t.value}${String(m).padStart(p.value,"0")}`);return a.value=u[0]+1,console.log(a.value,e.value),{pNum:a,lastNum:o,resNum:e}}const z={setup(){const e=d(""),o=C(),a=q(),t=D({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),p=d(!1),f=async()=>{const r=d(t.address),N=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(r.value)}&to=200`,S=await fetch(N);p.value=!0;const b=await S.json();console.log(b),t.muni=b.MinimumPropertyInfos[0].Municipality,t.folio=b.MinimumPropertyInfos[0].Strap,t.processNumber=u.value,setTimeout(()=>{p.value=!1},2e3)},{pNum:u}=F(),{lastNum:n,resNum:m}=y(),l=async()=>{await V.postProcessnumber(t.processNumber).then(r=>{e.value="Form submitted successfully!",console.log("Response:",r.data)}).catch(r=>{e.value="An error occurred while submitting the form.",console.error("Error:",r)})},_=d(),w=d([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),P=()=>{o.push("/generalpage")};function x(r,g){r=t,g=_.value,r.length!==0&&(a.addSystem(r,g),console.log(r,g,"System added"))}return{onSubmit:l,navigateNext:P,addItemAndClear:x,selectedApplication:_,type:w,resNum:m,...R(t),responseMessage:e,lastNum:n,useLast:y,load:f}}},c=e=>(B("data-v-1403f6e4"),e=e(),j(),e),W={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},Y={class:"md:w-2/3"},$={class:"container"},G={class:"row"},O={class:"card flex flex-col gap-2"},H=c(()=>s("div",{class:"font-semibold text-xl"},"Permit Application",-1)),J={class:"card flex justify-center"},K={class:"card flex flex-col gap-4"},Q={class:"flex flex-wrap gap-4"},T={class:"flex flex-col grow basis-0 gap-3"},X=c(()=>s("label",{for:"addr"},"Property Address",-1)),Z={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},ee={class:"flex flex-col grow basis-0 gap-3"},oe=c(()=>s("label",{for:"contractor"},"Contractor Name",-1)),se={class:"flex flex-col grow basis-0 gap-3"},le=c(()=>s("label",{for:"phone"},"Phone Number",-1)),te={class:"flex flex-col grow basis-0 gap-3"},ae=c(()=>s("label",{for:"Email"},"Email",-1)),ne={class:"flex flex-col grow basis-0 gap-3"},re=c(()=>s("label",{for:"muni"},"Municipality",-1)),ie={class:"flex flex-col grow basis-0 gap-3"},de=c(()=>s("label",{for:"folio"},"Folio",-1)),ce={class:"flex flex-col grow basis-0 gap-3"},pe=c(()=>s("label",{for:"permit"},"Master Permit",-1)),me={class:"flex flex-col grow basis-0 gap-3"},ue=c(()=>s("label",{for:"processnum"},"mEProcess Number",-1)),fe=c(()=>s("br",null,null,-1)),ge={key:0};function ve(e,o,a,t,p,f){const u=I,n=U,m=A;return v(),h("div",W,[s("div",Y,[s("div",$,[s("form",null,[s("div",G,[s("div",O,[H,s("div",J,[i(u,{modelValue:t.selectedApplication,"onUpdate:modelValue":o[0]||(o[0]=l=>t.selectedApplication=l),options:t.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),s("div",K,[s("div",Q,[s("form",{class:"w-3/4",onSubmit:o[10]||(o[10]=(...l)=>t.onSubmit&&t.onSubmit(...l))},[s("div",T,[X,i(n,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":o[1]||(o[1]=l=>e.address=l),placeholder:"address"},null,8,["modelValue"]),e.loading?(v(),h("i",Z)):(v(),M(m,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:t.load},null,8,["loading","onClick"]))]),s("div",ee,[oe,i(n,{id:"zip",modelValue:e.contractor,"onUpdate:modelValue":o[2]||(o[2]=l=>e.contractor=l),type:"text",placeholder:"name"},null,8,["modelValue"])]),s("div",se,[le,i(n,{id:"phone",modelValue:e.phone,"onUpdate:modelValue":o[3]||(o[3]=l=>e.phone=l),type:"text",placeholder:"000-000-0000"},null,8,["modelValue"])]),s("div",te,[ae,i(n,{modelValue:e.email,"onUpdate:modelValue":o[4]||(o[4]=l=>e.email=l),invalid:e.email===null},null,8,["modelValue","invalid"])]),s("div",ne,[re,i(n,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":o[5]||(o[5]=l=>e.muni=l),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),s("div",ie,[de,i(n,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":o[6]||(o[6]=l=>e.folio=l),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),s("div",ce,[pe,i(n,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":o[7]||(o[7]=l=>e.permit=l),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),s("div",me,[ue,i(n,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":o[8]||(o[8]=l=>e.processNumber=l),type:"text",placeholder:"process number"},null,8,["modelValue"])]),fe,i(m,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:o[9]||(o[9]=l=>t.addItemAndClear(e.formData,t.selectedApplication))})],32),t.responseMessage?(v(),h("p",ge,E(t.responseMessage),1)):L("",!0)])])])])])])])])}const Ne=k(z,[["render",ve],["__scopeId","data-v-1403f6e4"]]);export{Ne as default};
