import{s as oe}from"./index-DA0qBvev.js";import{s as le}from"./index-Bg9LKgWN.js";import{s as ae}from"./index-BDHe-Wiz.js";import{s as se}from"./index-RUvCPtbt.js";import{u as te,_ as ne}from"./lastNumber-CFYfXFhD.js";import{e as l,u as ie,h as G,f as ue,a0 as re,E as q,ae as de,af as ce,o as k,c as I,a as me,d as B,i as o,j as n,G as pe,t as ve,F as fe,ah as _e,_ as z,J as he,K as be}from"./index-B2cRogJg.js";import{u as Ve}from"./useScreenSize-BKnTYooI.js";import{u as ge}from"./processStore-O9blIhpr.js";import{u as ye}from"./use-createProcessnumber-C9iho6k8.js";import{u as Pe}from"./accountsStore-DOxHUa_t.js";import{u as Se}from"./permitapp-B0k_CCNn.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BmrBBKPv.js";import"./index-BL0kwEZF.js";import"./index-D8SkniZM.js";import"./index-BoguhCli.js";import"./index-Du49SNeB.js";import"./index-D5gWhGh0.js";import"./index-CnEOmgvx.js";import"./useAxios-Mb4vjaC0.js";const u=V=>(he("data-v-4f3a65f3"),V=V(),be(),V),we={class:"hero"},Ne={class:"card"},Ue=u(()=>o("h1",{class:"title"},"Permit Application",-1)),Me={class:"field"},Ie=u(()=>o("label",{for:"license"},"License Status",-1)),Be={class:"field"},De=u(()=>o("label",{for:"processMuni"},"Municipality Process #",-1)),Ae={class:"field span-2"},xe=u(()=>o("label",{for:"addr"},"Property Address",-1)),Ce={class:"input-row"},Ee={class:"field"},$e=u(()=>o("label",{for:"dba"},"DBA",-1)),Le={class:"field span-2"},Re=u(()=>o("label",{for:"name"},"Contractor Name",-1)),We={class:"field"},je=u(()=>o("label",{for:"phone"},"Cell Phone",-1)),Fe={class:"field"},Oe=u(()=>o("label",{for:"email"},"Email",-1)),Te={key:0,class:"error"},Ge={class:"field"},qe=u(()=>o("label",{for:"muni"},"Municipality",-1)),ze={class:"field"},Je=u(()=>o("label",{for:"folio"},"Folio",-1)),Ke={class:"field"},Ye=u(()=>o("label",{for:"permit"},"Master Permit",-1)),He={class:"field"},Qe=u(()=>o("label",{for:"processnum"},"mEProcess #",-1)),Xe={key:0,class:"response span-2"},Ze={class:"span-2 submit-row"},eo={__name:"PermitApp",setup(V){const p=l(!1),D=l(""),A=l(!1);l(),ie();const J=ge(),{procData:oo,procReceive:x}=ye(),{accountUsers:v,getUser:lo,addUser:ao}=Pe(),C=Se(),E=l([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),K=l("me");G(()=>{const{width:s,isUltraWide:e,height:r,isLongScreen:d}=Ve();return console.log(s,e),{width:s,isUltraWide:e,height:r,isLongScreen:d}});const t=ue({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",phNumber:"",emails:"",muniProc:"",date:new Date}),c=l(""),$=l(""),Y=l(!0),w=l(!1),f=l(""),g=l(""),_=l(""),N=l(""),y=l(""),h=l([]),m=l(""),U=l(!1);G(()=>{var s;U.value===!1&&((s=v.value[0])==null?void 0:s.secondary_status)==="I"?(console.log(U.value),alert("Your license is Inactive!")):U.value=!0}),re(()=>{L(),A.value=!0,localStorage.clear()});const H=q(()=>{var s,e;return((s=v.value[0])==null?void 0:s.bphone)!==""&&(w.value=!0,_.value=v.value[0].bphone,console.log(_.value)),w.value===!0?_.value:(e=v.value[0])==null?void 0:e.bphone});de(L,H,()=>{});async function L(){var s,e,r,d,i,b,S;h.value=await v.value[0],N.value=((s=h.value)==null?void 0:s.name)||"",y.value=((e=h.value)==null?void 0:e.email)||"",f.value=((r=h.value)==null?void 0:r.secondary_status)||"",console.log(f.value),g.value=((d=h.value)==null?void 0:d.dba)||"",m.value=(b=(i=J.$state.processinput[0])==null?void 0:i.procData)==null?void 0:b.address,_.value=(S=v.value[0])==null?void 0:S.bphone}ce(async()=>{await _e(w).toBe(!0)});const M=q(()=>Y.value?E.value[0]:""),{resNum:Q}=te(),R=l(""),W=l(""),j=l(null),P=l(""),F=l(null),O=l("");async function X(s){p.value=!0,F.value=null;try{const e=await fetch(s);j.value=await e.json(),P.value=j.value.MinimumPropertyInfos[0],console.log(P.value),t.muni=P.value.Municipality,t.folio=P.value.Strap,W.value=t.folio,O.value=W.value.substring(1,2),R.value=z(O)}catch(e){F.value=e.message}finally{p.value=!1}}async function T(){try{p.value=!0,setTimeout(()=>p.value=!1,1e3),$.value=c.value;const s=m.value;console.log(s);const e=`https://6x2kydgvuahfitwvxkkfbybv6u0kbxgl.lambda-url.us-east-1.on.aws/?address=${s}`;console.log(e),await X(e),console.log(c.value),Object.assign(t,{license:f.value,contractor:g.value,emails:y.value,muniProc:c.value,phNumber:_.value});const r=String(Q.value).substring(3,19),d=z(r).value+1;t.processNumber=K.value.concat(String(d)),t.muniProc=c.value,t.address=m.value,console.log(t),x(t)}catch(s){alert(s)}}function Z(){x(t)}function ee(){console.log(m.value),C.addSystem(t,M.value,R.value,c.value,$.value,m.value),console.log(C)}return(s,e)=>{const r=ne,d=se,i=ae,b=le,S=oe;return k(),I(fe,null,[A.value?(k(),me(r,{key:0})):B("",!0),o("section",we,[o("div",Ne,[Ue,n(d,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=a=>M.value=a),options:E.value,optionLabel:"name",placeholder:"Select a permit type",class:"w-full permit-select"},null,8,["modelValue","options"]),o("form",{class:"grid-form",onSubmit:pe(Z,["prevent"])},[o("div",Me,[Ie,n(i,{id:"license",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),placeholder:"active / inactive"},null,8,["modelValue"])]),o("div",Be,[De,n(i,{id:"processMuni",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),placeholder:"00000000",onChange:T},null,8,["modelValue"])]),o("div",Ae,[xe,o("div",Ce,[n(i,{id:"addr",modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),placeholder:"123 SW 1st St"},null,8,["modelValue"]),n(b,{type:"button",icon:"pi pi-search",loading:p.value,onClick:T},null,8,["loading"])])]),o("div",Ee,[$e,n(i,{id:"dba",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=a=>g.value=a),placeholder:"company alias"},null,8,["modelValue"])]),o("div",Le,[Re,n(i,{id:"name",modelValue:N.value,"onUpdate:modelValue":e[5]||(e[5]=a=>N.value=a),placeholder:"full name"},null,8,["modelValue"])]),o("div",We,[je,n(S,{id:"phone",modelValue:t.phNumber,"onUpdate:modelValue":e[6]||(e[6]=a=>t.phNumber=a),mask:"(999) 999-9999",placeholder:"(999) 999-9999"},null,8,["modelValue"])]),o("div",Fe,[Oe,n(i,{id:"email",modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=a=>y.value=a),invalid:s.invalid,placeholder:"you@example.com"},null,8,["modelValue","invalid"]),s.invalid?(k(),I("small",Te,"Email is required")):B("",!0)]),o("div",Ge,[qe,n(i,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[8]||(e[8]=a=>t.muni=a),placeholder:"Miami Beach"},null,8,["modelValue"])]),o("div",ze,[Je,n(i,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[9]||(e[9]=a=>t.folio=a),placeholder:"00-0000-000-0000",onInput:s.updatemEProcess},null,8,["modelValue","onInput"])]),o("div",Ke,[Ye,n(i,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[10]||(e[10]=a=>t.permit=a),placeholder:"20000000"},null,8,["modelValue"])]),o("div",He,[Qe,n(i,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[11]||(e[11]=a=>t.processNumber=a),placeholder:"auto-generated"},null,8,["modelValue"])]),D.value?(k(),I("p",Xe,ve(D.value),1)):B("",!0),o("div",Ze,[n(b,{label:"Submit",type:"submit",loading:p.value,severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:ee},null,8,["loading"])])],32)])])],64)}}},wo=ke(eo,[["__scopeId","data-v-4f3a65f3"]]);export{wo as default};
