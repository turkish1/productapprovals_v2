import{s as j}from"./index-F_WKA_xs.js";import{u as R}from"./useDripedge-yytJ8VL9.js";import{D as T,e as p,f as z,Z as $,g as F,V,w as L,ae as O,af as B,o as C,c as H,j as N,k as w,ak as A,i as _,al as x,I as J}from"./index-BD8zqOrX.js";import{u as P}from"./roofList-C6D7jWcX.js";import{u as G,a as Z}from"./useAxios-DiqHk6Ps.js";const K=T("dripinputmaterial",{state:()=>({dripinputmaterial:[],dripMTileMaterial:[],dripinputsize:[],inputselectedUserDripEdge:[],selectedDripSize:[],id:2}),actions:{addMTileDrip(e){this.dripinputmaterial.push({dripMTileData:e,completed:!1})},addSTileDrip(e){this.dripinputsize.push({selectedDripSizenew:e,completed:!1})},insertDripAtIndex(e,t){this.dripinputmaterial.splice(e,0,{dripMTileMaterial:t,completed:!1})},addUseritems(e){this.inputselectedUserDripEdge.push({dripSelection:e,completed:!1})},resetState(){console.log("reset was called: ",this.inputselectedUserDripEdge),this.inputselectedUserDripEdge=[],console.log("reset was called: ",this.inputselectedUserDripEdge)}}}),Q={class:"flex flex-col w-96 mb-4 gap-3",style:{"margin-left":"20px"}},W=_("label",{style:{color:"#122620"}},"Drip Edge Material",-1),X=_("label",{style:{color:"#122620"}},"Drip Edge Size",-1),ie={__name:"DripEdMechTile",emits:["update-valuesize"],setup(e,{emit:t}){const{selectDripEdge:l,selectDripEdgeSize:s,type:u,sizeTypeMetal:i}=R(),n=P(),f=p(n.$state.roofList),c=p(),g=p(null),r=K(),o=t;let a=p(!1);const m=p(),M=z({DripEdgeMaterial:"",DripEdgeSize:""}),k=$(()=>{if(f.value.length===0)return"";for(let d=0;d<f.value.length;d++)f.value[d].item==="Mechanical Fastened Tile"&&(a.value=!0,c.value=u.value);h()}),E=z({DripEdgeMaterial:"",DripEdgeSize:""}),I=()=>{o("update-valuesize",s.value),E.DripEdgeSize=s.value,y()};F(()=>{S()});function h(){for(let d=0;d<f.value.length;d++)f.value[d].item==="Mechanical Fastened Tile"&&console.log(f.value[d].item);q()}function S(){c.value=u.value}async function y(){l.value?(l.value==="Galvanized Steel Metal ¹"&&(m.value=i.galvanized,h()),l.value==="Stainless Steel Metal ²"&&(m.value=i.stainless,h()),l.value==="Aluminum Metal ³"&&(m.value=i.aluminum,h()),l.value==="Copper Metal ⁴"&&(m.value=i.copper,h())):console.log("The element not mounted yet"),M.DripEdgeMaterial=l.value,M.DripEdgeSize=s.value,h()}function q(){E.DripEdgeMaterial=l.value,U()}const U=async d=>{r.resetState(),r.addUseritems(M),console.log(r)};return V(c,m,u),L(S,y),O(async()=>{await B(k).toBe(!0)}),(d,v)=>{const D=j;return C(),H("div",Q,[W,N(D,{modelValue:w(l),"onUpdate:modelValue":[v[0]||(v[0]=b=>A(l)?l.value=b:null),S],options:c.value,placeholder:"make selection"},null,8,["modelValue","options"]),X,N(D,{ref_key:"selectSizeRef",ref:g,modelValue:w(s),"onUpdate:modelValue":v[1]||(v[1]=b=>A(s)?s.value=b:null),options:m.value,onClick:y,onChange:I,placeholder:"make selection"},null,8,["modelValue","options"])])}}},Y="https://myfawca4fj3ewpg5usmepe6toi0wuvlw.lambda-url.us-east-1.on.aws/";function ne(){const e=p(null),t=p(!1),{data:l,error:s,isFetching:u,execute:i}=G(Y,{method:"POST",headers:{"Content-Type":"application/json"}},Z,{immediate:!1}),n=async(c,g)=>{var r,o;t.value=!0,e.value=null;try{const a=await i({data:c});return(a==null?void 0:a.data)??l.value}catch(a){throw console.error(`Lambda ${g} failed:`,{message:a==null?void 0:a.message,code:a==null?void 0:a.code,status:(r=a==null?void 0:a.response)==null?void 0:r.status,data:(o=a==null?void 0:a.response)==null?void 0:o.data}),e.value=(a==null?void 0:a.message)||"Request failed",a}finally{t.value=!1}};return{data:l,errors:e,isFetching:u,loading:t,postMech:c=>n(c,"postMech")}}function oe({min:e=null,max:t=null,required:l=!1}){const s=p(null);return{errorHeightMessage:s,validateTileHeight:i=>{const n=i;return e!==null&&n<e?(s.value=`Number must be greater than or equal to ${e}`,console.log("min",n,e),!1):t!==null&&n>=e&&n>=t?(s.value=`Number must be less than or equal to ${t}`,console.log("max",n),!1):l&&(i==null||i==="")?(s.value="This field is required",console.log("required"),!1):(s.value=null,!0)}}}function ue({min:e=null,max:t=null,required:l=!1}){const s=p(null);return{errorMessage:s,validateNumber:i=>{const n=i;return e!==null&&n<e?(s.value=`Number must be greater than or equal to ${e}`,!1):t!==null&&n>=e&&n>=t?(s.value=`Number must be less than or equal to ${t}`,console.log("max",n),!1):l&&(i==null||i==="")?(s.value="This field is required",console.log("required"),!1):(s.value=null,!0)}}}const ee=T("tileMechInput",{state:()=>({tileMechInput:[],id:0}),actions:{addSystem(e){let t=[],l=Date.now();if(Array.isArray(e))t=e;else if(typeof e=="string")try{const u=JSON.parse(e);t=Array.isArray(u)?u:[]}catch{t=[]}else e&&typeof e=="object"&&(l=typeof e.fetchedAt=="number"?e.fetchedAt:l,t=Array.isArray(e.noa)?e.noa:[]);const s=t.map(String).slice();this.tileMechInput.push({noa:s,fetchedAt:l,completed:!1})},reset(){this.$reset()}},getters:{latest(e){return e.tileMechInput.length?e.tileMechInput[e.tileMechInput.length-1]:null},latestNoa(e){const t=e.tileMechInput.length?e.tileMechInput[e.tileMechInput.length-1]:null;return Array.isArray(t==null?void 0:t.noa)?t.noa.slice():[]}}});function ce(){const e=ee(),t=p(""),l="https://mczqlparb6o6umu7j4ct7pv4vi0jrnat.lambda-url.us-east-1.on.aws/",s=(r,o=null)=>{try{return JSON.parse(r)}catch{return o}},u=r=>{let o=(r==null?void 0:r.body)??r;return typeof o=="string"&&(o=s(o,[])),Array.isArray(o)?o.map(String).slice():[]},{error:i,isFetching:n,execute:f}=x(l,{immediate:!1,afterFetch(r){const o=u(r.data);return o.length&&e.addSystem({noa:o,fetchedAt:Date.now()}),r}}).get().json();V(i,r=>{t.value=r?String(r):""});const c=async()=>(t.value="",await f());return{tileMechNumber:J(()=>e.latestNoa),callNumber:c,isFetching:n,errors:t,mechNumberStore:e}}export{ie as _,ne as a,ue as b,oe as c,K as d,ee as e,ce as u};
