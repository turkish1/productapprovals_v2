import{s as oe}from"./index-P6uYNwrj.js";import{s as le}from"./index-B3faANOt.js";import{s as ae}from"./index-Cb5mLeSw.js";import{s as se}from"./index-BUJJqf1Q.js";import{u as te,_ as ne}from"./lastNumber-BcHhsqOh.js";import{e as l,u as ie,h as T,f as ue,_ as re,D as q,ad as de,ae as ce,o as S,c as M,a as me,d as I,i as o,j as n,J as pe,t as ve,F as fe,ag as _e,Z as z,K as he,L as be}from"./index-B2smwGly.js";import{u as Ve}from"./useScreenSize-BciODuF5.js";import{u as ge}from"./processStore-BgEGfiRi.js";import{u as ye}from"./use-createProcessnumber-CU3awa6J.js";import{u as Pe}from"./accountsStore-BMO8BRMi.js";import{u as Se}from"./permitapp-NCykq1Gf.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DU9H1nvo.js";import"./index-B3wxthp8.js";import"./index-BFLMIBiU.js";import"./index-mJ9Mqzll.js";import"./index-34UwQZj5.js";import"./index-VVBIDrCd.js";import"./index-Bjs_HHbr.js";import"./useAxios-fhzp9nkt.js";const u=V=>(he("data-v-0d3ed1bd"),V=V(),be(),V),we={class:"hero"},Ne={class:"card"},Ue=u(()=>o("h1",{class:"title"},"Permit Application",-1)),Me={class:"field"},Ie=u(()=>o("label",{for:"license"},"License Status",-1)),De={class:"field"},Be=u(()=>o("label",{for:"processMuni"},"Municipality Process #",-1)),Ae={class:"field span-2"},xe=u(()=>o("label",{for:"addr"},"Property Address",-1)),Ce={class:"input-row"},Ee={class:"field"},Le=u(()=>o("label",{for:"dba"},"DBA",-1)),$e={class:"field span-2"},Re=u(()=>o("label",{for:"name"},"Contractor Name",-1)),We={class:"field"},je=u(()=>o("label",{for:"phone"},"Cell Phone",-1)),Fe={class:"field"},Oe=u(()=>o("label",{for:"email"},"Email",-1)),Te={key:0,class:"error"},qe={class:"field"},ze=u(()=>o("label",{for:"muni"},"Municipality",-1)),Ge={class:"field"},Je=u(()=>o("label",{for:"folio"},"Folio",-1)),Ke={class:"field"},Ye=u(()=>o("label",{for:"permit"},"Master Permit",-1)),Ze={class:"field"},He=u(()=>o("label",{for:"processnum"},"mEProcess #",-1)),Qe={key:0,class:"response span-2"},Xe={class:"span-2 submit-row"},eo={__name:"PermitApp",setup(V){const p=l(!1),D=l(""),B=l(!1);l(),ie();const G=ge(),{procData:oo,procReceive:A}=ye(),{accountUsers:v,getUser:lo,addUser:ao}=Pe(),x=Se(),C=l([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),J=l("me");T(()=>{const{width:s,isUltraWide:e,height:r,isLongScreen:d}=Ve();return console.log(s,e),{width:s,isUltraWide:e,height:r,isLongScreen:d}});const t=ue({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",phNumber:"",emails:"",muniProc:"",date:new Date}),c=l(""),E=l(""),K=l(!0),k=l(!1),f=l(""),g=l(""),_=l(""),w=l(""),y=l(""),h=l([]),m=l(""),N=l(!1);T(()=>{var s;N.value===!1&&((s=v.value[0])==null?void 0:s.secondary_status)==="I"?(console.log(N.value),alert("Your license is Inactive!")):N.value=!0}),re(()=>{L(),B.value=!0,localStorage.clear()});const Y=q(()=>{var s,e;return((s=v.value[0])==null?void 0:s.bphone)!==""&&(k.value=!0,_.value=v.value[0].bphone,console.log(_.value)),k.value===!0?_.value:(e=v.value[0])==null?void 0:e.bphone});de(L,Y,()=>{});async function L(){var s,e,r,d,i,b;h.value=await v.value[0],w.value=((s=h.value)==null?void 0:s.name)||"",y.value=((e=h.value)==null?void 0:e.email)||"",f.value=h.value.secondary_status||"",console.log(f.value),g.value=((r=h.value)==null?void 0:r.dba)||"",m.value=(i=(d=G.$state.processinput[0])==null?void 0:d.procData)==null?void 0:i.address,_.value=(b=v.value[0])==null?void 0:b.bphone}ce(async()=>{await _e(k).toBe(!0)});const U=q(()=>K.value?C.value[0]:""),{resNum:Z}=te(),$=l(""),R=l(""),W=l(null),P=l(""),j=l(null),F=l("");async function H(s){p.value=!0,j.value=null;try{const e=await fetch(s);W.value=await e.json(),P.value=W.value.MinimumPropertyInfos[0],console.log(P.value),t.muni=P.value.Municipality,t.folio=P.value.Strap,R.value=t.folio,F.value=R.value.substring(1,2),$.value=z(F)}catch(e){j.value=e.message}finally{p.value=!1}}async function O(){try{p.value=!0,setTimeout(()=>p.value=!1,1e3),E.value=c.value;const s=m.value;console.log(s);const e=`https://6x2kydgvuahfitwvxkkfbybv6u0kbxgl.lambda-url.us-east-1.on.aws/?address=${s}`;console.log(e),await H(e),console.log(c.value),Object.assign(t,{license:f.value,contractor:g.value,emails:y.value,muniProc:c.value,phNumber:_.value});const r=String(Z.value).substring(3,19),d=z(r).value+1;t.processNumber=J.value.concat(String(d)),t.muniProc=c.value,t.address=m.value,console.log(t),A(t)}catch(s){alert(s)}}function Q(){A(t)}function X(){console.log(m.value),x.addSystem(t,U.value,$.value,c.value,E.value,m.value),console.log(x)}return(s,e)=>{const r=ne,d=se,i=ae,b=le,ee=oe;return S(),M(fe,null,[B.value?(S(),me(r,{key:0})):I("",!0),o("section",we,[o("div",Ne,[Ue,n(d,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),options:C.value,optionLabel:"name",placeholder:"Select a permit type",class:"w-full permit-select"},null,8,["modelValue","options"]),o("form",{class:"grid-form",onSubmit:pe(Q,["prevent"])},[o("div",Me,[Ie,n(i,{id:"license",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),placeholder:"active / inactive"},null,8,["modelValue"])]),o("div",De,[Be,n(i,{id:"processMuni",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),placeholder:"00000000",onChange:O},null,8,["modelValue"])]),o("div",Ae,[xe,o("div",Ce,[n(i,{id:"addr",modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),placeholder:"123 SW 1st St"},null,8,["modelValue"]),n(b,{type:"button",icon:"pi pi-search",loading:p.value,onClick:O},null,8,["loading"])])]),o("div",Ee,[Le,n(i,{id:"dba",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=a=>g.value=a),placeholder:"company alias"},null,8,["modelValue"])]),o("div",$e,[Re,n(i,{id:"name",modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=a=>w.value=a),placeholder:"full name"},null,8,["modelValue"])]),o("div",We,[je,n(ee,{id:"phone",modelValue:t.phNumber,"onUpdate:modelValue":e[6]||(e[6]=a=>t.phNumber=a),mask:"(999) 999-9999",placeholder:"(999) 999-9999"},null,8,["modelValue"])]),o("div",Fe,[Oe,n(i,{id:"email",modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=a=>y.value=a),invalid:s.invalid,placeholder:"you@example.com"},null,8,["modelValue","invalid"]),s.invalid?(S(),M("small",Te,"Email is required")):I("",!0)]),o("div",qe,[ze,n(i,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[8]||(e[8]=a=>t.muni=a),placeholder:"Miami Beach"},null,8,["modelValue"])]),o("div",Ge,[Je,n(i,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[9]||(e[9]=a=>t.folio=a),placeholder:"00-0000-000-0000",onInput:s.updatemEProcess},null,8,["modelValue","onInput"])]),o("div",Ke,[Ye,n(i,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[10]||(e[10]=a=>t.permit=a),placeholder:"20000000"},null,8,["modelValue"])]),o("div",Ze,[He,n(i,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[11]||(e[11]=a=>t.processNumber=a),placeholder:"auto-generated"},null,8,["modelValue"])]),D.value?(S(),M("p",Qe,ve(D.value),1)):I("",!0),o("div",Xe,[n(b,{label:"Submit",type:"submit",loading:p.value,severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:X},null,8,["loading"])])],32)])])],64)}}},wo=ke(eo,[["__scopeId","data-v-0d3ed1bd"]]);export{wo as default};
