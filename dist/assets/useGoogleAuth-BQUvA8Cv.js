import{u as y}from"./accountsStore-BJjGGRi9.js";import{u as _}from"./useAxios-CBOw-Q94.js";import{e as u,f as d,h as j}from"./index-qYAEF0tq.js";function C(){const l=u(null),c=u(null);let i=null;const e=u([]);let r=d({});const t=d({dba:"",email:"",cphone:"",bphone:"",expiration_date:"",name:"",projects:[],secondary_status:"",license:"",phone:""}),p=u(null),{addUser:h}=y();j(()=>{i=google.accounts.oauth2.initTokenClient({client_id:"978320609817-r83rgg9qsb4ntam9dek995cqcn779qut.apps.googleusercontent.com",scope:["openid","email","profile","https://www.googleapis.com/auth/gmail.readonly"].join(" "),callback:f})});const v=()=>i.requestAccessToken({prompt:"consent"},w()),g=()=>{l.value&&google.accounts.oauth2.revoke(l.value,()=>{l.value=null,c.value=null})};async function w(){let o="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/getaccounts";const{execute:n,then:s,data:a}=_(o,{method:"GET"},{immediate:!1});let b=u([]);b.value=n().then(x=>{r=a.value;for(const[q,k]of Object.entries(r))e.value.push(k);console.log(e.value)})}async function f(o){if(o.error)return console.error(o);l.value=o.access_token;const n=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${o.access_token}`}}).then(s=>s.json());p.value=n.email,m(p)}async function m(o){var s;const n=await o.value;console.log(n);for(let a=0;a<=e.value[0].length;a++)await((s=e.value[0][a])==null?void 0:s.email)===n&&(t.email=await e.value[0][a].email,t.name=await e.value[0][a].name,console.log(e.value[0][0].secondary_status),t.dba=await e.value[0][a].dba,t.cphone=await e.value[0][a].cphone,t.bphone=await e.value[0][a].bphone,t.phone=await e.value[0][a].bphone,t.expiration_date=await e.value[0][a].expiration_date,t.projects=await e.value[0][a].projects,t.secondary_status=await e.value[0][0].secondary_status,t.license=await e.value[0][a].license,console.log(t),h(t))}return{accessToken:l,idPayload:c,signIn:v,signOut:g,checkEmail:m,localData:e,acctUser:t}}export{C as u};
