import{_ as k,a as P,r as n,o as g,c as h,d as t,m as N,F as B,O as q,k as V,l as A,g as z,u as O,t as T,b as u,L as W,p as j,f as Y}from"./index-CtI0L-Dp.js";import{s as G}from"./index-DRZpYJFj.js";import{s as Z}from"./index-Dw2d9Z3O.js";import{s as H}from"./index-B_QYdjLH.js";import{s as J}from"./index-Dr0k286p.js";import{D as K}from"./DataService-BNW86fK-.js";import{u as Q}from"./useAxios-CvNDMnjf.js";import{u as X}from"./permitapp-qwDstoEV.js";import{a as ee}from"./index-CGFpS3JV.js";import"./index-C3WLjdhw.js";import"./index-1sMkYHaG.js";const oe={class:"bg-clip-content p-6 bg-gray w-2/3 border-4 border-midnight border-dashed"},se={key:0},te={class:"file-previews"},le=["src"],ae={__name:"DropZone",setup(o){const e=P([]),c=n(null),l=()=>{},f=()=>{},v=r=>{const d=r.dataTransfer.files;a(d)},i=r=>{const d=r.target.files;a(d)},a=r=>{Array.from(r).forEach(d=>{const s=new FileReader;s.onload=_=>{d.preview=_.target.result,e.push(d)},p(d)?s.readAsDataURL(d):e.push(d)})},p=r=>r.type.startsWith("image/");return(r,d)=>(g(),h("div",oe,[t("div",{class:"file-drop-zone",onDragover:V(l,["prevent"]),onDrop:V(v,["prevent"]),onDragleave:V(f,["prevent"])},[e.length?N("",!0):(g(),h("p",se,"Drag and drop files here, or click to select files")),t("input",{type:"file",multiple:"",onChange:i,ref_key:"fileInput",ref:c,style:{display:"none"}},null,544),t("div",te,[(g(!0),h(B,null,q(e,(s,_)=>(g(),h("div",{key:_,class:"file-preview"},[p(s)?(g(),h("img",{key:0,src:s.preview,alt:"File preview"},null,8,le)):N("",!0),t("p",null,A(s.name),1)]))),128))])],32)]))}},ne=k(ae,[["__scopeId","data-v-987cb64c"]]);function w(){const o=n(null),e=n(0);return K.getLastProcess().then(c=>{o.value=c.data,o.value.forEach(l=>{console.log(l.processNumber),e.value=l.processNumber})}).catch(c=>{console.error("Error:",c)}),{resNum:o,lastNum:e}}function re(){const{resNum:o,lastNum:e}=w(),c=n(""),l=n(new Date().getFullYear()),f=n(6),v=n("me"),i=Array.from({length:10**f.value},(p,r)=>`${v.value}${l.value}${String(r).padStart(f.value,"0")}`),a=w();return console.log(a),c.value=i[0]+1,e.value!==0?console.log("entered lastNum equal null",e.value):(console.log("entered lastNum equal a number",e.value),c.value=e.value+1),console.log(c.value,e.value,a),{pNum:c,lastNum:e,resNum:o,test:a}}const ie=z("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(o){this.processinput.push({procData:o,completed:!1})}}});function de(){const o=n("");let e=n([]);const c=ie(),l=n("");let f="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:v,data:i}=Q(f,{method:"POST"},{immediate:!1});let a=P({});function p(r){console.log(r),a=r,v({data:r}),o.value="Form submitted successfully!",c.addData(a),console.log(a,"System added")}return{error:l,results:e,procReceive:p,responseMessage:o,procData:a,procStore:c}}n(1);const ce={setup(){const o=n(""),e=O(),{procData:c,procReceive:l}=de(),f=n("me"),v=X(),i=P({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),a=n(!1);re();const{lastNum:p,resNum:r}=w(),d=n(""),s=n(""),_=async()=>{const b=n(i.address),C=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(b.value)}&to=200`,F=await fetch(C);a.value=!0;const S=await F.json();console.log(S),i.muni=S.MinimumPropertyInfos[0].Municipality,i.folio=S.MinimumPropertyInfos[0].Strap;let D=String(p.value);console.log(p.value.length,p.value,D);let R=D.substring(2,13),E=ee(R).value+1,$=String(E);i.processNumber=f.value.concat($),console.log(i.processNumber),s.value=i.folio,d.value=s.value.substring(0,2),console.log(d.value),l(i),setTimeout(()=>{a.value=!1},2e3)},I=async()=>{l(i)},x=n(),U=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),L=()=>{e.push("/generalpage")};function M(b,y){b=i,y=x.value,b.length!==0&&(v.addSystem(b,y),console.log(b,y,"System added"))}return{onSubmit:I,navigateNext:L,addItemAndClear:M,selectedApplication:x,type:U,resNum:r,...T(i),responseMessage:o,lastNum:p,useLast:w,load:_,checkMB:d,checkV:s}}},m=o=>(j("data-v-8ed4b913"),o=o(),Y(),o),pe={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},ue={class:"md:w-2/3"},me={class:"container"},fe={class:"row"},ge={class:"card flex flex-col gap-2"},ve=m(()=>t("div",{class:"font-semibold text-xl"},"Permit Application",-1)),he={class:"card flex justify-center"},be={class:"card flex flex-col gap-4"},_e={class:"flex flex-wrap gap-4"},ye={class:"flex flex-col grow basis-0 gap-3"},we=m(()=>t("label",{for:"addr"},"Property Address",-1)),Se={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Ve={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ne=m(()=>t("label",{for:"contractor"},"Contractor Name",-1)),Pe={class:"flex flex-col mt-3 grow basis-0 gap-3"},xe=m(()=>t("label",{for:"phone"},"Cell Phone Number",-1)),De={class:"flex flex-col mt-3 grow basis-0 gap-3"},ke=m(()=>t("label",{for:"Email"},"Email",-1)),Ae={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ie=m(()=>t("label",{for:"muni"},"Municipality",-1)),Ue={class:"flex flex-col mt-3 grow basis-0 gap-3"},Le=m(()=>t("label",{for:"folio"},"Folio",-1)),Me={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ce=m(()=>t("label",{for:"permit"},"Master Permit",-1)),Fe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Re=m(()=>t("label",{for:"processnum"},"mEProcess Number",-1)),Ee=m(()=>t("br",null,null,-1)),$e={key:0};function Be(o,e,c,l,f,v){const i=J,a=H,p=Z,r=G,d=ne;return g(),h("div",pe,[t("div",ue,[t("div",me,[t("form",null,[t("div",fe,[t("div",ge,[ve,t("div",he,[u(i,{modelValue:l.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=s=>l.selectedApplication=s),options:l.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),t("div",be,[t("div",_e,[t("form",{class:"w-3/4",onSubmit:e[10]||(e[10]=(...s)=>l.onSubmit&&l.onSubmit(...s))},[t("div",ye,[we,u(a,{id:"addr",type:"text",modelValue:o.address,"onUpdate:modelValue":e[1]||(e[1]=s=>o.address=s),placeholder:"address"},null,8,["modelValue"]),o.loading?(g(),h("i",Se)):(g(),W(p,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:o.loading,onClick:l.load},null,8,["loading","onClick"]))]),t("div",Ve,[Ne,u(a,{id:"zip",modelValue:o.contractor,"onUpdate:modelValue":e[2]||(e[2]=s=>o.contractor=s),type:"text",placeholder:"name"},null,8,["modelValue"])]),t("div",Pe,[xe,u(r,{modelValue:o.phone,"onUpdate:modelValue":e[3]||(e[3]=s=>o.phone=s),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:o.phone===""},null,8,["modelValue","invalid"])]),t("div",De,[ke,u(a,{modelValue:o.email,"onUpdate:modelValue":e[4]||(e[4]=s=>o.email=s),invalid:o.email===null},null,8,["modelValue","invalid"])]),t("div",Ae,[Ie,u(a,{id:"muni",modelValue:o.muni,"onUpdate:modelValue":e[5]||(e[5]=s=>o.muni=s),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),t("div",Ue,[Le,u(a,{id:"folio",modelValue:o.folio,"onUpdate:modelValue":e[6]||(e[6]=s=>o.folio=s),type:"text",placeholder:"folio",onInput:o.updatemEProcess},null,8,["modelValue","onInput"])]),t("div",Me,[Ce,u(a,{id:"permit",modelValue:o.permit,"onUpdate:modelValue":e[7]||(e[7]=s=>o.permit=s),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),t("div",Fe,[Re,u(a,{id:"processnum",modelValue:o.processNumber,"onUpdate:modelValue":e[8]||(e[8]=s=>o.processNumber=s),type:"text",placeholder:"process number"},null,8,["modelValue"])]),Ee,u(p,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:e[9]||(e[9]=s=>l.addItemAndClear(o.formData,l.selectedApplication))})],32),l.responseMessage?(g(),h("p",$e,A(l.responseMessage),1)):N("",!0)])])])])]),u(d)])])])}const Qe=k(ce,[["render",Be],["__scopeId","data-v-8ed4b913"]]);export{Qe as default};
