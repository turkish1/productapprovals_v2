import{s as le}from"./index-CJHKD770.js";import{s as ae}from"./index-DeykncHS.js";import{s as se}from"./index-Cj1DsBTX.js";import{s as te}from"./index-_bTEFGFH.js";import{u as ne,_ as ie}from"./lastNumber-aBdEIaiP.js";import{e as l,u as ue,h as T,f as re,Z as de,J as Y,ad as ce,ae as me,o as V,c as k,a as pe,d as w,i as o,j as n,K as ve,t as fe,F as _e,ag as he,Y as q,C as be,D as Ve}from"./index-De1Ad2_f.js";import{u as ge}from"./useScreenSize-Cy8N6hNC.js";import{u as ye}from"./processStore-s_qJIZgP.js";import{u as Pe}from"./use-createProcessnumber-BmbkHpqm.js";import{u as Se}from"./accountsStore-TkE19owN.js";import{u as ke}from"./permitapp-DfdyMhgY.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-LMR9t1WY.js";import"./index-CNBpaZJy.js";import"./index-D_hN98WM.js";import"./index-CRP5SfiS.js";import"./index-Bk2zgILS.js";import"./index-D5aFhZbX.js";import"./index-f30aZHtB.js";import"./useAxios-_Wk3M5E5.js";const u=g=>(be("data-v-b294e923"),g=g(),Ve(),g),Ne={class:"hero"},Me={class:"card"},Ue=u(()=>o("h1",{class:"title"},"Permit Application",-1)),Ie={class:"field"},Be=u(()=>o("label",{for:"license"},"License Status",-1)),De={class:"field"},Ae=u(()=>o("label",{for:"processMuni"},"Municipality Process #",-1)),xe={class:"field"},Ce=u(()=>o("label",{for:"addr"},"Property Address",-1)),Ee={class:"input-row"},$e={class:"field"},Le={key:0,class:"historic-indicator"},Re={class:"field"},We=u(()=>o("label",{for:"dba"},"DBA",-1)),je={class:"field"},Fe=u(()=>o("label",{for:"name"},"Contractor Name",-1)),He={class:"field"},Oe=u(()=>o("label",{for:"phone"},"Cell Phone",-1)),Te={class:"field"},Ye=u(()=>o("label",{for:"email"},"Email",-1)),qe={key:0,class:"error"},ze={class:"field"},Ge=u(()=>o("label",{for:"muni"},"Municipality",-1)),Je={class:"field"},Ke=u(()=>o("label",{for:"folio"},"Folio",-1)),Ze={class:"field"},Qe=u(()=>o("label",{for:"permit"},"Master Permit",-1)),Xe={class:"field"},eo=u(()=>o("label",{for:"processnum"},"mEProcess #",-1)),oo={key:0,class:"response span-2"},lo={class:"span-2 submit-row"},ao={__name:"PermitApp",setup(g){const m=l(!1),A=l(""),x=l(!1),C=l(!1);ue();const z=ye(),{procData:so,procReceive:E}=Pe(),{accountUsers:p}=Se(),$=ke(),L=l([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),G=l("me");T(()=>{const{width:t,isUltraWide:e,height:d,isLongScreen:c}=ge();return console.log(t,e),{width:t,isUltraWide:e,height:d,isLongScreen:c}});const s=re({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",phNumber:"",emails:"",muniProc:"",historic:Boolean,date:new Date}),v=l(""),R=l(""),J=l(!0),N=l(!1),f=l(""),y=l(""),_=l(""),M=l(""),P=l(""),h=l([]),r=l(""),U=l(!1);T(()=>{var t;U.value===!1&&((t=p.value[0])==null?void 0:t.secondary_status)==="I"?(console.log(U.value),alert("Your license is Inactive!")):U.value=!0}),de(()=>{W(),x.value=!0,localStorage.clear()});const K=Y(()=>{var t,e;return((t=p.value[0])==null?void 0:t.bphone)!==""&&(N.value=!0,_.value=p.value[0].bphone,console.log(_.value)),N.value===!0?_.value:(e=p.value[0])==null?void 0:e.bphone});ce(W,K,()=>{});async function W(){var t,e,d,c,i,b,S;h.value=await p.value[0],M.value=((t=h.value)==null?void 0:t.name)||"",P.value=((e=h.value)==null?void 0:e.email)||"",f.value=((d=h.value)==null?void 0:d.secondary_status)||"",console.log(f.value),y.value=((c=h.value)==null?void 0:c.dba)||"",r.value=(b=(i=z.$state.processinput[0])==null?void 0:i.procData)==null?void 0:b.address,console.log(r.value),_.value=(S=p.value[0])==null?void 0:S.bphone}me(async()=>{await he(N).toBe(!0)});const I=Y(()=>J.value?L.value[0]:""),{resNum:Z}=ne(),j=l(""),F=l(""),B=l(null),D=l(""),H=l(null),O=l("");async function Q(t){m.value=!0,H.value=null;try{const e=await fetch(t);B.value=await e.json(),C.value=B.value.body.isHistoric,D.value=B.value.body.MinimumPropertyInfos[0],s.muni=D.value.Municipality,s.folio=D.value.Strap,F.value=s.folio,O.value=F.value.substring(1,2),j.value=q(O)}catch(e){H.value=e.message}finally{m.value=!1}}async function X(){try{m.value=!0,setTimeout(()=>m.value=!1,1e3),R.value=v.value;const e=`https://6x2kydgvuahfitwvxkkfbybv6u0kbxgl.lambda-url.us-east-1.on.aws/?address=${r.value}`;await Q(e),Object.assign(s,{license:f.value,contractor:y.value,emails:P.value,muniProc:v.value,phNumber:_.value});const d=String(Z.value).substring(3,19),c=q(d).value+1;s.processNumber=G.value.concat(String(c)),s.muniProc=v.value,s.address=r.value,E(s)}catch(t){alert(t)}}function ee(){E(s)}function oe(){console.log(r.value),$.addSystem(s,I.value,j.value,v.value,R.value,r.value),console.log($)}return(t,e)=>{const d=ie,c=te,i=se,b=ae,S=le;return V(),k(_e,null,[x.value?(V(),pe(d,{key:0})):w("",!0),o("section",Ne,[o("div",Me,[Ue,n(c,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),options:L.value,optionLabel:"name",placeholder:"Select a permit type",class:"w-full permit-select"},null,8,["modelValue","options"]),o("form",{class:"grid-form",onSubmit:ve(ee,["prevent"])},[o("div",Ie,[Be,n(i,{id:"license",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),placeholder:"active / inactive"},null,8,["modelValue"])]),o("div",De,[Ae,n(i,{id:"processMuni",modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=a=>v.value=a),placeholder:"00000000"},null,8,["modelValue"])]),o("div",xe,[Ce,o("div",Ee,[n(i,{id:"addr",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value=a),placeholder:"123 SW 1st St"},null,8,["modelValue"]),n(b,{type:"button",icon:"pi pi-search",loading:m.value,onClick:X},null,8,["loading"])])]),o("div",$e,[C.value?(V(),k("span",Le,"Property is Historic")):w("",!0)]),o("div",Re,[We,n(i,{id:"dba",modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=a=>y.value=a),placeholder:"company alias"},null,8,["modelValue"])]),o("div",je,[Fe,n(i,{id:"name",modelValue:M.value,"onUpdate:modelValue":e[5]||(e[5]=a=>M.value=a),placeholder:"full name"},null,8,["modelValue"])]),o("div",He,[Oe,n(S,{id:"phone",modelValue:s.phNumber,"onUpdate:modelValue":e[6]||(e[6]=a=>s.phNumber=a),mask:"(999) 999-9999",placeholder:"(999) 999-9999"},null,8,["modelValue"])]),o("div",Te,[Ye,n(i,{id:"email",modelValue:P.value,"onUpdate:modelValue":e[7]||(e[7]=a=>P.value=a),invalid:t.invalid,placeholder:"you@example.com"},null,8,["modelValue","invalid"]),t.invalid?(V(),k("small",qe,"Email is required")):w("",!0)]),o("div",ze,[Ge,n(i,{id:"muni",modelValue:s.muni,"onUpdate:modelValue":e[8]||(e[8]=a=>s.muni=a),placeholder:"Miami Beach"},null,8,["modelValue"])]),o("div",Je,[Ke,n(i,{id:"folio",modelValue:s.folio,"onUpdate:modelValue":e[9]||(e[9]=a=>s.folio=a),placeholder:"00-0000-000-0000",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),o("div",Ze,[Qe,n(i,{id:"permit",modelValue:s.permit,"onUpdate:modelValue":e[10]||(e[10]=a=>s.permit=a),placeholder:"20000000"},null,8,["modelValue"])]),o("div",Xe,[eo,n(i,{id:"processnum",modelValue:s.processNumber,"onUpdate:modelValue":e[11]||(e[11]=a=>s.processNumber=a),placeholder:"auto-generated"},null,8,["modelValue"])]),A.value?(V(),k("p",oo,fe(A.value),1)):w("",!0),o("div",lo,[n(b,{label:"Submit",type:"submit",loading:m.value,severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:oe},null,8,["loading"])])],32)])])],64)}}},No=we(ao,[["__scopeId","data-v-b294e923"]]);export{No as default};
