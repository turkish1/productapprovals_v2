import{_ as Y}from"./FileSaver-CPcYBvdn.js";import{s as J}from"./index-CgEfvF57.js";import{s as K}from"./index-BqXp0dL1.js";import{s as Q}from"./index-CSoCiyjD.js";import{s as X}from"./index-BnQNQUKQ.js";import{a as $,u as ee}from"./useAxios-BImVvcar.js";import{r as n,q as te,a as E,_ as oe,u as se,w as L,n as ae,o as S,c as N,e as a,d as i,P as le,h as ne,t as re,m as ie,a1 as de,p as ce,i as ue}from"./index-DdN46Z8B.js";import{u as me}from"./accountsStore-C00sVbNF.js";import{u as pe}from"./permitapp-DgH6VAOQ.js";import{t as ge,a as fe}from"./index-DcvAG_JO.js";import"./index-DE1daec3.js";import"./index-Cg28PKgs.js";import"./index-BORtqw3A.js";const o=$.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),ve={getAddr(){return o.get("/folio")},postProcessnumber(e){return o.post("/process",e)},getLastProcess(){return o.get("/lastnumber")},getSlopeless(){return o.get("/slopeless")},getSlopemore(){return o.get("/slopemore")},getdeOne(){return o.get("/desupone")},getdeTwo(){return o.get("/desuptwo")},getdeThree(){return o.get("/desupthree")},getdeFour(){return o.get("/desupfour")},getZones23(){return o.get("/gableroofs23")},getNoa(){return o.get("/noa")},getSBS(){return o.get("/shinglesbs")},getSystemE(){return o.get("/systemtype")},getburMaterial(){return o.get("/burmaterial")},getnewburMaterial(){return o.get("/burmaterials")},getburSystem(){return o.get("/bursystem")},getPoly(){return o.get("/shinglepoly")},getSystemF(){return o.get("/systemtypef")},getdeGauge(){return o.get("/degauge")},getdeMaterial(){return o.get("/dematerial")},getdeMatMore(){return o.get("/dematerials")},getdeSize(){return o.get("/desize")},getdeFastener(){return o.get("/defastener")},getprimeBase(){return o.get("/primebase")},getPerimeter(){return o.get("/perimeter")},getNoas(){return o.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return o.get("/tilenoa")},getZones(){return o.get("/gablezones")},getLay(){return o.get("/underlaymentshingle")},getContractors(){return o.get("/contractors")},postAccount(e){return o.post("/accounts",e)},getAccount(){return o.get("/retriveaccounts")},getDripMaterials(){return o.get("/dripmaterials")}};function w(){const e=n(null),t=n(0);return ve.getLastProcess().then(d=>{e.value=d.data,e.value.forEach(s=>{console.log(s.processNumber),t.value=s.processNumber})}).catch(d=>{console.error("Error:",d)}),{resNum:e,lastNum:t}}function be(){const{resNum:e,lastNum:t}=w(),d=n(""),s=n(new Date().getFullYear()),g=n(6),b=n("me"),f=Array.from({length:10**g.value},(p,m)=>`${b.value}${s.value}${String(m).padStart(g.value,"0")}`),l=w();return console.log(l),d.value=f[0]+1,t.value!==0||(d.value=t.value+1),{pNum:d,lastNum:t,resNum:e,test:l}}const he=te("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(e){this.processinput.push({procData:e,completed:!1})}}});function ye(){const e=n("");let t=n([]);const d=he(),s=n("");let g="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:b,data:f}=ee(g,{method:"POST"},{immediate:!1});let l=E({});function p(m){console.log(m),l=m,b({data:m}),e.value="Form submitted successfully!",d.addData(l),console.log(l,"System added")}return{error:s,results:t,procReceive:p,responseMessage:e,procData:l,procStore:d}}n(1);const _e={setup(){const e=n(""),t=se(),d=n(),s=n(),g=n(),{procData:b,procReceive:f}=ye(),{accountUsers:l,getUser:p,addUser:m}=me();console.log(l._value[0]),L(()=>{});const x=n("me"),r=pe(),u=E({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),A=n(""),C=n(""),M=n(""),U=n(""),I=n("");ge(()=>{if(l._value[0].name==="")return t.push("/");A.value=l._value[0].name,C.value=l._value[0].email,M.value=l._value[0].phone,U.value=l._value[0].secondary_status,I.value=l._value[0].dba,console.log(l._value[0])});const k=n(!1);be();const{lastNum:y,resNum:B}=w();n(null);const h=n(""),P=n(""),F=async()=>{const v=n(u.address),q=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(v.value)}&to=200`,G=await fetch(q);k.value=!0;const V=await G.json();console.log(V),u.muni=V.MinimumPropertyInfos[0].Municipality,u.folio=V.MinimumPropertyInfos[0].Strap;let T=String(y.value);console.log(y.value.length,y.value,T);let Z=T.substring(2,13),H=fe(Z).value+1,W=String(H);u.processNumber=x.value.concat(W),console.log(u.processNumber),P.value=u.folio,h.value=P.value.substring(0,2),console.log(h.value),f(u),setTimeout(()=>{k.value=!1},2e3)},R=async()=>{generatePdf(),f(u)},D=n(),z=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),O=()=>{t.push("/roofsystem")};function j(v,_){v=u,_=D.value,v.length!==0&&(r.addSystem(v,_,h.value),console.log(v,_,h.value,"System added"))}return L(()=>{}),{onSubmit:R,accountUsers:l,getUser:p,email:C,dba:I,phone:M,contractor:A,licenseStatus:U,addUser:m,navigateNext:O,addItemAndClear:j,selectedApplication:D,type:z,resNum:B,...ae(u),responseMessage:e,lastNum:y,useLast:w,load:F,checkMB:h,checkV:P,content:d,canvas:s,doc:g}}},c=e=>(ce("data-v-a9e6f57e"),e=e(),ue(),e),Se={id:"content",ref:"permitapp",class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"220px"}},we={class:"md:w-2/3"},xe={class:"container"},Pe={class:"row"},Ve={class:"card flex flex-col gap-2"},Ne=c(()=>a("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Ae={class:"card flex justify-center"},Ce={class:"card flex flex-col gap-4"},Me={class:"flex flex-wrap gap-4"},Ue={class:"flex flex-col grow basis-0 gap-3"},Ie={class:"flex flex-col mt-3 grow basis-0 gap-3"},ke=c(()=>a("label",{for:"license"},"License Status",-1)),De=c(()=>a("label",{for:"addr"},"Property Address",-1)),Te={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Le={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ee=c(()=>a("label",{for:"dba"},"DBA ",-1)),Be={class:"flex flex-col mt-3 grow basis-0 gap-3"},Fe=c(()=>a("label",{for:"contractor"},"Contractor Name",-1)),Re={class:"flex flex-col mt-3 grow basis-0 gap-3"},ze=c(()=>a("label",{for:"phone"},"Cell Phone Number",-1)),Oe={class:"flex flex-col mt-3 grow basis-0 gap-3"},je=c(()=>a("label",{for:"Email"},"Email",-1)),qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ge=c(()=>a("label",{for:"muni"},"Municipality",-1)),Ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},He=c(()=>a("label",{for:"folio"},"Folio",-1)),We={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ye=c(()=>a("label",{for:"permit"},"Master Permit",-1)),Je={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ke=c(()=>a("label",{for:"processnum"},"mEProcess Number",-1)),Qe=c(()=>a("br",null,null,-1)),Xe={key:0};function $e(e,t,d,s,g,b){const f=X,l=Q,p=K,m=J,x=Y;return S(),N("div",Se,[a("div",we,[a("div",xe,[a("form",null,[a("div",Pe,[a("div",Ve,[Ne,a("div",Ae,[i(f,{modelValue:s.selectedApplication,"onUpdate:modelValue":t[0]||(t[0]=r=>s.selectedApplication=r),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),a("div",Ce,[a("div",Me,[a("form",{class:"w-3/4",onSubmit:t[12]||(t[12]=(...r)=>s.onSubmit&&s.onSubmit(...r))},[a("div",Ue,[a("div",Ie,[ke,i(l,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":t[1]||(t[1]=r=>s.licenseStatus=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),De,i(l,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":t[2]||(t[2]=r=>e.address=r),placeholder:"address"},null,8,["modelValue"]),e.loading?(S(),N("i",Te)):(S(),le(p,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:s.load,onInput:e.createHtml},null,8,["loading","onClick","onInput"]))]),a("div",Le,[Ee,i(l,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":t[3]||(t[3]=r=>s.dba=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Be,[Fe,i(l,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":t[4]||(t[4]=r=>s.contractor=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Re,[ze,i(m,{modelValue:s.phone,"onUpdate:modelValue":t[5]||(t[5]=r=>s.phone=r),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),a("div",Oe,[je,i(l,{modelValue:s.email,"onUpdate:modelValue":t[6]||(t[6]=r=>s.email=r),invalid:s.email===null},null,8,["modelValue","invalid"])]),a("div",qe,[Ge,i(l,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":t[7]||(t[7]=r=>e.muni=r),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),a("div",Ze,[He,i(l,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":t[8]||(t[8]=r=>e.folio=r),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",We,[Ye,i(l,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":t[9]||(t[9]=r=>e.permit=r),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),a("div",Je,[Ke,i(l,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":t[10]||(t[10]=r=>e.processNumber=r),type:"text",placeholder:"process number"},null,8,["modelValue"])]),Qe,i(p,{severity:"contrast",onClick:e.generatePdf},{default:ne(()=>[de("Generate PDF")]),_:1},8,["onClick"]),i(p,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:t[11]||(t[11]=r=>s.addItemAndClear(e.generatePdf,e.formData,s.selectedApplication))})],32),s.responseMessage?(S(),N("p",Xe,re(s.responseMessage),1)):ie("",!0),i(x)])])])])])])])],512)}const gt=oe(_e,[["render",$e],["__scopeId","data-v-a9e6f57e"]]);export{gt as default};
