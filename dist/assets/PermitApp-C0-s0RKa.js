import{_ as J}from"./Drop-CQarlpeg.js";import{s as K}from"./index-CFm_vGtK.js";import{s as Q}from"./index-BlnTrmP9.js";import{s as X}from"./index-BE0uYLvv.js";import{s as $}from"./index-gvH1i5GA.js";import{a as ee,u as te}from"./useAxios-B6-rxQy5.js";import{r as n,j as oe,a as B,_ as se,u as ae,t as le,o as P,c as A,e as a,d as i,N as ne,h as re,q as ie,v as de,$ as ce,p as ue,i as me}from"./index-C1cXTTxg.js";import{u as pe}from"./accountsStore-DpJNtO5e.js";import{u as ge}from"./permitapp-CYeeHHNB.js";import{h as fe,E as be}from"./jspdf.es.min-Dce1sIpr.js";import{t as ve,a as he}from"./index-CkZmHb6w.js";import"./index-pXNEA63j.js";import"./index-B3LcLxqr.js";import"./index-Bv3DZ5dC.js";import"./index-_4CajcGH.js";import"./index-vGHOma5Z.js";import"./index-R75rnpNi.js";const s=ee.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),ye={getAddr(){return s.get("/folio")},postProcessnumber(t){return s.post("/process",t)},getLastProcess(){return s.get("/lastnumber")},getSlopeless(){return s.get("/slopeless")},getSlopemore(){return s.get("/slopemore")},getdeOne(){return s.get("/desupone")},getdeTwo(){return s.get("/desuptwo")},getdeThree(){return s.get("/desupthree")},getdeFour(){return s.get("/desupfour")},getZones23(){return s.get("/gableroofs23")},getNoa(){return s.get("/noa")},getSBS(){return s.get("/shinglesbs")},getSystemE(){return s.get("/systemtype")},getburMaterial(){return s.get("/burmaterial")},getnewburMaterial(){return s.get("/burmaterials")},getburSystem(){return s.get("/bursystem")},getPoly(){return s.get("/shinglepoly")},getSystemF(){return s.get("/systemtypef")},getdeGauge(){return s.get("/degauge")},getdeMaterial(){return s.get("/dematerial")},getdeMatMore(){return s.get("/dematerials")},getdeSize(){return s.get("/desize")},getdeFastener(){return s.get("/defastener")},getprimeBase(){return s.get("/primebase")},getPerimeter(){return s.get("/perimeter")},getNoas(){return s.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return s.get("/tilenoa")},getZones(){return s.get("/gablezones")},getLay(){return s.get("/underlaymentshingle")},getContractors(){return s.get("/contractors")},postAccount(t){return s.post("/accounts",t)},getAccount(){return s.get("/retriveaccounts")},getDripMaterials(){return s.get("/dripmaterials")}};function V(){const t=n(null),e=n(0);return ye.getLastProcess().then(d=>{t.value=d.data,t.value.forEach(o=>{console.log(o.processNumber),e.value=o.processNumber})}).catch(d=>{console.error("Error:",d)}),{resNum:t,lastNum:e}}function _e(){const{resNum:t,lastNum:e}=V(),d=n(""),o=n(new Date().getFullYear()),b=n(6),y=n("me"),v=Array.from({length:10**b.value},(f,g)=>`${y.value}${o.value}${String(g).padStart(b.value,"0")}`),l=V();return console.log(l),d.value=v[0]+1,e.value!==0||(d.value=e.value+1),{pNum:d,lastNum:e,resNum:t,test:l}}const Se=oe("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(t){this.processinput.push({procData:t,completed:!1})}}});function we(){const t=n("");let e=n([]);const d=Se(),o=n("");let b="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:y,data:v}=te(b,{method:"POST"},{immediate:!1});let l=B({});function f(g){console.log(g),l=g,y({data:g}),t.value="Form submitted successfully!",d.addData(l),console.log(l,"System added")}return{error:o,results:e,procReceive:f,responseMessage:t,procData:l,procStore:d}}n(1);const xe={setup(){const t=n(""),e=ae(),d=n(),o=n(),b=n(),{procData:y,procReceive:v}=we(),{accountUsers:l,getUser:f,addUser:g}=pe();console.log(l._value[0]);const N=n("me"),r=ge(),m=B({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),C=n(""),M=n(""),I=n(""),k=n(""),D=n("");ve(()=>{if(l._value[0].name==="")return e.push("/");C.value=l._value[0].name,M.value=l._value[0].email,I.value=l._value[0].phone,k.value=l._value[0].secondary_status,D.value=l._value[0].dba,console.log(l._value[0])});const L=n(!1);_e();const{lastNum:w,resNum:F}=V();n(null);const _=n(""),U=n(""),O=async()=>{const p=n(m.address),h=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(p.value)}&to=200`,x=await fetch(h);L.value=!0;const S=await x.json();console.log(S),m.muni=S.MinimumPropertyInfos[0].Municipality,m.folio=S.MinimumPropertyInfos[0].Strap;let R=String(w.value);console.log(w.value.length,w.value,R);let H=R.substring(2,13),W=he(H).value+1,Y=String(W);m.processNumber=N.value.concat(Y),console.log(m.processNumber),U.value=m.folio,_.value=U.value.substring(0,2),console.log(_.value),v(m),setTimeout(()=>{L.value=!1},2e3)},j=async()=>{v(m)},E=n(),z=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),G=()=>{e.push("/roofsystem")};function q(p,u){p=m,u=E.value,p.length!==0&&(r.addSystem(p,u,_.value),console.log(p,u,_.value,"System added"))}const Z=async()=>{const p=document.getElementById("content"),h=(await fe(p)).toDataURL("image/png"),x=new be;x.addImage(h,"PNG",10,10,190,0);const S=x.output("blob");T(S)},T=async p=>{const u=document.createElement("a"),h=URL.createObjectURL(p);u.href=h,u.download="generated.pdf",document.body.appendChild(u),u.click(),setTimeout(()=>{document.body.removeChild(u),URL.revokeObjectURL(h)},100)};return{savePdfBlobSilently:T,generatePdf:Z,onSubmit:j,accountUsers:l,getUser:f,email:M,dba:D,phone:I,contractor:C,licenseStatus:k,addUser:g,navigateNext:G,addItemAndClear:q,selectedApplication:E,type:z,resNum:F,...le(m),responseMessage:t,lastNum:w,useLast:V,load:O,checkMB:_,checkV:U,content:d,canvas:o,doc:b}}},c=t=>(ue("data-v-897525b6"),t=t(),me(),t),Pe={id:"content",ref:"permitapp",class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"220px"}},Ve={class:"md:w-2/3"},Ne={class:"container"},Ue={class:"row"},Ae={class:"card flex flex-col gap-2"},Ce=c(()=>a("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Me={class:"card flex justify-center"},Ie={class:"card flex flex-col gap-4"},ke={class:"flex flex-wrap gap-4"},De={class:"flex flex-col grow basis-0 gap-3"},Le={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ee=c(()=>a("label",{for:"license"},"License Status",-1)),Te=c(()=>a("label",{for:"addr"},"Property Address",-1)),Re={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Be={class:"flex flex-col mt-3 grow basis-0 gap-3"},Fe=c(()=>a("label",{for:"dba"},"DBA ",-1)),Oe={class:"flex flex-col mt-3 grow basis-0 gap-3"},je=c(()=>a("label",{for:"contractor"},"Contractor Name",-1)),ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ge=c(()=>a("label",{for:"phone"},"Cell Phone Number",-1)),qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ze=c(()=>a("label",{for:"Email"},"Email",-1)),He={class:"flex flex-col mt-3 grow basis-0 gap-3"},We=c(()=>a("label",{for:"muni"},"Municipality",-1)),Ye={class:"flex flex-col mt-3 grow basis-0 gap-3"},Je=c(()=>a("label",{for:"folio"},"Folio",-1)),Ke={class:"flex flex-col mt-3 grow basis-0 gap-3"},Qe=c(()=>a("label",{for:"permit"},"Master Permit",-1)),Xe={class:"flex flex-col mt-3 grow basis-0 gap-3"},$e=c(()=>a("label",{for:"processnum"},"mEProcess Number",-1)),et=c(()=>a("br",null,null,-1)),tt={key:0};function ot(t,e,d,o,b,y){const v=$,l=X,f=Q,g=K,N=J;return P(),A("div",Pe,[a("div",Ve,[a("div",Ne,[a("form",null,[a("div",Ue,[a("div",Ae,[Ce,a("div",Me,[i(v,{modelValue:o.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=r=>o.selectedApplication=r),options:o.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),a("div",Ie,[a("div",ke,[a("form",{class:"w-3/4",onSubmit:e[12]||(e[12]=(...r)=>o.onSubmit&&o.onSubmit(...r))},[a("div",De,[a("div",Le,[Ee,i(l,{id:"license",modelValue:o.licenseStatus,"onUpdate:modelValue":e[1]||(e[1]=r=>o.licenseStatus=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),Te,i(l,{id:"addr",type:"text",modelValue:t.address,"onUpdate:modelValue":e[2]||(e[2]=r=>t.address=r),placeholder:"address"},null,8,["modelValue"]),t.loading?(P(),A("i",Re)):(P(),ne(f,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:t.loading,onClick:o.load,onInput:t.createHtml},null,8,["loading","onClick","onInput"]))]),a("div",Be,[Fe,i(l,{id:"dba",modelValue:o.dba,"onUpdate:modelValue":e[3]||(e[3]=r=>o.dba=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Oe,[je,i(l,{id:"contractor",modelValue:o.contractor,"onUpdate:modelValue":e[4]||(e[4]=r=>o.contractor=r),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",ze,[Ge,i(g,{modelValue:o.phone,"onUpdate:modelValue":e[5]||(e[5]=r=>o.phone=r),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:o.phone===""},null,8,["modelValue","invalid"])]),a("div",qe,[Ze,i(l,{modelValue:o.email,"onUpdate:modelValue":e[6]||(e[6]=r=>o.email=r),invalid:o.email===null},null,8,["modelValue","invalid"])]),a("div",He,[We,i(l,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[7]||(e[7]=r=>t.muni=r),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),a("div",Ye,[Je,i(l,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[8]||(e[8]=r=>t.folio=r),type:"text",placeholder:"folio",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",Ke,[Qe,i(l,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[9]||(e[9]=r=>t.permit=r),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),a("div",Xe,[$e,i(l,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[10]||(e[10]=r=>t.processNumber=r),type:"text",placeholder:"process number"},null,8,["modelValue"])]),et,i(f,{severity:"contrast",onClick:o.generatePdf},{default:re(()=>[ce("Generate PDF")]),_:1},8,["onClick"]),i(f,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:e[11]||(e[11]=r=>o.addItemAndClear(t.formData,o.selectedApplication,o.generatePdf))})],32),o.responseMessage?(P(),A("p",tt,ie(o.responseMessage),1)):de("",!0),i(N)])])])])])])])],512)}const St=se(xe,[["render",ot],["__scopeId","data-v-897525b6"]]);export{St as default};
