import{u as Oe}from"./accountsStore-jgEbLTJx.js";import{u as Ze}from"./generalpageStore-BwbFHXYP.js";import{u as qe}from"./permitapp-8a1JWUNH.js";import{u as Ke}from"./roofList-BTOnwzzj.js";import{E as Qe}from"./jspdf.es.min-CnbpdItn.js";import{r as o,a7 as Le,as as _e,at as et,b as tt,c as ot}from"./index-JsRo9p0A.js";const dt={__name:"Generalpagepdf",setup(at){var P,w,G,V,I,z,R,E,N,X,Y;const{getUser:me}=Oe();let b=o(!1);const u=qe();Ke();const s=Ze(),xe=o(((w=(P=u.$state.permitapp[0])==null?void 0:P.formdt)==null?void 0:w.address)||""),Te=o(((V=(G=u.$state.permitapp[0])==null?void 0:G.formdt)==null?void 0:V.permit)||""),$e=o(((z=(I=u.$state.permitapp[0])==null?void 0:I.formdt)==null?void 0:z.processNumber)||""),$=o(((E=(R=u.$state.permitapp[0])==null?void 0:R.formdt)==null?void 0:E.muniProcess)||""),ke=o(((X=(N=u.$state.permitapp[0])==null?void 0:N.formdt)==null?void 0:X.muni)||""),De=o(((Y=me.value[0])==null?void 0:Y.dba)||""),Se=o(""),Ce=o(s.$state.generalpdfinput);function We(){Ce.value.length!==1&&(b.value=!0)}Le(()=>{We(),B()}),_e(async()=>{await et(b).toBe(!0),B()});const B=()=>{var A,M,J,U,j,y;if(s.$state.generalpdfinput.length===0)console.log("lenghth is   zero");else{const e=new Qe({orientation:"portrait",unit:"mm",format:"a4",compress:!0});e.setGState(new e.GState({opacity:.9}));const H="Approved";e.setFontSize(24),e.setTextColor("black"),e.setFont("helvetica"),e.text("mEPermits",25,250,{angle:45,align:"left",baseline:"bottom",renderingMode:"fill"});const O=new Image,Z=new Image,q=new Image;O.src="/demo/images/officepaper.jpeg",Z.src="/demo/images/logo.jpeg",q.src="/demo/images/DragAndDrop.jpeg";const Be=725,K=e.getPageInfo(1),Pe=K.pageContext.mediaBox.topRightX,we=K.pageContext.mediaBox.topRightY;console.log(Pe);const t=o(0),Q=o(0);var c=595.28-585.28,a=we-Be;t.value=c,Q.value=a,console.log(t.value,Q.value),e.addImage(Z,"JPEG",10,10,50,30),e.addImage(O,"JPEG",0,0,210,297),e.setFontSize(12),e.setTextColor("green");var Fe=new Date,be=Fe.toLocaleDateString();e.text(H,10,270,{align:"left"});const Ge=e.getTextWidth(H);e.text("on: "+be,Ge+15,270),e.text(`${$.value}`,10,280,{align:"left"});const Ve=e.getTextWidth(`${$.value}`);e.text(`${ke.value}`,Ve+15,280);const L=o(!1),_=o(!1),ee=o(!1),te=o(!1),oe=o(!1);e.setFontSize(12);const Ie=()=>{e.setFontSize(10),e.setTextColor(0),e.text("2023 HVHZ  mEPermit General Information Page",70,20,{maxWidth:"170"}),e.line(10,41,195,41)};e.setTextColor(0),e.circle(185,38,2,"FD"),e.text("I agree",165,39),Ie(),e.setFontSize(12),e.setFontSize(10);const ze=[{category:"DBA",value:`${De.value}`},{category:"Job Address",value:`${xe.value}`},{category:"meProcess Number",value:`${$e.value}`},{category:"Master Permit",value:`${Te.value}`}];let Re=10,k=60,Ee=50;e.setFontSize(10),ze.forEach((i,F)=>{const r=Ee+F*10;e.text(i.category,Re,r),e.text(i.value,k,r),e.getTextWidth(i.category);const x=e.getTextWidth(i.value)*2;e.line(k,r+2,k+x,r+2)}),e.setTextColor("black"),e.setFontSize(10);const l=100,D=o(!1),ae=o(!1);console.log(s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]),s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]==="reroof"?(D.value=!0,console.log(D.value)):ae.value=!0,t.value=c+70,a=l-15,console.log(a),e.text("Re-Roof: ",t.value,a);const d=a-3,S=D.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);t.value=c+120,a=l-15,console.log(a),e.text("New Roof: ",t.value,a);const C=ae.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);console.log(S,C);const le="Total: ",se="Low Slope: ",ne="Steep Slope: ",ce=o(((M=(A=s.$state.generalpdfinput[0])==null?void 0:A.generalpdfData)==null?void 0:M.totalData)||""),re=o(((U=(J=s.$state.generalpdfinput[0])==null?void 0:J.generalpdfData)==null?void 0:U.slopeData)||""),ie=o(((y=(j=s.$state.generalpdfinput[0])==null?void 0:j.generalpdfData)==null?void 0:y.steepData)||"");console.log(s.$state.generalpdfinput[0].generalpdfData),t.value=c+25;const Ne=e.getTextWidth(se),ue=e.getTextWidth(`${re.value}`),pe=t.value+2;e.text(se,pe,l);const g=Ne+pe;e.text(`${re.value}`,g,l),e.line(g,l,g+ue,l),t.value=g+ue;const Xe=e.getTextWidth(ne),de=e.getTextWidth(`${ie.value}`),ge=t.value+2;e.text(ne,ge,l);const v=Xe+ge;e.text(`${ie.value}`,v,l),e.line(v,l,v+de,l),console.log(l,a),a=l+10,t.value=v+de,console.log(t.value);const Ye=e.getTextWidth(le),ve=e.getTextWidth(`${ce.value}`),fe=t.value+2;e.text(le,fe,l);const f=Ye+fe;e.text(`${ce.value}`,f,l),e.line(f,l,f+ve,l),t.value=f+ve,console.log(s.$state.generalpdfinput[0]),s.$state.generalpdfinput[0].generalpdfData.slopeChk===!0&&(oe.value=!0,console.log("Slope Checked")),s.$state.generalpdfinput[0].generalpdfData.adtileChk===!0&&(L.value=!0),s.$state.generalpdfinput[0].generalpdfData.metalChk===!0&&(_.value=!0),s.$state.generalpdfinput[0].generalpdfData.mtileChk===!0&&(ee.value=!0),s.$state.generalpdfinput[0].generalpdfData.shingleChk===!0&&(te.value=!0,console.log("Shingle Checked")),t.value=c,console.log(t.value),e.text("Low Slope: ",c,a);const n=a-3,Ae=oe.value===!0?e.rect(t.value+20,n,4,4,"FD"):e.rect(t.value+20,n,4,4);console.log(S,C,Ae),t.value=t.value+10,console.log(t.value);const h=t.value+18;console.log(t.value),e.text("Adhesive Set Tile: ",h,a);const Me=L.value===!0?e.rect(h+30,n,4,4,"FD"):e.rect(h+30,n,4,4);console.log(S,C,Me),console.log(t.value);const m=h+40;console.log(t.value),e.text("Metal Panel: ",m,a);const Je=_.value===!0?e.rect(m+25,n,4,4,"FD"):e.rect(m+25,n,4,4);t.value=m+10;const p=t.value+25;console.log(t.value),e.text("Shingle: ",p,a);const Ue=te.value===!0?e.rect(p+15,n,4,4,"FD"):e.rect(p+15,n,4,4);t.value=p;const W=p+35;console.log(t.value),e.text("Mechanical Fastened Tile: ",W,a);const je=ee.value===!0?e.rect(W+45,n,4,4,"FD"):e.rect(W+45,n,4,4);console.log(je,Ue,Je),a=a+10,e.addImage(q,"JPEG",c+40,a,120,120);const ye="GeneralPage.pdf",He=e.output("blob");(async(i,F)=>{const r=i,x=r;console.log(x);const he=`https://dsr-pdfupload.s3.us-east-1.amazonaws.com/${$.value}/${x}`;try{const T=await fetch(he,{method:"PUT",headers:{"Content-Type":r.type},body:F});T.ok?(Se.value=he,alert("File uploaded successfully!")):alert(`Failed to upload file. Status: ${T.status}`)}catch(T){console.error("Error uploading file:",T),alert("An error occurred while uploading the file.")}})(ye,He)}};return(c,a)=>(tt(),ot("div"))}};export{dt as default};
