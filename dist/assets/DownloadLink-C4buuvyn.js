import{s as M}from"./index-1KPC7BgF.js";import{e as o,H as j,h as G,g as S,ac as H,Z as x,ad as B,ae as I,o as V,c as C,j as L,i as n,K,ai as Y,t as O,d as Z,af as q}from"./index-Dr66IyCx.js";import{c as A,u as J,b as Q,a as W}from"./countStore-Couz5srU.js";import{u as X}from"./permitapp-CMK2x7OR.js";import"./index-Dp_RpEFz.js";import"./useAxios-T-UJnv2d.js";const ee={class:"card-system"},oe={class:"flex flex-col w-1/3 gap-2 shadow-lg shadow-cyan-800",style:{"margin-left":"550px","margin-top":"440px"}},se={class:"payment-widget"},te=n("h2",{style:{color:"black"}},"Download Link",-1),ae={key:0,class:"confirmation"},me={__name:"DownloadLink",setup(ne){var g,y;const P=X(),i=A(),u=o(0),d=o(((y=(g=P.$state.permitapp[0])==null?void 0:g.formdt)==null?void 0:y.muniProc)||""),{secondFetch:m}=J(d.value),T=o(!1),l=o(!1),U=o(!1),R=o(!1),p=o(!1);o(null);const r=Q();j(r.$state);const{resp:f}=W(),$=G();S(()=>{var e,s;u.value=1,i.addCount(u),console.log(i),((s=(e=f.value)==null?void 0:e.status)==null?void 0:s.status)===200&&(U.value=!0,console.log(f.value.status.status))});const v=o("");S(async()=>{const e=new URLSearchParams(location.search).get("session_id");if(v.value=e,e)console.log(v.value);else{console.log(e);return}});const c=H("my-storage",{processNumber:d.value}),z=x(()=>{l.value=!0});B(z,()=>{});function w(){m(c.value.processNumber),_()}const h=x(()=>{setTimeout(()=>{R.value=!0},1e3),m(c.value.processNumber),_()}),E=()=>{$.push("/")},_=async()=>{var k,b,D,N;const e=(b=(k=r.downloadinput[0])==null?void 0:k.downloadData)==null?void 0:b.download_url;if(console.log(e),!e||e.length===0)return;console.log(e,c.value);const s=(N=(D=r.downloadinput[0])==null?void 0:D.downloadData)==null?void 0:N.download_url;if(!s)return;T.value=!0;const t=s,F="processnumber.zip",a=document.createElement("a");a.href=t,a.download=F,a.click(),a.remove(),l.value=!0,p.value=!0};return B(h,w,()=>{}),I(async()=>{await q(h).toBe(!0)}),(e,s)=>{const t=M;return V(),C("div",ee,[L(t,{icon:"pi pi-home",severity:"info",style:{"font-size":"2rem"},onClick:E}),n("div",oe,[n("div",se,[te,K(L(t,{icon:"pi pi-arrow-circle-down",severity:"info","aria-label":"User",onClick:w},null,512),[[Y,l.value]])]),p.value?(V(),C("div",ae,[n("p",null,"Thank you, "+O(e.Name)+"! Your payment of $"+O(107)+" was processed.",1)])):Z("",!0)])])}}};export{me as default};
