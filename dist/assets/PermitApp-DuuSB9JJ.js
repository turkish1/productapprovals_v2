import{_ as M,a as x,r as n,o as v,c as b,d as r,m as N,F as B,O,k as V,l as k,g as $,u as q,t as Z,b as m,L as j,p as W,f as G}from"./index-D8AeRGIs.js";import{s as H}from"./index-CNfqd3lu.js";import{s as Y}from"./index-Bk3I5XM1.js";import{s as J}from"./index-EMMbDPyx.js";import{s as K}from"./index-DymnoUFi.js";import{a as Q,u as X}from"./useAxios-j4DdiOzx.js";import{u as ee}from"./permitapp-N7RP7OnI.js";import{a as te}from"./index-pTFVORWx.js";import"./index-NogheU0E.js";import"./index-DxrI2Y4C.js";const oe={class:"bg-clip-content p-6 bg-gray w-2/3 border-4 border-midnight border-dashed"},se={key:0},re={class:"file-previews"},ae=["src"],le={__name:"DropZone",setup(e){const t=x([]),u=n(null),a=()=>{},f=()=>{},h=i=>{const c=i.dataTransfer.files;l(c)},d=i=>{const c=i.target.files;l(c)},l=i=>{Array.from(i).forEach(c=>{const s=new FileReader;s.onload=_=>{c.preview=_.target.result,t.push(c)},p(c)?s.readAsDataURL(c):t.push(c)})},p=i=>i.type.startsWith("image/");return(i,c)=>(v(),b("div",oe,[r("div",{class:"file-drop-zone",onDragover:V(a,["prevent"]),onDrop:V(h,["prevent"]),onDragleave:V(f,["prevent"])},[t.length?N("",!0):(v(),b("p",se,"Drag and drop files here, or click to select files")),r("input",{type:"file",multiple:"",onChange:d,ref_key:"fileInput",ref:u,style:{display:"none"}},null,544),r("div",re,[(v(!0),b(B,null,O(t,(s,_)=>(v(),b("div",{key:_,class:"file-preview"},[p(s)?(v(),b("img",{key:0,src:s.preview,alt:"File preview"},null,8,ae)):N("",!0),r("p",null,k(s.name),1)]))),128))])],32)]))}},ne=M(le,[["__scopeId","data-v-987cb64c"]]),o=Q.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),ie={getAddr(){return o.get("/folio")},postProcessnumber(e){return o.post("/process",e)},getLastProcess(){return o.get("/lastnumber")},getSlopeless(){return o.get("/slopeless")},getSlopemore(){return o.get("/slopemore")},getdeOne(){return o.get("/desupone")},getdeTwo(){return o.get("/desuptwo")},getdeThree(){return o.get("/desupthree")},getdeFour(){return o.get("/desupfour")},getZones23(){return o.get("/gableroofs23")},getNoa(){return o.get("/noa")},getSBS(){return o.get("/shinglesbs")},getSystemE(){return o.get("/systemtype")},getburMaterial(){return o.get("/burmaterial")},getnewburMaterial(){return o.get("/burmaterials")},getburSystem(){return o.get("/bursystem")},getPoly(){return o.get("/shinglepoly")},getSystemF(){return o.get("/systemtypef")},getdeGauge(){return o.get("/degauge")},getdeMaterial(){return o.get("/dematerial")},getdeMatMore(){return o.get("/dematerials")},getdeSize(){return o.get("/desize")},getdeFastener(){return o.get("/defastener")},getprimeBase(){return o.get("/primebase")},getPerimeter(){return o.get("/perimeter")},getNoas(){return o.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return o.get("/tilenoa")},getZones(){return o.get("/gablezones")},getLay(){return o.get("/underlaymentshingle")},getContractors(){return o.get("/contractors")},postAccount(e){return o.post("/accounts",e)},getAccount(){return o.get("/retriveaccounts")},getDripMaterials(){return o.get("/dripmaterials")}};function S(){const e=n(null),t=n(0);return ie.getLastProcess().then(u=>{e.value=u.data,e.value.forEach(a=>{console.log(a.processNumber),t.value=a.processNumber})}).catch(u=>{console.error("Error:",u)}),{resNum:e,lastNum:t}}function de(){const{resNum:e,lastNum:t}=S(),u=n(""),a=n(new Date().getFullYear()),f=n(6),h=n("me"),d=Array.from({length:10**f.value},(p,i)=>`${h.value}${a.value}${String(i).padStart(f.value,"0")}`),l=S();return console.log(l),u.value=d[0]+1,t.value!==0?console.log("entered lastNum equal null",t.value):(console.log("entered lastNum equal a number",t.value),u.value=t.value+1),console.log(u.value,t.value,l),{pNum:u,lastNum:t,resNum:e,test:l}}const ce=$("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(e){this.processinput.push({procData:e,completed:!1})}}});function ue(){const e=n("");let t=n([]);const u=ce(),a=n("");let f="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:h,data:d}=X(f,{method:"POST"},{immediate:!1});let l=x({});function p(i){console.log(i),l=i,h({data:i}),e.value="Form submitted successfully!",u.addData(l),console.log(l,"System added")}return{error:a,results:t,procReceive:p,responseMessage:e,procData:l,procStore:u}}n(1);const pe={setup(){const e=n(""),t=q(),{procData:u,procReceive:a}=ue(),f=n("me"),h=ee(),d=x({address:"",muni:"",folio:"",contractor:"",permit:"",processNumber:"",phone:"",email:"",date:new Date}),l=n(!1);de();const{lastNum:p,resNum:i}=S(),c=n(""),s=n(""),_=async()=>{const y=n(d.address),L=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(y.value)}&to=200`,T=await fetch(L);l.value=!0;const P=await T.json();console.log(P),d.muni=P.MinimumPropertyInfos[0].Municipality,d.folio=P.MinimumPropertyInfos[0].Strap;let D=String(p.value);console.log(p.value.length,p.value,D);let E=D.substring(2,13),R=te(E).value+1,z=String(R);d.processNumber=f.value.concat(z),console.log(d.processNumber),s.value=d.folio,c.value=s.value.substring(0,2),console.log(c.value),a(d),setTimeout(()=>{l.value=!1},2e3)},C=async()=>{a(d)},A=n(),I=n([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),F=()=>{t.push("/generalpage")};function U(y,w){y=d,w=A.value,y.length!==0&&(h.addSystem(y,w),console.log(y,w,"System added"))}return{onSubmit:C,navigateNext:F,addItemAndClear:U,selectedApplication:A,type:I,resNum:i,...Z(d),responseMessage:e,lastNum:p,useLast:S,load:_,checkMB:c,checkV:s}}},g=e=>(W("data-v-8ed4b913"),e=e(),G(),e),me={class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"320px"}},ge={class:"md:w-2/3"},fe={class:"container"},ve={class:"row"},he={class:"card flex flex-col gap-2"},be=g(()=>r("div",{class:"font-semibold text-xl"},"Permit Application",-1)),ye={class:"card flex justify-center"},_e={class:"card flex flex-col gap-4"},we={class:"flex flex-wrap gap-4"},Se={class:"flex flex-col grow basis-0 gap-3"},Pe=g(()=>r("label",{for:"addr"},"Property Address",-1)),Ve={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Ne={class:"flex flex-col mt-3 grow basis-0 gap-3"},xe=g(()=>r("label",{for:"contractor"},"Contractor Name",-1)),Ae={class:"flex flex-col mt-3 grow basis-0 gap-3"},De=g(()=>r("label",{for:"phone"},"Cell Phone Number",-1)),Me={class:"flex flex-col mt-3 grow basis-0 gap-3"},ke=g(()=>r("label",{for:"Email"},"Email",-1)),Ce={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ie=g(()=>r("label",{for:"muni"},"Municipality",-1)),Fe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ue=g(()=>r("label",{for:"folio"},"Folio",-1)),Le={class:"flex flex-col mt-3 grow basis-0 gap-3"},Te=g(()=>r("label",{for:"permit"},"Master Permit",-1)),Ee={class:"flex flex-col mt-3 grow basis-0 gap-3"},Re=g(()=>r("label",{for:"processnum"},"mEProcess Number",-1)),ze=g(()=>r("br",null,null,-1)),Be={key:0};function Oe(e,t,u,a,f,h){const d=K,l=J,p=Y,i=H,c=ne;return v(),b("div",me,[r("div",ge,[r("div",fe,[r("form",null,[r("div",ve,[r("div",he,[be,r("div",ye,[m(d,{modelValue:a.selectedApplication,"onUpdate:modelValue":t[0]||(t[0]=s=>a.selectedApplication=s),options:a.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),r("div",_e,[r("div",we,[r("form",{class:"w-3/4",onSubmit:t[10]||(t[10]=(...s)=>a.onSubmit&&a.onSubmit(...s))},[r("div",Se,[Pe,m(l,{id:"addr",type:"text",modelValue:e.address,"onUpdate:modelValue":t[1]||(t[1]=s=>e.address=s),placeholder:"address"},null,8,["modelValue"]),e.loading?(v(),b("i",Ve)):(v(),j(p,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:e.loading,onClick:a.load},null,8,["loading","onClick"]))]),r("div",Ne,[xe,m(l,{id:"zip",modelValue:e.contractor,"onUpdate:modelValue":t[2]||(t[2]=s=>e.contractor=s),type:"text",placeholder:"name"},null,8,["modelValue"])]),r("div",Ae,[De,m(i,{modelValue:e.phone,"onUpdate:modelValue":t[3]||(t[3]=s=>e.phone=s),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:e.phone===""},null,8,["modelValue","invalid"])]),r("div",Me,[ke,m(l,{modelValue:e.email,"onUpdate:modelValue":t[4]||(t[4]=s=>e.email=s),invalid:e.email===null},null,8,["modelValue","invalid"])]),r("div",Ce,[Ie,m(l,{id:"muni",modelValue:e.muni,"onUpdate:modelValue":t[5]||(t[5]=s=>e.muni=s),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),r("div",Fe,[Ue,m(l,{id:"folio",modelValue:e.folio,"onUpdate:modelValue":t[6]||(t[6]=s=>e.folio=s),type:"text",placeholder:"folio",onInput:e.updatemEProcess},null,8,["modelValue","onInput"])]),r("div",Le,[Te,m(l,{id:"permit",modelValue:e.permit,"onUpdate:modelValue":t[7]||(t[7]=s=>e.permit=s),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),r("div",Ee,[Re,m(l,{id:"processnum",modelValue:e.processNumber,"onUpdate:modelValue":t[8]||(t[8]=s=>e.processNumber=s),type:"text",placeholder:"process number"},null,8,["modelValue"])]),ze,m(p,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/generalpage",onClick:t[9]||(t[9]=s=>a.addItemAndClear(e.formData,a.selectedApplication))})],32),a.responseMessage?(v(),b("p",Be,k(a.responseMessage),1)):N("",!0)])])])])]),m(c)])])])}const Xe=M(pe,[["render",Oe],["__scopeId","data-v-8ed4b913"]]);export{Xe as default};
