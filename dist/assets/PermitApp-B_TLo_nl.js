import{s as se}from"./index-CTd_ljr3.js";import{s as le}from"./index-CWYbw1RK.js";import{s as te}from"./index-BTWWFby1.js";import{s as ne}from"./index-HicS1qql.js";import{u as ie,a as re,_ as ue}from"./use-createProcessnumber-BksLTDOs.js";import{e as t,f as x,h as ce,g as W,Z as de,I as $,ad as me,ae as pe,aC as ve,aw as fe,o as V,c as k,a as he,d as I,i as a,j as i,J as be,t as _e,F as ye,af as Ve,Y as q,p as ge,q as Pe}from"./index-DKVSdg1j.js";import{u as Se,a as we}from"./useAxios-DrqbPnrz.js";import{u as ke}from"./useScreenSize-DFxpe_Lc.js";import{u as Ie}from"./accountsStore-Be9WD2n6.js";import{u as Ue}from"./permitapp-jOTQvmn0.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CT1CVUKW.js";import"./index-C9xIShlR.js";import"./index-Bmu6IduS.js";import"./index-DGTb9GdE.js";import"./index-D0J4_w7N.js";import"./index-CBGjd_J8.js";import"./index-DO4r6JvV.js";import"./index-DrlnFe7b.js";import"./processStore-DpJEkr2J.js";const Ne="https://mg7y3qizyjvkkwd7ynpoc2r2yi0gerzh.lambda-url.us-east-1.on.aws/";function Me(){const d=t(!1),p=t(null),h=t(null),{data:g,error:b,isFetching:P,execute:U}=Se(Ne,{method:"POST",headers:{"Content-Type":"application/json"}},we,{immediate:!1});return{data:g,errors:p,isFetching:P,loading:d,callPermitdata:async v=>{h.value=v,d.value=!0,b.value=null;try{return await U({data:h.value})}catch(S){b.value=S.massage,console.error("Lambda post failed:",S)}finally{d.value=!1}}}}const u=d=>(ge("data-v-c1fc7b58"),d=d(),Pe(),d),Ae={class:"hero"},xe={class:"card"},De=u(()=>a("h1",{class:"title"},"Permit Application",-1)),je={class:"field"},Ce=u(()=>a("label",{for:"license"},"License Status",-1)),Fe={class:"field"},Le=u(()=>a("label",{for:"processMuni"},"Municipality Process #",-1)),Oe={class:"field"},Ee=u(()=>a("label",{for:"addr"},"Property Address",-1)),Re={class:"input-row"},Te={class:"field"},We={key:0,class:"historic-indicator"},$e={class:"field"},qe=u(()=>a("label",{for:"dba"},"DBA",-1)),ze={class:"field"},He=u(()=>a("label",{for:"name"},"Contractor Name",-1)),Ye={class:"field"},Ge=u(()=>a("label",{for:"phone"},"Cell Phone",-1)),Je={class:"field"},Ze=u(()=>a("label",{for:"email"},"Email",-1)),Ke={key:0,class:"error"},Qe={class:"field"},Xe=u(()=>a("label",{for:"muni"},"Municipality",-1)),eo={class:"field"},oo=u(()=>a("label",{for:"folio"},"Folio",-1)),ao={class:"field"},so=u(()=>a("label",{for:"permit"},"Master Permit",-1)),lo={class:"field"},to=u(()=>a("label",{for:"processnum"},"mEProcess #",-1)),no={key:0,class:"response span-2"},io={class:"span-2 submit-row"},ro={__name:"PermitApp",setup(d){const p=t(!1),h=t(""),g=t(!1),b=x({dba:"",jobaddress:"",municipality:"",muniprocessnumber:"",processnumber:"",masterpermit:"",license:""}),P=t(!1),U=ce(),{procReceive:D}=ie(),{accountUsers:v}=Ie(),S=Ue(),{callPermitdata:z}=Me(),j=t([{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),H=t("me");W(()=>{const{width:s,isUltraWide:e,height:r,isLongScreen:m}=ke();return{width:s,isUltraWide:e,height:r,isLongScreen:m}});const o=x({address:"",muni:"",license:"",folio:"",contractor:"",permit:"",processNumber:"",phNumber:"",emails:"",muniProc:"",historic:Boolean,date:new Date,checkIfBeach:0}),f=t(""),Y=t(""),G=t(!0),B=t(!1),n=x({licenseStat:"",dba:"",phone:"",name:"",email:""}),_=t([]),y=t(""),C=t(!1);W(()=>{var s;C.value===!1&&((s=v.value[0])==null?void 0:s.secondary_status)==="I"?(o.license="Inactive",alert("Your license is Inactive!")):(o.license="Active",console.log(o.license),C.value=!0)}),de(()=>{N(),g.value=!0,localStorage.clear()});const J=$(()=>{var s,e,r;return((s=v.value[0])==null?void 0:s.bphone)!==""&&(B.value=!0,phone.value=(e=v.value[0])==null?void 0:e.bphone),B.value===!0?phone.value:(r=v.value[0])==null?void 0:r.bphone});me(N,J,()=>{console.log(N)});async function N(){var s,e,r,m;_.value=v.value[0],n.name=((s=_.value)==null?void 0:s.name)||"",n.email=((e=_.value)==null?void 0:e.email)||"",n.dba=((r=_.value)==null?void 0:r.dba)||"",n.phone=((m=_.value)==null?void 0:m.cphone)||"",console.log(n.licenseStat)}pe(async()=>{await Ve(B).toBe(!0)});const F=$(()=>G.value?j.value[0]:""),{resNum:Z}=re(),L=t(""),M=t(null),A=t(""),O=t(null),E=t(""),R=t(null);async function K(s){p.value=!0,O.value=null;try{const e=await fetch(s);M.value=await e.json(),A.value=M.value.body.MinimumPropertyInfos[0],o.contractor=n.dba,o.muni=A.value.Municipality,o.folio=A.value.Strap,P.value=await M.value.body.isHistoric,L.value=o.folio}catch(e){alert("No data found or enter correct address!"),O.value=e.message}finally{p.value=!1}}async function Q(s){s.value===2&&(o.checkIfBeach=s.value)}function w(){S.addSystem({...o})}function X(){Object.assign(o,{address:"",muni:"",license:"",folio:"",contractor:"",permit:"",phNumber:"",emails:"",muniProc:"",historic:!1,date:new Date,checkIfBeach:0}),y.value="",f.value=""}async function ee(){try{p.value=!0,Y.value=f.value;const e=`https://6x2kydgvuahfitwvxkkfbybv6u0kbxgl.lambda-url.us-east-1.on.aws/?address=${y.value.toUpperCase()}`;await K(e),Object.assign(o,{dba:n.dba,emails:n.email,muniprocessnumber:f.value,phonenumber:n.phone});const r=String(Z.value).substring(3,19),m=q(r).value+1;o.processNumber=H.value.concat(String(m)),o.muniProc=f.value,o.address=y.value,Object.assign(b,{dba:o.contractor,jobaddress:o.address,municipality:o.muni,muniprocessnumber:o.muniProc,processnumber:o.processNumber,masterpermit:o.permit,license:o.license}),E.value=L.value.substring(1,2),R.value=q(E),Q(R.value),await D(o),await z(b),w()}catch(s){alert(s)}}ve((s,e,r)=>{w(),r()}),fe(()=>{w()});async function oe(){w(),X(),U.push("/roofsystem")}return(s,e)=>{const r=ue,m=ne,c=te,T=le,ae=se;return V(),k(ye,null,[g.value?(V(),he(r,{key:0})):I("",!0),a("section",Ae,[a("div",xe,[De,i(m,{modelValue:F.value,"onUpdate:modelValue":e[0]||(e[0]=l=>F.value=l),options:j.value,optionLabel:"name",placeholder:"Select a permit type",class:"w-full permit-select"},null,8,["modelValue","options"]),a("form",{class:"grid-form",onSubmit:be(oe,["prevent"])},[a("div",je,[Ce,i(c,{id:"license",modelValue:o.license,"onUpdate:modelValue":e[1]||(e[1]=l=>o.license=l),placeholder:"empty"},null,8,["modelValue"])]),a("div",Fe,[Le,i(c,{id:"processMuni",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),placeholder:"00000000"},null,8,["modelValue"])]),a("div",Oe,[Ee,a("div",Re,[i(c,{id:"addr",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=l=>y.value=l),placeholder:"123 SW 1st St"},null,8,["modelValue"]),i(T,{type:"button",icon:"pi pi-search",loading:p.value,onClick:ee},null,8,["loading"])])]),a("div",Te,[P.value?(V(),k("span",We,"Property is Historic")):I("",!0)]),a("div",$e,[qe,i(c,{id:"dba",modelValue:n.dba,"onUpdate:modelValue":e[4]||(e[4]=l=>n.dba=l),placeholder:"company alias"},null,8,["modelValue"])]),a("div",ze,[He,i(c,{id:"name",modelValue:n.name,"onUpdate:modelValue":e[5]||(e[5]=l=>n.name=l),placeholder:"full name"},null,8,["modelValue"])]),a("div",Ye,[Ge,i(ae,{id:"phone",modelValue:n.phone,"onUpdate:modelValue":e[6]||(e[6]=l=>n.phone=l),mask:"(999) 999-9999",placeholder:"(999) 999-9999"},null,8,["modelValue"])]),a("div",Je,[Ze,i(c,{id:"email",modelValue:n.email,"onUpdate:modelValue":e[7]||(e[7]=l=>n.email=l),invalid:s.invalid,placeholder:"you@example.com"},null,8,["modelValue","invalid"]),s.invalid?(V(),k("small",Ke,"Email is required")):I("",!0)]),a("div",Qe,[Xe,i(c,{id:"muni",modelValue:o.muni,"onUpdate:modelValue":e[8]||(e[8]=l=>o.muni=l),placeholder:"Boris County"},null,8,["modelValue"])]),a("div",eo,[oo,i(c,{id:"folio",modelValue:o.folio,"onUpdate:modelValue":e[9]||(e[9]=l=>o.folio=l),placeholder:"00-0000-000-0000",onInput:s.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",ao,[so,i(c,{id:"permit",modelValue:o.permit,"onUpdate:modelValue":e[10]||(e[10]=l=>o.permit=l),placeholder:"20000000"},null,8,["modelValue"])]),a("div",lo,[to,i(c,{id:"processnum",modelValue:o.processNumber,"onUpdate:modelValue":e[11]||(e[11]=l=>o.processNumber=l),placeholder:"auto-generated"},null,8,["modelValue"])]),h.value?(V(),k("p",no,_e(h.value),1)):I("",!0),a("div",io,[i(T,{label:"Submit",type:"submit",loading:p.value,severity:"contrast",raised:""},null,8,["loading"])])],32)])])],64)}}},Mo=Be(ro,[["__scopeId","data-v-c1fc7b58"]]);export{Mo as default};
