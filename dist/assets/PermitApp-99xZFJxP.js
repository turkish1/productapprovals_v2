import{_ as Y}from"./Drop-CYwFbmX1.js";import{s as J}from"./index-DDBoVbCB.js";import{s as K}from"./index-rFiJj33V.js";import{s as Q}from"./index-BcaMCAlt.js";import{s as X}from"./index-A-CNIqZQ.js";import{a as $,u as ee}from"./useAxios-CPGZlx-v.js";import{r as l,j as te,a as E,_ as oe,u as se,t as ae,o as S,c as M,d as a,b as d,O as le,q as re,v as ne,p as ie,i as de}from"./index-Bo8eI-Ww.js";import{u as ce}from"./accountsStore-DGM06Xr_.js";import{u as ue}from"./permitapp-s3uUG_sE.js";import{E as pe}from"./jspdf.es.min-CGO06rdY.js";import{t as me,a as ge}from"./index-Bo52YWN7.js";import"./index-BwIynLIy.js";import"./index-BRTriST_.js";import"./index-BR3ZyowJ.js";import"./index-DUj2RsEi.js";import"./index-Bma7qGO5.js";import"./index-CkFBb8bu.js";const o=$.create({baseURL:"https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",apiKey:"LduI7j9z7Iwppo1AbxE9TBz2z2lJFZZFF3MU5ZFCbfxHU8wMlyCjvz0pWMByVH5n","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),fe={getAddr(){return o.get("/folio")},postProcessnumber(t){return o.post("/process",t)},getLastProcess(){return o.get("/lastnumber")},getSlopeless(){return o.get("/slopeless")},getSlopemore(){return o.get("/slopemore")},getdeOne(){return o.get("/desupone")},getdeTwo(){return o.get("/desuptwo")},getdeThree(){return o.get("/desupthree")},getdeFour(){return o.get("/desupfour")},getZones23(){return o.get("/gableroofs23")},getNoa(){return o.get("/noa")},getSBS(){return o.get("/shinglesbs")},getSystemE(){return o.get("/systemtype")},getburMaterial(){return o.get("/burmaterial")},getnewburMaterial(){return o.get("/burmaterials")},getburSystem(){return o.get("/bursystem")},getPoly(){return o.get("/shinglepoly")},getSystemF(){return o.get("/systemtypef")},getdeGauge(){return o.get("/degauge")},getdeMaterial(){return o.get("/dematerial")},getdeMatMore(){return o.get("/dematerials")},getdeSize(){return o.get("/desize")},getdeFastener(){return o.get("/defastener")},getprimeBase(){return o.get("/primebase")},getPerimeter(){return o.get("/perimeter")},getNoas(){return o.post("/shinglenoa")},getTile(){return http.get("/tileroof")},getTiles(){return o.get("/tilenoa")},getZones(){return o.get("/gablezones")},getLay(){return o.get("/underlaymentshingle")},getContractors(){return o.get("/contractors")},postAccount(t){return o.post("/accounts",t)},getAccount(){return o.get("/retriveaccounts")},getDripMaterials(){return o.get("/dripmaterials")}};function x(){const t=l(null),e=l(0);return fe.getLastProcess().then(i=>{t.value=i.data,t.value.forEach(s=>{console.log(s.processNumber),e.value=s.processNumber})}).catch(i=>{console.error("Error:",i)}),{resNum:t,lastNum:e}}function ve(){const{resNum:t,lastNum:e}=x(),i=l(""),s=l(new Date().getFullYear()),u=l(6),b=l("me"),f=Array.from({length:10**u.value},(v,m)=>`${b.value}${s.value}${String(m).padStart(u.value,"0")}`),r=x();return console.log(r),i.value=f[0]+1,e.value!==0||(i.value=e.value+1),{pNum:i,lastNum:e,resNum:t,test:r}}const be=te("processinput",{state:()=>({processinput:[],id:0}),actions:{addData(t){this.processinput.push({procData:t,completed:!1})}}});function he(){const t=l("");let e=l([]);const i=be(),s=l("");let u="https://us-east-1.aws.data.mongodb-api.com/app/data-aquwo/endpoint/process";const{execute:b,data:f}=ee(u,{method:"POST"},{immediate:!1});let r=E({});function v(m){console.log(m),r=m,b({data:m}),t.value="Form submitted successfully!",i.addData(r),console.log(r,"System added")}return{error:s,results:e,procReceive:v,responseMessage:t,procData:r,procStore:i}}l(1);const ye={setup(){const t=l(""),e=se(),i=l(),s=l(),u=l(),{procData:b,procReceive:f}=he(),{accountUsers:r,getUser:v,addUser:m}=ce();console.log(r._value[0].name);const w=l("me"),n=ue(),p=E({address:"",muni:"",folio:"",permit:"",processNumber:"",date:new Date}),V=l(""),P=l(""),U=l(""),C=l(""),I=l("");me(()=>{if(r._value[0].name==="")return e.push("/");V.value=r._value[0].name,P.value=r._value[0].email,U.value=r._value[0].phone,C.value=r._value[0].secondary_status,I.value=r._value[0].dba,console.log(P.value,V.value)});const D=l(!1);ve();const{lastNum:y,resNum:B}=x();l(null);const h=l(""),N=l(""),F=async()=>{const g=l(p.address),j=`https://www.miamidade.gov/Apps/PA/PApublicServiceProxy/PaServicesProxy.ashx?Operation=GetAddress&clientAppName=PropertySearch&myUnit=&from=1&myAddress=${encodeURIComponent(g.value)}&to=200`,q=await fetch(j);D.value=!0;const A=await q.json();console.log(A),p.muni=A.MinimumPropertyInfos[0].Municipality,p.folio=A.MinimumPropertyInfos[0].Strap;let k=String(y.value);console.log(y.value.length,y.value,k);let Z=k.substring(2,13),G=ge(Z).value+1,W=String(G);p.processNumber=w.value.concat(W),console.log(p.processNumber),N.value=p.folio,h.value=N.value.substring(0,2),console.log(h.value),f(p),setTimeout(()=>{D.value=!1},2e3)},R=async()=>{f(p),T()},L=l(),z=l([{name:"",code:" "},{name:"Roofing Permit",code:"RP"},{name:"Doors Permit",code:"DP"},{name:"Windows Permit",code:"WP"}]),O=()=>{e.push("/roofsystem")};function H(g,_){g=p,_=L.value,g.length!==0&&(n.addSystem(g,_,h.value),console.log(g,_,h.value,"System added"))}function T(){u.value=new pe;const g=g.$refs.permitapp.innerHTML;u.value.fromHTML(g,15,15,{width:150}),u.save("output.pdf"),console.log(u.value)}return{createHtml:T,onSubmit:R,accountUsers:r,getUser:v,email:P,dba:I,phone:U,contractor:V,licenseStatus:C,addUser:m,navigateNext:O,addItemAndClear:H,selectedApplication:L,type:z,resNum:B,...ae(p),responseMessage:t,lastNum:y,useLast:x,load:F,checkMB:h,checkV:N,content:i,canvas:s,doc:u}}},c=t=>(ie("data-v-7658a6a7"),t=t(),de(),t),_e={id:"permitapp",ref:"permitapp",class:"flex flex-col md:flex-row gap-4",style:{"margin-left":"220px"}},Se={class:"md:w-2/3"},xe={class:"container"},we={class:"row"},Ve={class:"card flex flex-col gap-2"},Pe=c(()=>a("div",{class:"font-semibold text-xl"},"Permit Application",-1)),Ne={class:"card flex justify-center"},Ae={class:"card flex flex-col gap-4"},Me={class:"flex flex-wrap gap-4"},Ue={class:"flex flex-col grow basis-0 gap-3"},Ce={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ie=c(()=>a("label",{for:"license"},"License Status",-1)),De=c(()=>a("label",{for:"addr"},"Property Address",-1)),Le={key:1,class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},Te={class:"flex flex-col mt-3 grow basis-0 gap-3"},ke=c(()=>a("label",{for:"dba"},"DBA ",-1)),Ee={class:"flex flex-col mt-3 grow basis-0 gap-3"},Be=c(()=>a("label",{for:"contractor"},"Contractor Name",-1)),Fe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Re=c(()=>a("label",{for:"phone"},"Cell Phone Number",-1)),ze={class:"flex flex-col mt-3 grow basis-0 gap-3"},Oe=c(()=>a("label",{for:"Email"},"Email",-1)),He={class:"flex flex-col mt-3 grow basis-0 gap-3"},je=c(()=>a("label",{for:"muni"},"Municipality",-1)),qe={class:"flex flex-col mt-3 grow basis-0 gap-3"},Ze=c(()=>a("label",{for:"folio"},"Folio",-1)),Ge={class:"flex flex-col mt-3 grow basis-0 gap-3"},We=c(()=>a("label",{for:"permit"},"Master Permit",-1)),Ye={class:"flex flex-col mt-3 grow basis-0 gap-3"},Je=c(()=>a("label",{for:"processnum"},"mEProcess Number",-1)),Ke=c(()=>a("br",null,null,-1)),Qe={key:0};function Xe(t,e,i,s,u,b){const f=X,r=Q,v=K,m=J,w=Y;return S(),M("div",_e,[a("div",Se,[a("div",xe,[a("form",null,[a("div",we,[a("div",Ve,[Pe,a("div",Ne,[d(f,{modelValue:s.selectedApplication,"onUpdate:modelValue":e[0]||(e[0]=n=>s.selectedApplication=n),options:s.type,showClear:"",optionLabel:"name",placeholder:"Select a permit type",class:"w-full md:w-56"},null,8,["modelValue","options"])]),a("div",Ae,[a("div",Me,[a("form",{class:"w-3/4",onSubmit:e[12]||(e[12]=(...n)=>s.onSubmit&&s.onSubmit(...n))},[a("div",Ue,[a("div",Ce,[Ie,d(r,{id:"license",modelValue:s.licenseStatus,"onUpdate:modelValue":e[1]||(e[1]=n=>s.licenseStatus=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),De,d(r,{id:"addr",type:"text",modelValue:t.address,"onUpdate:modelValue":e[2]||(e[2]=n=>t.address=n),placeholder:"address"},null,8,["modelValue"]),t.loading?(S(),M("i",Le)):(S(),le(v,{key:0,type:"button",label:"Search",severity:"contrast",icon:"pi pi-search-plus",loading:t.loading,onClick:s.load,onInput:s.createHtml},null,8,["loading","onClick","onInput"]))]),a("div",Te,[ke,d(r,{id:"dba",modelValue:s.dba,"onUpdate:modelValue":e[3]||(e[3]=n=>s.dba=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Ee,[Be,d(r,{id:"contractor",modelValue:s.contractor,"onUpdate:modelValue":e[4]||(e[4]=n=>s.contractor=n),type:"text",placeholder:"name"},null,8,["modelValue"])]),a("div",Fe,[Re,d(m,{modelValue:s.phone,"onUpdate:modelValue":e[5]||(e[5]=n=>s.phone=n),mask:"(999) 999-9999",placeholder:"(999) 999-9999",invalid:s.phone===""},null,8,["modelValue","invalid"])]),a("div",ze,[Oe,d(r,{modelValue:s.email,"onUpdate:modelValue":e[6]||(e[6]=n=>s.email=n),invalid:s.email===null},null,8,["modelValue","invalid"])]),a("div",He,[je,d(r,{id:"muni",modelValue:t.muni,"onUpdate:modelValue":e[7]||(e[7]=n=>t.muni=n),type:"text",placeholder:"municipality"},null,8,["modelValue"])]),a("div",qe,[Ze,d(r,{id:"folio",modelValue:t.folio,"onUpdate:modelValue":e[8]||(e[8]=n=>t.folio=n),type:"text",placeholder:"folio",onInput:t.updatemEProcess},null,8,["modelValue","onInput"])]),a("div",Ge,[We,d(r,{id:"permit",modelValue:t.permit,"onUpdate:modelValue":e[9]||(e[9]=n=>t.permit=n),type:"text",placeholder:"20000000"},null,8,["modelValue"])]),a("div",Ye,[Je,d(r,{id:"processnum",modelValue:t.processNumber,"onUpdate:modelValue":e[10]||(e[10]=n=>t.processNumber=n),type:"text",placeholder:"process number"},null,8,["modelValue"])]),Ke,d(v,{type:"submit",label:"Submit",severity:"contrast",raised:"",as:"router-link",to:"/roofsystem",onClick:e[11]||(e[11]=n=>s.addItemAndClear(t.formData,s.selectedApplication))})],32),s.responseMessage?(S(),M("p",Qe,re(s.responseMessage),1)):ne("",!0),d(w)])])])])])])])],512)}const bt=oe(ye,[["render",Xe],["__scopeId","data-v-7658a6a7"]]);export{bt as default};
