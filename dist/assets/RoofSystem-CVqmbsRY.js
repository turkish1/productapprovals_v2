import{_ as W}from"./FileSaver-Cp7pat4F.js";import{s as N,a as X}from"./index-7fhnbBie.js";import{e as i,o as c,c as r,i as e,t as m,d as I,F as B,x as E,j as u,H as U,f as F,D as Z,g as K,n as J,J as O,k as R,I as q,Y as ee,v as te,K as se,a as oe,S as Y,T as le,p as ae,q as ne,A as ie}from"./index-LMa6gMad.js";import{s as H}from"./index-BM2J2H1k.js";import{u as ce}from"./usePostGeneralpageLambda-DEV2np2r.js";import{u as re}from"./generalpageStore-BThDIplP.js";import{u as Q}from"./permitapp-cdtav8pS.js";import{u as G}from"./roofList-Cc_LjQar.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as de}from"./index-Cb1XbX5A.js";import{s as pe}from"./index-ByLK3Zuv.js";import{s as ue}from"./index-CxnQcD3P.js";import"./index-D_S7ItLY.js";import"./useAxios-BCmXfzo8.js";import"./index-eG-fJZ39.js";import"./index-DTqf5X6F.js";import"./index-BzPT-zzW.js";import"./index-BHj95Ejx.js";const me={class:"modal-wrapper shadow-xl space-y-8 p-6"},fe={class:"clear-pane border-2 border-dashed p-10 text-center mb-4"},he=e("h1",{class:"text-xl font-bold mb-4"},"Permit Application Verification",-1),ve={key:0,class:"text-sm mb-4"},_e=["disabled"],ge={class:"flex flex-wrap gap-4"},ke={class:"font-semibold text-ellipsis max-w-250 whitespace-nowrap overflow-hidden"},ye={key:0,class:"mt-8 space-y-4 overflow-y-auto max-h-40"},Se={class:"p-4 border-l-4 border-green-500 bg-green-50"},be={class:"font-bold"},$e={__name:"MCPFileUpload",setup(y){const _=i(!1),S=i(null),g=i([]),f=i(0),d=i(0),o=i([]),h=async t=>{console.log(t),o.value=t.target.files[0],console.log(o),g.value.push(o),console.log(g.value),a()},b=t=>{const $=$primevue.config.locale.fileSizeTypes;if(t===0)return`0 ${$[0]}`;const C=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/Math.pow(1024,C)).toFixed(3))} ${$[C]}`},l=t=>{d.value=f.value/1,t()},a=async()=>{_.value=!0;const t=o.value;if(!t)return;console.log("Uploading file:",t.name);const n=`https://amzn-s3-temp-upload-bucket.s3.us-east-1.amazonaws.com/${t.name}`;try{const v=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/pdf"},body:t});v.ok?console.log(`Successfully uploaded ${t.name} to S3.`):(console.error(`S3 Rejected Upload. Status: ${v.status}`),v.status===403&&alert("S3 Access Denied. Check CORS or Bucket Policy."))}catch(v){console.error("Network/CORS Error:",v)}finally{_.value=!1}};return(t,n)=>{var C;const v=N,$=X;return c(),r("div",me,[e("div",fe,[he,e("input",{type:"file",onChange:h,accept:".pdf,.jpg,.jpeg,.png",class:"mb-4"},null,32),o.value?(c(),r("p",ve,"Selected: "+m(o.value.name),1)):I("",!0),e("button",{onClick:a,class:"bg-blue-600 text-black px-6 py-2 rounded shadow-md disabled:bg-gray-400",disabled:_.value||!o.value},m(_.value?"Processing...":"Verify Application"),9,_e),e("div",ge,[(c(!0),r(B,null,E(o.value.value,(T,V)=>(c(),r("div",{key:V+T.url+T.size,class:"p-8 rounded-border flex flex-col border border-surface items-center gap-4"},[e("div",null,[u(v,{onClick:n[0]||(n[0]=L=>l()),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!o.value.value||o.value.value.length===0},null,8,["disabled"])]),e("span",ke,m(T.name),1),e("div",null,m(b(T.size)),1),u($,{value:"Completed",class:"mt-4",severity:"success"}),u(v,{icon:"pi pi-times",onClick:L=>t.removeFile(V),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"])]))),128))])]),S.value?(c(),r("div",ye,[e("div",Se,[e("h3",be,"LICENSE: "+m(S.value.license_found||"NOT DETECTED"),1),e("p",null,"Status: "+m(((C=S.value.contractor_info)==null?void 0:C.status)||"Unknown"),1),e("p",null,"Signatures: "+m(S.value.signatures_detected?"✅ Found":"❌ Missing"),1)])])):I("",!0)])}}};function we(){var C,T,V;const y=G(),{roofList:_}=U(y),S=Q(),g=i((V=(T=(C=S.$state.permitapp)==null?void 0:C[0])==null?void 0:T.formdt)==null?void 0:V.processNumber);i(!1);const f=re(),{postGeneral:d}=ce(),o=i(null),h=i(f.$state.generalpdfinput),b=i(!1),l=F({checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1}),a=F({steep1:0,steep2:0,steep3:0,steep4:0,low1:0}),t=F({steep:0,lowslope:0,total:0}),n=F({steepData:"",slopeData:"",totalData:"",checkedmtile:!1,checkedmetal:!1,checkedslp:!1,checkedadtile:!1,checkedshingle:!1,roofCheck:"",area:"",processnumber:""});function v(L){o.value=L.value,console.log(o.value);const P={"Asphalt Shingle":{dim:"dim1",flag:"checkedshingle",steepKey:"steep1"},"Adhesive Set Tile":{dim:"dim4",flag:"checkedadtile",steepKey:"steep2"},"Mechanical Fastened Tile":{dim:"dim3",flag:"checkedmtile",steepKey:"steep3"},"Metal Panel":{dim:"dim5",flag:"checkedmetal",steepKey:"steep4"},"Low Slope":{dim:"dim2",flag:"checkedslp"}};console.log(l,a),Object.keys(l).forEach(w=>l[w]=!1),Object.keys(a).forEach(w=>a[w]=0),_.value.forEach(w=>{console.log(w,P[w.item]);const x=P[w.item];if(x){console.log(x.flags);const D=Number(w[x.dim])||0;l[x]=!0,n[`${x.flag}`]=!0,console.log(x.flag,n),x.flag==="checkedslp"?(console.log(D),a.low2=D):a[x.steepKey]=D}}),$()}async function $(){t.steep=a.steep1+a.steep2+a.steep3+a.steep4,t.lowslope=a.low2,console.log(t.lowslope),t.total=t.steep+t.lowslope,n.area=t.total,n.steepData=t.steep,n.slopeData=t.lowslope,n.totalData=t.total,n.roofCheck=o.value,n.processnumber=g.value,f.addgeneralpdfData(n),await d(n),b.value=!0}return{addRoof:v,roofArea:$,dataGeneral:n,generalType:h,isGeneralPageValid:b}}const xe=Z("roofinput",{state:()=>({roofinput:[],id:0}),actions:{addCheck(y){this.roofinput.push({roofCheckdata:y,completed:!1})},reset(){this.roofinput=[]},persist:!0}}),Ce={class:"terminal"},Te={class:"terminal-content"},Re={class:"content"},Me=["onClick"],Ve=20,De={__name:"RoofSystemList",setup(y){const _=G(),{roofList:S}=U(_),{toggleCompleted:g}=U(_),f=["Initializing system...","Loading modules...","Connecting to server...","Server connection established.","Awaiting Roof System Selection..."],d=i([]);function o(){let h=0;const b=setInterval(()=>{h<f.length?(d.value.length>=Ve&&d.value.shift(),d.value.push(f[h]),console.log(f[h]),h++):clearInterval(b)},500)}return K(()=>{o()}),(h,b)=>(c(),r("div",Ce,[e("div",Te,[(c(!0),r(B,null,E(d.value,(l,a)=>(c(),r("div",{key:a,class:"terminal-line"},m(l),1))),128)),(c(!0),r(B,null,E(R(S),l=>(c(),r("div",{key:l.id,class:"item"},[e("div",Re,[e("span",{class:J({completed:l.completed}),style:{color:"green"}},m(l.item)+" "+m(l.dim1)+" "+m(l.dim2)+" "+m(l.dim3)+" "+m(l.dim4)+" "+m(l.dim5),3),e("span",{onClick:O(a=>R(g)(l.id),["stop"])},"✔",8,Me)])]))),128))])]))}},ze=j(De,[["__scopeId","data-v-0eaf742f"]]),M=y=>(ae("data-v-227b6320"),y=y(),ne(),y),Ae={class:"page"},Le={class:"card"},Fe={class:"card__header"},Pe=M(()=>e("h2",null,"Roof System",-1)),Ie=M(()=>e("i",{class:"pi pi-refresh"},null,-1)),Be={class:"form"},Ee={class:"field"},Ne=M(()=>e("label",{for:"sqft"},"Square Footage",-1)),Ue={class:"field"},Oe=M(()=>e("label",{for:"system"},"Roof System",-1)),Ke={key:0,class:"hint"},Ge={class:"field row"},je={class:"check"},qe=M(()=>e("label",{for:"kind-new"},"New Roof",-1)),Ye={class:"check"},He=M(()=>e("label",{for:"kind-reroof"},"Re-Roof",-1)),Je={class:"actions"},Qe={class:"side"},We=M(()=>e("p",{class:"dz-title"},"Blueprints & images",-1)),Xe=M(()=>e("p",{class:"dz-sub"},"Drag & drop files here, or click to select",-1)),Ze={key:0,class:"dz-list"},et={__name:"RoofSystemForm",setup(y){var w,x,D;const _=Q(),S=xe(),g=G(),f=i(""),d=i(null),o=i(""),h=i(!1),b=i([]),{addRoof:l}=we(),a=F({roofCheck:""}),t=[{name:"Asphalt Shingle"},{name:"Low Slope"},{name:"Mechanical Fastened Tile"},{name:"Adhesive Set Tile"},{name:"Metal Panel"}],n=i((D=(x=(w=_.$state.permitapp)==null?void 0:w[0])==null?void 0:x.formdt)==null?void 0:D.checkIfBeach),v=q(()=>ee(n.value).value===2),$=q(()=>v.value?t.slice(1):t);function C(z){var p;if(!z||f.value==0)return;const s=d.value.name,k=Number(f.value),A={"Asphalt Shingle":()=>g.addSystemShingle(s,k),"Low Slope":()=>g.addSystemBur(s,k),"Mechanical Fastened Tile":()=>g.addSystemMTile(s,k),"Adhesive Set Tile":()=>g.addSystemATile(s,k),"Metal Panel":()=>g.addSystemMetal(s,k)};console.log(A),(p=A[s])==null||p.call(A),a.roofCheck=o.value,S.addCheck({...a}),f.value="",d.value=null}function T(){l(o)}function V(){g.$reset()}function L(z){var k;h.value=!1;const s=[...((k=z.dataTransfer)==null?void 0:k.files)||[]];s.length&&(b.value=s)}function P(z){var k;const s=[...((k=z.target)==null?void 0:k.files)||[]];s.length&&(b.value=s)}return K(()=>{!d.value&&$.value.length&&(d.value=$.value[0])}),(z,s)=>{const k=te("RouterLink"),A=le;return c(),r("main",Ae,[e("section",Le,[e("header",Fe,[Pe,se((c(),oe(R(N),{class:"icon",text:"",plain:"",onClick:V},{default:Y(()=>[Ie]),_:1})),[[A,"Reset list",void 0,{bottom:!0}]])]),e("div",Be,[e("div",Ee,[Ne,u(R(pe),{id:"sqft",modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=p=>f.value=p),type:"number",inputmode:"numeric",placeholder:"e.g. 1200"},null,8,["modelValue"])]),e("div",Ue,[Oe,u(R(ue),{id:"system",class:"w-full",options:$.value,optionLabel:"name",modelValue:d.value,"onUpdate:modelValue":[s[1]||(s[1]=p=>d.value=p),C],placeholder:"Select roof system"},null,8,["options","modelValue"]),v.value?(c(),r("small",Ke,"Miami Beach restrictions apply.")):I("",!0)]),e("div",Ge,[e("div",je,[u(R(H),{inputId:"kind-new",name:"roofKind",value:"newroof",modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=p=>o.value=p)},null,8,["modelValue"]),qe]),e("div",Ye,[u(R(H),{inputId:"kind-reroof",name:"roofKind",value:"reroof",modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=p=>o.value=p)},null,8,["modelValue"]),He])]),e("div",Je,[u(k,{to:"/dynamicstepper"},{default:Y(()=>[u(R(N),{severity:"contrast",label:"Continue",onClick:T})]),_:1})])]),u(R(de)),u(ze)]),e("section",Qe,[e("div",{class:J(["dropzone",{over:h.value}]),onDragover:s[4]||(s[4]=O(p=>h.value=!0,["prevent"])),onDragleave:s[5]||(s[5]=p=>h.value=!1),onDrop:O(L,["prevent"])},[We,Xe,e("input",{type:"file",class:"dz-input",multiple:"",onChange:P},null,32),b.value.length?(c(),r("ul",Ze,[(c(!0),r(B,null,E(b.value,p=>(c(),r("li",{key:p.name},m(p.name),1))),128))])):I("",!0)],34)])])}}},tt=j(et,[["__scopeId","data-v-227b6320"]]),st={id:"id",class:"grid grid-cols-3 gap-6"},ot={class:"roof-app",style:{"margin-left":"250px","margin-top":"20px",border:"none","border-radius":"12px","box-shadow":"4px 4px 16px rgb(22, 183, 183)","padding-bottom":"10px",position:"center","max-height":"600px",width:"600px",top:"10vh"}},lt={__name:"RoofSystemApp",setup(y){return K(()=>{ie.init({duration:4500,easing:"ease-in-out",once:!1})}),(_,S)=>(c(),r("div",st,[e("div",ot,[u(tt)])]))}},at=j(lt,[["__scopeId","data-v-aebd1914"]]),nt={class:"grid grid-cols-2 gap-0"},it={"data-aos":"fade-up-right","data-aos-delay":"500",style:{"margin-top":"90px"}},Ct={__name:"RoofSystem",setup(y){return(_,S)=>(c(),r("div",nt,[u(at),e("div",it,[u(W),u($e)])]))}};export{Ct as default};
