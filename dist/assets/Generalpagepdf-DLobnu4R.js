import{u as Je}from"./accountsStore-CDmRT02v.js";import{u as Ue}from"./generalpageStore-CY4WxcZl.js";import{u as je}from"./permitapp-CcFcntqf.js";import{u as He}from"./roofList-DXRrKhAu.js";import{E as ye}from"./jspdf.es.min-ja9fCTIh.js";import{r as a,a9 as Oe,at as Ze,au as qe,b as Ke,c as Qe}from"./index-DTURtfV_.js";const ct={__name:"Generalpagepdf",setup(Le){var V,I,z,R,E,N,X;const{getUser:xe}=Je();let b=a(!1);const g=je();He();const s=Ue(),B=a(((I=(V=g.$state.permitapp[0])==null?void 0:V.formdt)==null?void 0:I.address)||""),P=a(((R=(z=g.$state.permitapp[0])==null?void 0:z.formdt)==null?void 0:R.permit)||""),u=a(((N=(E=g.$state.permitapp[0])==null?void 0:E.formdt)==null?void 0:N.processNumber)||""),w=a(((X=xe.value[0])==null?void 0:X.dba)||""),Te=a(""),ke=a(s.$state.generalpdfinput);function $e(){ke.value.length!==1&&(b.value=!0)}Oe(()=>{$e(),G()}),Ze(async()=>{await qe(b).toBe(!0),G()});const G=()=>{var Y,A,M,J,U,j,H,y;if(s.$state.generalpdfinput.length===0)console.log("lenghth is   zero");else{const e=new ye({orientation:"portrait",unit:"mm",format:"a4",compress:!0});e.setGState(new e.GState({opacity:.9}));const O="Approved";e.setFontSize(24),e.setTextColor("black"),e.setFont("helvetica"),e.text("mEPermits",25,250,{angle:45,align:"left",baseline:"bottom",renderingMode:"fill"});const Z=new Image,q=new Image,K=new Image;Z.src="/demo/images/officepaper.jpeg",q.src="/demo/images/logo.jpeg",K.src="/demo/images/DragAndDrop.jpeg";const Ce=725,Q=e.getPageInfo(1),Fe=Q.pageContext.mediaBox.topRightX,We=Q.pageContext.mediaBox.topRightY;console.log(Fe);const t=a(0),L=a(0);var c=595.28-585.28,o=We-Ce;t.value=c,L.value=o,console.log(t.value,L.value),e.addImage(q,"JPEG",10,10,50,30),e.addImage(Z,"JPEG",0,0,210,297),e.setFontSize(12),e.setTextColor("green");var De=new Date,Se=De.toLocaleDateString();e.text(O,10,270,{align:"left"});const be=e.getTextWidth(O);e.text("on: "+Se,be+15,270),e.text(`${u.value}`,10,258,{align:"left"}),e.getTextWidth(`${u.value}`),console.log(B,P,u,w);const _=a(!1),ee=a(!1),te=a(!1),oe=a(!1),ae=a(!1);e.setFontSize(12);const Be=()=>{e.setFontSize(10),e.setTextColor(0),e.text("2023 HVHZ  mEPermit General Information Page",70,20,{maxWidth:"170"}),e.line(10,41,195,41)};e.setTextColor(0),e.circle(185,38,2,"FD"),e.text("I agree",165,39),Be(),e.setFontSize(12),e.setFontSize(10);const Pe=[{category:"DBA",value:`${w.value}`},{category:"Job Address",value:`${B.value}`},{category:"meProcess Number",value:`${u.value}`},{category:"Master Permit",value:`${P.value}`}];let we=10,$=60,Ge=50;e.setFontSize(10),Pe.forEach((i,W)=>{const r=Ge+W*10;e.text(i.category,we,r),e.text(i.value,$,r),e.getTextWidth(i.category);const T=e.getTextWidth(i.value)*2;e.line($,r+2,$+T,r+2)}),e.setTextColor("black"),e.setFontSize(10);const l=100,D=a(!1),le=a(!1);console.log(s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]),s.$state.generalpdfinput[0].generalpdfData.roofCheck[0]==="reroof"?(D.value=!0,console.log(D.value)):le.value=!0,t.value=c+70,o=l-15,console.log(o),e.text("Re-Roof: ",t.value,o);const d=o-3,S=D.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);t.value=c+120,o=l-15,console.log(o),e.text("New Roof: ",t.value,o);const C=le.value===!0?e.rect(t.value+20,d,4,4,"FD"):e.rect(t.value+20,d,4,4);console.log(S,C);const se="Total: ",ne="Low Slope: ",ce="Steep Slope: ";(A=(Y=g.$state.permitapp[0])==null?void 0:Y.formdt)!=null&&A.muni;const re=a(((J=(M=s.$state.generalpdfinput[0])==null?void 0:M.generalpdfData)==null?void 0:J.totalData)||""),ie=a(((j=(U=s.$state.generalpdfinput[0])==null?void 0:U.generalpdfData)==null?void 0:j.slopeData)||""),ue=a(((y=(H=s.$state.generalpdfinput[0])==null?void 0:H.generalpdfData)==null?void 0:y.steepData)||"");console.log(s.$state.generalpdfinput[0].generalpdfData),t.value=c+25;const Ve=e.getTextWidth(ne),pe=e.getTextWidth(`${ie.value}`),ge=t.value+2;e.text(ne,ge,l);const v=Ve+ge;e.text(`${ie.value}`,v,l),e.line(v,l,v+pe,l),t.value=v+pe;const Ie=e.getTextWidth(ce),de=e.getTextWidth(`${ue.value}`),ve=t.value+2;e.text(ce,ve,l);const f=Ie+ve;e.text(`${ue.value}`,f,l),e.line(f,l,f+de,l),console.log(l,o),o=l+10,t.value=f+de,console.log(t.value);const ze=e.getTextWidth(se),fe=e.getTextWidth(`${re.value}`),he=t.value+2;e.text(se,he,l);const h=ze+he;e.text(`${re.value}`,h,l),e.line(h,l,h+fe,l),t.value=h+fe,console.log(s.$state.generalpdfinput[0]),s.$state.generalpdfinput[0].generalpdfData.slopeChk===!0&&(ae.value=!0,console.log("Slope Checked")),s.$state.generalpdfinput[0].generalpdfData.adtileChk===!0&&(_.value=!0),s.$state.generalpdfinput[0].generalpdfData.metalChk===!0&&(ee.value=!0),s.$state.generalpdfinput[0].generalpdfData.mtileChk===!0&&(te.value=!0),s.$state.generalpdfinput[0].generalpdfData.shingleChk===!0&&(oe.value=!0,console.log("Shingle Checked")),t.value=c,console.log(t.value),e.text("Low Slope: ",c,o);const n=o-3,Re=ae.value===!0?e.rect(t.value+20,n,4,4,"FD"):e.rect(t.value+20,n,4,4);console.log(S,C,Re),t.value=t.value+10,console.log(t.value);const m=t.value+18;console.log(t.value),e.text("Adhesive Set Tile: ",m,o);const Ee=_.value===!0?e.rect(m+30,n,4,4,"FD"):e.rect(m+30,n,4,4);console.log(S,C,Ee),console.log(t.value);const x=m+40;console.log(t.value),e.text("Metal Panel: ",x,o);const Ne=ee.value===!0?e.rect(x+25,n,4,4,"FD"):e.rect(x+25,n,4,4);t.value=x+10;const p=t.value+25;console.log(t.value),e.text("Shingle: ",p,o);const Xe=oe.value===!0?e.rect(p+15,n,4,4,"FD"):e.rect(p+15,n,4,4);t.value=p;const F=p+35;console.log(t.value),e.text("Mechanical Fastened Tile: ",F,o);const Ye=te.value===!0?e.rect(F+45,n,4,4,"FD"):e.rect(F+45,n,4,4);console.log(Ye,Xe,Ne),o=o+10,e.addImage(K,"JPEG",c+40,o,120,120);const Ae="GeneralPage.pdf",Me=e.output("blob");(async(i,W)=>{const r=i,T=r;console.log(T);const me=`https://dsr-pdfupload.s3.us-east-1.amazonaws.com/${u.value}/${T}`;try{const k=await fetch(me,{method:"PUT",headers:{"Content-Type":r.type},body:W});k.ok?(Te.value=me,alert("File uploaded successfully!")):alert(`Failed to upload file. Status: ${k.status}`)}catch(k){console.error("Error uploading file:",k),alert("An error occurred while uploading the file.")}})(Ae,Me)}};return(c,o)=>(Ke(),Qe("div"))}};export{ct as default};
